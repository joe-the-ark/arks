var __reflect=this&&this.__reflect||function(e,t,i){e.__class__=t,i?i.push(t):i=[t],e.__types__=e.__types__?i.concat(e.__types__):i},__extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a]);i.prototype=t.prototype,e.prototype=new i},__awaiter=this&&this.__awaiter||function(e,t,i,a){return new(i||(i=Promise))(function(r,n){function s(e){try{h(a.next(e))}catch(t){n(t)}}function o(e){try{h(a["throw"](e))}catch(t){n(t)}}function h(e){e.done?r(e.value):new i(function(t){t(e.value)}).then(s,o)}h((a=a.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){function i(e){return function(t){return a([e,t])}}function a(i){if(r)throw new TypeError("Generator is already executing.");for(;h;)try{if(r=1,n&&(s=n[2&i[0]?"return":i[0]?"throw":"next"])&&!(s=s.call(n,i[1])).done)return s;switch(n=0,s&&(i=[0,s.value]),i[0]){case 0:case 1:s=i;break;case 4:return h.label++,{value:i[1],done:!1};case 5:h.label++,n=i[1],i=[0];continue;case 7:i=h.ops.pop(),h.trys.pop();continue;default:if(s=h.trys,!(s=s.length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){h=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){h.label=i[1];break}if(6===i[0]&&h.label<s[1]){h.label=s[1],s=i;break}if(s&&h.label<s[2]){h.label=s[2],h.ops.push(i);break}s[2]&&h.ops.pop(),h.trys.pop();continue}i=t.call(e,h)}catch(a){i=[6,a],n=0}finally{r=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var r,n,s,o,h={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return o={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o},game;!function(e){var t=function(t){function i(e,i,a,r,n,s,o,h){var c=t.call(this)||this;return c.stageWidth=0,c.stageHeight=0,c._width=600,c._x=20,c.character1="Insufficiently",c.character2="Fully",c.playerName="Joe",c.selfPerception=20,c.othersSelfPerception=[27,31,40,47,63],c.stageWidth=n,c.stageHeight=s,c.sprite=new egret.Sprite,c.game_secret=e,c.inviter=i,c.player=a,c.gameName=r,c.playerCount=o,c.selfPerception=h,c.playerName=a,c.addChild(c.sprite),c.processBar(),c.tip(),c.rightIcon(),c.drawPotentialScale(),c}return __extends(i,t),i.prototype.processBar=function(){var t=new e.ProcessBar(this.stageWidth,this.stageHeight,12,"Initaite > Partial Insights");this.sprite.addChild(t)},i.prototype.tip=function(){var e=new egret.TextField;e.text="Our Basic Hypothesis is simple: a containment of tensions within the team results in less conflict & a better deployment of the team‘s potentialities.\n\n\n\n\n\n",e.width=this._width,e.x=this._x,e.y=this.stageHeight-180,e.background=!0,e.backgroundColor=3514259,this.sprite.addChild(e)},i.prototype.rightIcon=function(){var e=new egret.Bitmap(RES.getRes("right_png"));e.width=100,e.height=100,e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height/2,e.x=this.stageWidth-50,e.y=this.stageHeight-50,e.touchEnabled=!0,e.addEventListener(egret.TouchEvent.TOUCH_TAP,this.nextTouch,this),this.sprite.addChild(e)},i.prototype.drawPotentialScale=function(){var t=new e.PotentialScale(this.stageWidth,this.stageHeight,this.character1,this.character2,this.playerName,this.selfPerception,this.game_secret,this.inviter,this.player,this.gameName,this.playerCount);t.x=this._x+350,t.y=80,this.sprite.addChild(t)},i.prototype.nextTouch=function(){var t=this;base.API.Init("http://work.metatype.cn:8105/api/"),base.API.call("save_players_process",{inviter_name:t.inviter,game_secret:t.game_secret,player:t.player,game_name:t.gameName,process:"0.2"}).then(function(i){var a=t.game_secret,r=t.inviter,n=t.player,s=t.gameName,o=t.stageWidth,h=t.stageHeight,c=(t.selfPerception,t.playerCount);t.sprite.visible=!1;var l=new e.CharacterChoosePage(a,r,n,s,o,h,c);t.stage.addChild(l)})},i}(egret.DisplayObjectContainer);e.InitiatePartialInsights=t,__reflect(t.prototype,"game.InitiatePartialInsights")}(game||(game={}));var LoadingUI=function(e){function t(){var t=e.call(this)||this;return t.createView(),t}return __extends(t,e),t.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},t.prototype.onProgress=function(e,t){this.textField.text="Loading..."+e+"/"+t},t}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var DebugPlatform=function(){function e(){}return e.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2,{nickName:"username"}]})})},e.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},e}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var base;!function(e){var t=function(){function e(e){this.baseUrl=e}return e.Init=function(t){e.instance=new e(t)},e.call=function(e,t){return __awaiter(this,void 0,void 0,function(){var i,a=this;return __generator(this,function(r){return i=new Promise(function(i,r){var n=new egret.HttpRequest;n.responseType=egret.HttpResponseType.TEXT,n.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8"),n.open(a.instance.baseUrl+e+"/","POST"),n.send(JSON.stringify(t)),n.addEventListener(egret.Event.COMPLETE,function(e){var t=JSON.parse(n.response);t.success?i(t.result):r({code:t.code,msg:t.msg})},a)}),[2,i]})})},e.instance=null,e}();e.API=t,__reflect(t.prototype,"base.API")}(base||(base={}));var base;!function(e){var t=function(){function e(){}return e.prototype.getAsset=function(e,t,i){function a(a){t.call(i,a,e)}var r=RES.getRes(e);r?a(r):RES.getResAsync(e,a,this)},e}();e.AssetAdapter=t,__reflect(t.prototype,"base.AssetAdapter",["eui.IAssetAdapter"])}(base||(base={}));var Button=function(e){function t(t,i){var a=e.call(this)||this,r=new eui.Group;r.width=t,r.height=i,a.addChild(r);var n=new eui.VerticalLayout;n.gap=30,n.verticalAlign=egret.VerticalAlign.MIDDLE,n.horizontalAlign=egret.HorizontalAlign.CENTER,r.layout=n;var s=new egret.Shape;s.graphics.beginFill(13378065),s.graphics.drawCircle(12,12,6),s.graphics.endFill(),a._icon=s;var o=new egret.RenderTexture;o.drawToTexture(s);var h=new eui.Button;return h.label="按钮",h.icon=o,h.addEventListener(egret.TouchEvent.TOUCH_TAP,a.onTouch,a),r.addChild(h),a}return __extends(t,e),t.prototype.onTouch=function(e){var t=e.target,i=new egret.RenderTexture;switch(i.drawToTexture(this._icon),e.type){case egret.TouchEvent.TOUCH_BEGIN:t.icon=i;break;case egret.TouchEvent.TOUCH_END:t.icon=null}},t}(eui.UILayer);__reflect(Button.prototype,"Button");var base;!function(e){var t=function(){function e(){}return e.prototype.getTheme=function(e,t,i,a){function r(e){t.call(a,e)}function n(t){t.resItem.url===e&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,n,null),i.call(a))}var s=this;"undefined"!=typeof generateEUI?egret.callLater(function(){t.call(a,generateEUI)},this):"undefined"!=typeof generateEUI2?RES.getResByUrl("resource/gameEui.json",function(e,i){window.JSONParseClass.setData(e),r(e),egret.callLater(function(){t.call(a,generateEUI2)},s)},this,RES.ResourceItem.TYPE_JSON):(RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,n,null),RES.getResByUrl(e,r,this,RES.ResourceItem.TYPE_TEXT))},e}();e.ThemeAdapter=t,__reflect(t.prototype,"base.ThemeAdapter",["eui.IThemeAdapter"])}(base||(base={}));var game;!function(e){var t=function(t){function i(e,i,a,r,n,s,o){var h=t.call(this)||this;return h.stageWidth=0,h.stageHeight=0,h.game_secret="",h.gameName="",h.inviter="",h.player="",h._width=600,h._x=20,h._margin=20,h.player_list=[],h.stageWidth=e,h.stageHeight=i,h.sprite=new egret.Sprite,h.player=s,h.inviter=r,h.game_secret=n,h.gameName=o,h.player_list=a,h.text=new egret.TextField,h.text.text="My relation to \nis based on...",h.text.width=200,h.text.x=h._x,h.text.y=200,h.sprite.addChild(h.text),h.votingPlayerName=new egret.TextField,h.votingPlayerName.text="Babettete",h.votingPlayerName.width=120,h.votingPlayerName.x=h._x+h.text.width,h.votingPlayerName.y=200,h.sprite.addChild(h.votingPlayerName),h.addChild(h.sprite),h.processBar(),h.intro(),h.playerName(),h.playerListMove(),h.rightIcon(),h}return __extends(i,t),i.prototype.processBar=function(){var t=new e.ProcessBar(this.stageWidth,this.stageHeight,99,"Cliffhanger > Affinity Mapping");this.sprite.addChild(t)},i.prototype.intro=function(){var e=new egret.TextField;e.text="Describe the nature of your relationships...",e.width=this._width,e.x=this._x,e.y=100,this.sprite.addChild(e)},i.prototype.playerName=function(){var e=this,t=["Love","Appreciation","Indifference","Hidden Conflict","Open Conflict"];t.forEach(function(i,a,r){var n=new egret.TextField;n.touchEnabled=!0,n.text=t[a],n.width=220,n.height=150,n.x=e._x+e.text.width+e.votingPlayerName.width+e._margin,n.y=200+170*a,n.border=!0,n.borderColor=0,e.sprite.addChild(n);n.x,n.y;n.addEventListener(egret.TouchEvent.TOUCH_TAP,e.chooseArea.bind(e,n.x,n.y),e)})},i.prototype.chooseArea=function(e,t){var i=this,a=new egret.TextField;a.text=i.choose,a.width=200,a.height=50,a.size=30,a.x=e,a.y=t+50,a.border=!0,a.borderColor=0,i.sprite.addChild(a)},i.prototype.playerListMove=function(){var e=this;this.player_list.forEach(function(t,i,a){console.log(t);var r=new egret.TextField;r.text=t,r.textAlign=egret.HorizontalAlign.CENTER,r.size=30,r.lineSpacing=10,r.touchEnabled=!0,r.border=!0,r.borderColor=65280,r.x=100,r.y=270+50*i,r.background=!0,r.backgroundColor=6513507,e.sprite.addChild(r),r.width=200,r.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){r.backgroundColor=65280,r.alpha=.4,r.touchEnabled=!1,e.votingPlayerName.text=r.text,e.choose=r.text},e)})},i.prototype.rightIcon=function(){var e=new egret.Bitmap(RES.getRes("right_png"));e.width=100,e.height=100,e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height/2,e.x=this.stageWidth-50,e.y=this.stageHeight/2,e.touchEnabled=!0,e.addEventListener(egret.TouchEvent.TOUCH_TAP,this.nextPage,this),this.sprite.addChild(e)},i.prototype.nextPage=function(){var t=this;base.API.call("save_players_process",{inviter_name:t.inviter,game_secret:t.game_secret,player:t.player,game_name:t.gameName,process:"10"}).then(function(e){base.API.call("game_end",{inviter_name:t.inviter,game_secret:t.game_secret,player:t.player,gameName:t.gameName}).then(function(e){})}),this.sprite.visible=!1;var i=new e.Complete(this.stageWidth,this.stageHeight);this.stage.addChild(i)},i}(egret.DisplayObjectContainer);e.AffinityMapping=t,__reflect(t.prototype,"game.AffinityMapping")}(game||(game={}));var game;!function(e){var t=function(t){function i(i,a,r,n,s,o,h,c,l){var d=t.call(this)||this;d.playerList=[],d.game_secret="",d.player="",d.gameName="",d.inviter="",d.characterTwo="",d.characterOne="",d.stageWidth=0,d.stageHeight=0,d._touchStatus=!1,d._distance=new egret.Point,d.characterList=[],d.characterListParams=[],d.charaChooser=[],d.playerAndOthersCharacterList=[],d.map={},d.game_secret=i,d.player=r,d.gameName=n,d.inviter=a,d.count=h,d.characterListParams=c,d.playerAndOthersCharacterList=l,d.characterList=c[1],d.charaChooser=c[0],d.characterTwo=d.characterList[h][1],d.characterOne=d.characterList[h][0],d.stageWidth=s,d.stageHeight=o,d.sprite=new egret.Sprite,d.sprite.width=s,d.sprite.height=o,d.sprite.x=0,d.sprite.y=0,d.addChild(d.sprite),d.sprite.addEventListener(egret.Event.ADDED_TO_STAGE,d.getPlayList,d),d.rectShapeOne=new egret.Shape,d.rectShapeTwo=new egret.Shape,d.sprite.addChild(d.rectShapeOne),d.sprite.addChild(d.rectShapeTwo),d.drawRect(),d._shape=new egret.Shape,d.addChild(d._shape),d.initGraphics(),d.charater1=new egret.TextField,d.sprite.addChild(d.charater1),d.initCharacter1(s-390,200),d.charater2=new egret.TextField,d.sprite.addChild(d.charater2),d.initCharacter(s-390,d.stageHeight-150),d.rightIcon=new egret.Bitmap(RES.getRes("right_png")),d.rightIcon.width=100,d.rightIcon.height=100,d.rightIcon.anchorOffsetX=d.rightIcon.width/2,d.rightIcon.anchorOffsetY=d.rightIcon.height/2,d.rightIcon.x=s-50,d.rightIcon.y=o/2,d.addChild(d.rightIcon),d.rightIcon.touchEnabled=!0,d.rightIcon.addEventListener(egret.TouchEvent.TOUCH_BEGIN,d.nextTouch,d),d.closeIcon=new egret.Bitmap(RES.getRes("close-circle_png")),d.closeIcon.width=40,d.closeIcon.height=40,d.closeIcon.anchorOffsetX=d.closeIcon.width/2,d.closeIcon.anchorOffsetY=d.closeIcon.height/2,d.closeIcon.x=s-30,d.closeIcon.y=150,d.closeIcon.touchEnabled=!0,d.closeIcon.addEventListener(egret.TouchEvent.TOUCH_BEGIN,d.closeTip,d),d.addChild(d.closeIcon),d.tiptext=new egret.TextField;var g=Math.ceil((h+1)/d.charaChooser.length*65+20),p=new e.ProcessBar(s,o,g,"Mission 1 > Vote Tension Scale");return d.sprite.addChild(p),d}return __extends(i,t),i.prototype.closeTip=function(){this.tiptext.parent&&this.removeChild(this.tiptext)},i.prototype.nextTouch=function(){var t=this.sprite.numChildren-this.playerList.length-5;if(this.playerList.length==t){var i=(this.game_secret,this.inviter,this.player,this.gameName,this.stageWidth,this.stageHeight,this.characterListParams[1][this.count][0]),a=this.characterListParams[1][this.count][1];base.API.Init("http://work.metatype.cn:8105/api/"),base.API.call("set_player_score",{params:this.map,inviter_name:this.inviter,gameSecret:this.game_secret,player:this.player,gameName:this.gameName,charaChooser:this.charaChooser[this.count],characterOne:i,characterTwo:a}).then(function(e){});var r=this.count;base.API.call("save_players_process",{inviter_name:this.inviter,game_secret:this.game_secret,player:this.player,game_name:this.gameName,process:"1."+r.toString()+".1"}).then(function(e){}),this.sprite.visible=!1,this.removeChild(this.rightIcon),this.removeChild(this.closeIcon),this._shape.visible=!1,this.tiptext.text="";var n=this.charaChooser[this.count],s=new e.MissionPartialInsights(this.stageWidth,this.stageHeight,i,a,this.player,this.player_score,this.inviter,this.game_secret,this.gameName,r,n);this.stage.addChild(s)}else this.addChild(this.tiptext),this.tip(100,100,"Everyone must be graded!")},i.prototype.tip=function(e,t,i){var a=this.tiptext;a.x=e,a.y=t,a.text=i,a.size=40,a.width=this.stageWidth},i.prototype.drawRect=function(){var e=this.rectShapeOne;e.graphics.beginFill(3514259,.5),e.graphics.drawRect(0,0,this.stageWidth+60,180),e.graphics.endFill();var t=this.rectShapeTwo;t.graphics.beginFill(3514259,.5),t.graphics.drawRect(0,this.stageHeight-100,this.stageWidth+60,200),t.graphics.endFill()},i.prototype.initGraphics=function(){var e=this._shape;e.graphics.lineStyle(2,16711935),e.graphics.moveTo(this.stageWidth-250,this.stageHeight-150),e.graphics.lineTo(this.stageWidth-250,240)},i.prototype.initCharacter=function(e,t){var i=this.charater2;i.text=this.characterTwo,i.textAlign=egret.HorizontalAlign.CENTER,i.size=40,i.border=!0,i.width=280,i.borderColor=3825613,i.x=e,i.y=t},i.prototype.initCharacter1=function(e,t){var i=this.charater1;i.text=this.characterOne,i.textAlign=egret.HorizontalAlign.CENTER,i.size=40,i.border=!0,i.width=280,i.borderColor=3825613,i.x=e,i.y=t},i.prototype.getPlayList=function(){base.API.Init("http://work.metatype.cn:8105/api/");var e=this;base.API.call("get_player_list",{game_secret:e.game_secret,gameName:e.gameName,inviter:e.inviter}).then(function(t){var i=this;e.playerList=t.player_list,e.playerList.forEach(function(t,a,r){var n=new egret.TextField;n.text=t,n.textAlign=egret.HorizontalAlign.CENTER,n.size=30,n.lineSpacing=10,n.touchEnabled=!0,n.border=!0,18*t.length<100?n.width=100:n.width=18*t.length,n.borderColor=65280,n.x=70,n.y=300+50*a;var s=new egret.TextField;s.text="",s.size=30,s.border=!0,s.width=50,s.borderColor=65280,s.textAlign=egret.HorizontalAlign.CENTER,n.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(t){e._touchStatus=!0;var a=t.stageX,r=n.x,o=n.y,h=t.stageY;n.addEventListener(egret.TouchEvent.TOUCH_MOVE,function(t){if(e._touchStatus){n.x=t.stageX-a+r,n.y=t.stageY-h+o,s.parent&&s.parent.removeChild(s);var i=100;if(n.width>100&&(i=n.width),n.x>e.stageWidth-250-i&&(n.x=e.stageWidth-250-i,n.y>240&&n.y<e.stageHeight-150-n.height)){s.x=n.x+i,s.y=n.y;var c=(e.stageHeight-150-240-n.height)/81;s.text=Math.ceil((s.y-240)/c).toString(),e.sprite.addChild(s);var l=Math.ceil((s.y-240)/c).toString(),d=n.text;d==e.player&&(e.player_score=l),e.map[d]=l,console.log(e.map)}n.y>e.stageHeight-150-n.height&&(n.y=e.stageHeight-150-n.height)}},i)},i),n.addEventListener(egret.TouchEvent.TOUCH_END,function(t){e._touchStatus=!1,n.removeEventListener(egret.TouchEvent.TOUCH_MOVE,i.mouseMove,i)},i),e.sprite.addChild(n)})})},i}(egret.DisplayObjectContainer);e.Character=t,__reflect(t.prototype,"game.Character")}(game||(game={}));var game;!function(e){var t=function(t){function i(i,a,r,n,s,o,h){var c=t.call(this)||this;c.unselectedCharacterList=[],c.selectedChaeacterList=[],c.game_secret="",c.gameName="",c.inviter="",c.player="",c.stageWidth=0,c.stageHeight=0,c.count=0,c._touchStatus=!1,c.select_list=[],c.playerCount=0,c.playerList=[],c.flag1=0,c.flag2=0,c.characterList=[],c.allcharacterlist=[],c.chooseText=[],c.playerCharacterList=[],c.stageWidth=s,c.stageHeight=o,c.player=r,c.gameName=n,c.game_secret=i,c.inviter=a,c.playerCount=h,c.sprite=new egret.Sprite,c.addChild(c.sprite),c.sprite.touchEnabled=!0,c.titleBackground=new egret.Shape,c.sprite.addChild(c.titleBackground),c.drawTitleBackground(),c.createTitle(),c.drawSplitLine(),c.getCharacterList(),c.confirmButton=new egret.Shape,c.confirmButton.graphics.beginFill(52224),c.confirmButton.graphics.drawRect(0,0,200,50),c.confirmButton.graphics.endFill(),c.confirmButton.y=230,c.confirmButton.x=100,c.confirmButton.touchEnabled=!0,c.confirmButton.addEventListener(egret.TouchEvent.TOUCH_TAP,c.addTensionScale,c),c.confirmText=new egret.TextField,c.confirmText.text="Confirm",c.confirmText.size=30,c.confirmText.x=c.confirmButton.x+50,c.confirmText.y=c.confirmButton.y+10,c.sprite.addChild(c.confirmButton),c.sprite.addChild(c.confirmText),c.confirmText.visible=!1,c.confirmButton.visible=!1,c.rightIcon=new egret.Bitmap(RES.getRes("right_png")),c.rightIcon.width=100,c.rightIcon.height=100,c.rightIcon.anchorOffsetX=c.rightIcon.width/2,c.rightIcon.anchorOffsetY=c.rightIcon.height/2,c.rightIcon.x=s-50,c.rightIcon.y=o-100,c.rightIcon.touchEnabled=!0,c.rightIcon.addEventListener(egret.TouchEvent.TOUCH_TAP,c.rightNext,c),c.chooseone=new egret.TextField,c.chooseone.textAlign=egret.HorizontalAlign.CENTER,c.chooseone.textAlign=egret.VerticalAlign.MIDDLE,c.chooseone.size=30,c.chooseone.text="point & click",c.chooseone.lineSpacing=10,c.chooseone.border=!0,c.chooseone.width=190,c.chooseone.borderColor=3825613,c.chooseone.height=40,c.chooseone.y=170,c.chooseone.touchEnabled=!0,c.chooseone.addEventListener(egret.TouchEvent.TOUCH_TAP,c.touchone,c),c.sprite.addChild(c.chooseone),c.choosetwo=new egret.TextField,c.choosetwo.textAlign=egret.HorizontalAlign.CENTER,c.chooseone.textAlign=egret.VerticalAlign.BOTTOM,c.choosetwo.size=30,c.choosetwo.lineSpacing=10,c.choosetwo.text="point & click",c.choosetwo.border=!0,c.choosetwo.width=190,c.choosetwo.borderColor=3825613,c.choosetwo.height=40,c.choosetwo.y=170,c.choosetwo.x=210,c.choosetwo.touchEnabled=!0,c.choosetwo.addEventListener(egret.TouchEvent.TOUCH_TAP,c.touchtwo,c),c.sprite.addChild(c.choosetwo),c.timer=new egret.Timer(1e3,0),c.timer.addEventListener(egret.TimerEvent.TIMER,c.getPlayerCharacterList,c),c.timer.start();var l=new e.ProcessBar(s,o,20,"Mission 1 > Tension Scales");return c.sprite.addChild(l),c}return __extends(i,t),i.prototype.touchone=function(){if(this.chooseText[0]){this.chooseone.text="";var e=new egret.TextField;e.text=this.chooseText[0],e.textAlign=egret.HorizontalAlign.CENTER,e.size=30,e.lineSpacing=10,e.border=!0,e.width=this.chooseone.width,e.height=this.chooseone.height,e.background=!0,e.borderColor=6513507,e.backgroundColor=7434694,e.x=this.chooseone.x,e.y=this.chooseone.y,this.sprite.addChild(e)}},i.prototype.touchtwo=function(){if(this.chooseText[1]){this.choosetwo.text="";var e=new egret.TextField;e.text=this.chooseText[1],e.textAlign=egret.HorizontalAlign.CENTER,e.size=30,e.lineSpacing=10,e.border=!0,e.width=this.choosetwo.width,e.height=this.choosetwo.height,e.background=!0,e.borderColor=6513507,e.backgroundColor=7434694,e.x=this.choosetwo.x,e.y=this.choosetwo.y,this.sprite.addChild(e),this.confirmButton.visible=!0,this.confirmText.visible=!0}},i.prototype.rightNext=function(){var t=this;base.API.Init("http://work.metatype.cn:8105/api/"),base.API.call("save_players_process",{inviter_name:t.inviter,game_secret:t.game_secret,player:t.player,game_name:t.gameName,process:"1.0.0"}).then(function(i){if(t.stage){var a=t.game_secret,r=t.inviter,n=t.player,s=t.gameName,o=t.stageWidth,h=t.stageHeight,c=0;t.characterList.push(t.playerList),t.characterList.push(t.allcharacterlist),t.timer.stop();var l=[],d=[],g=[],p=[];t.playerList.forEach(function(e,i,a){e==n?(l.push(e),l.push(t.allcharacterlist[i])):(g.push(e),p.push(t.allcharacterlist[i]))}),t.sprite.visible=!1,t.rightIcon.visible=!1,d.push(g),d.push(p),l.push(d);var u=new e.Character(a,r,n,s,o,h,c,t.characterList,l);t.stage.addChild(u)}})},i.prototype.getPlayerCharacterList=function(){var t=this;base.API.Init("http://work.metatype.cn:8105/api/"),base.API.call("get_player_characterlist",{game_secret:t.game_secret,inviter:t.inviter,player:t.player,gameName:t.gameName}).then(function(i){var a=i.data;a.forEach(function(i,a,r){var n=i[0];if(n==t.player&&(t.select_list=i[1],console.log(t.select_list),t.sprite.addChild(t.rightIcon),t.playerCharacterList=i[1]),-1==t.playerList.indexOf(n)){t.count++;var s=new e.TensionScale(t.stageWidth,t.stageHeight,i[1],0,0,0,0);t.allcharacterlist.push(i[1]),t.playerList.push(n),t.sprite.addChild(s),s.x=t.stageWidth-200,s.y=150*t.count}})})},i.prototype.drawTitleBackground=function(){var e=this.titleBackground;e.graphics.beginFill(3514259,.5),e.graphics.drawRect(0,0,this.stageWidth,130),e.graphics.endFill()},i.prototype.createTitle=function(){var e=new egret.TextField;e.text="Task: screen through the list and name the twosomes of formative tensions that unite, seperate and define the organizing dynamics in your team.",e.size=25,e.width=this.stageWidth,e.x=320-e.textWidth/2,e.y=50,this.sprite.addChild(e)},i.prototype.drawSplitLine=function(){var e=new egret.Shape;e.graphics.lineStyle(2,16777215),e.graphics.moveTo(400,this.stageHeight),e.graphics.lineTo(400,130),e.graphics.endFill(),this.sprite.addChild(e)},i.prototype.getCharacterList=function(){base.API.Init("http://work.metatype.cn:8105/api/");var e=this;base.API.call("get_character_list",{}).then(function(t){var i=this;e.unselectedCharacterList=t.characters,e.unselectedCharacterList.forEach(function(t,a,r){var n=new egret.TextField;n.text=t,n.textAlign=egret.HorizontalAlign.CENTER,n.size=30,n.lineSpacing=10,n.touchEnabled=!0,n.width=100,n.border=!0,n.borderColor=65280,n.x=50,n.y=300+50*a,n.background=!0,n.backgroundColor=6513507,e.sprite.addChild(n),18*t.length<100?n.width=100:n.width=18*t.length;n.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){2==e.chooseText.length?(e.chooseText.pop(),e.chooseText.push(n.text),e.select_list.push(n.text)):(e.chooseText.push(n.text),e.select_list.push(n.text),n.backgroundColor=65280,n.alpha=.4,n.touchEnabled=!1)},i),n.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(t){e._touchStatus=!0;var a=t.stageX,r=n.x,s=n.y,o=t.stageY;1!=e.flag1||1!=e.flag2?n.addEventListener(egret.TouchEvent.TOUCH_MOVE,function(t){e._touchStatus&&(n.x=t.stageX-a+r,n.y=t.stageY-o+s),n.y<185&&n.y>170&&n.x>0&&n.x<80?(1==e.flag1?console.log("already have"):e.flag1=1,n.touchEnabled=!1,e.select_list.push(n.text),e.chooseone.text="",1==e.flag1&&1==e.flag2&&(e.confirmText.visible=!0,e.confirmButton.visible=!0)):n.y<185&&n.y>170&&n.x>210&&n.x<280&&(1==e.flag2?console.log("already have"):e.flag2=1,n.touchEnabled=!1,e.select_list.push(n.text),e.choosetwo.text="",1==e.flag1&&1==e.flag2&&(e.confirmText.visible=!0,e.confirmButton.visible=!0))},i):1==e.flag1&&1==e.flag2&&(e.confirmText.visible=!0,e.confirmButton.visible=!0)},i),n.addEventListener(egret.TouchEvent.TOUCH_END,function(t){e._touchStatus=!1,n.removeEventListener(egret.TouchEvent.TOUCH_MOVE,i.mouseMove,i)},i)})})},i.prototype.addTensionScale=function(){var t=this;if((this.select_list.length=2)&&(base.API.Init("http://work.metatype.cn:8105/api/"),base.API.call("save_character_choose",{inviterName:t.inviter,gameSecret:t.game_secret,playerName:t.player,gameName:t.gameName,charaChooser:t.select_list}).then(function(e){t.confirmButton.touchEnabled=!1})),this.stage){var i=new e.TensionScale(this.stageWidth,this.stageHeight,this.select_list,0,0,0,0);this.sprite.addChild(i),i.x=this.stageWidth-200,i.y=150*(this.count+1)}},i}(egret.DisplayObjectContainer);e.CharacterChoosePage=t,__reflect(t.prototype,"game.CharacterChoosePage")}(game||(game={}));var game;!function(e){var t=function(t){function i(e,i,a,r,n,s){var o=t.call(this)||this;return o.stageWidth=0,o.stageHeight=0,o.game_secret="",o.gameName="",o.inviter="",o.player="",o._width=600,o._x=20,o._margin=20,o.stageWidth=e,o.stageHeight=i,o.sprite=new egret.Sprite,o.inviter=a,o.player=s,o.game_secret=r,o.gameName=n,o.addChild(o.sprite),o.processBar(),o.intro(),o.rightIcon(),o}return __extends(i,t),i.prototype.processBar=function(){var t=new e.ProcessBar(this.stageWidth,this.stageHeight,95,"Cliffhanger > Mission 3");this.sprite.addChild(t)},i.prototype.intro=function(){var e=new egret.TextField;e.text="Before you may download the PDF with souvenirs from your journey, please ano- nymously vote one last scale.",e.width=this._width,e.x=this._x,e.y=100,this.sprite.addChild(e);var t=new egret.Bitmap(RES.getRes("bg_jpg"));t.width=this._width,t.height=550,t.x=this._x,t.y=e.y+e.height+this._margin,this.sprite.addChild(t);var i=new egret.TextField;i.text="We call it the relationship scale. The results will be displays to nobody, yet will help us developing the next level on your journey with The ARK: Missi- on 3 > Empathy Walk",i.width=this._width,i.x=this._x,i.y=t.y+t.height+this._margin,this.sprite.addChild(i)},i.prototype.rightIcon=function(){var e=new egret.Bitmap(RES.getRes("right_png"));e.width=100,e.height=100,e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height/2,e.x=this.stageWidth-50,e.y=this.stageHeight/2,e.touchEnabled=!0,e.addEventListener(egret.TouchEvent.TOUCH_TAP,this.nextPage,this),this.sprite.addChild(e)},i.prototype.nextPage=function(){var t=this;console.log(t.inviter),console.log(t.game_secret),base.API.Init("http://work.metatype.cn:8105/api/"),base.API.call("get_players",{inviter:t.inviter,game_secret:t.game_secret,gameName:t.gameName,player:t.player}).then(function(i){base.API.call("save_players_process",{inviter_name:t.inviter,game_secret:t.game_secret,player:t.player,game_name:t.gameName,process:"9"}).then(function(e){});var a=i.result,r=a;t.sprite.visible=!1;var n=new e.AffinityMapping(t.stageWidth,t.stageHeight,r,t.inviter,t.game_secret,t.player,t.gameName);t.stage.addChild(n)})},i}(egret.DisplayObjectContainer);e.Cliffhanger=t,__reflect(t.prototype,"game.Cliffhanger")}(game||(game={}));var game;!function(e){var t=function(t){function i(e,i){var a=t.call(this)||this;return a.stageWidth=0,a.stageHeight=0,a.game_secret="",a.gameName="",a.inviter="",a.player="",a._width=600,a._x=20,a._margin=20,a.stageWidth=e,a.stageHeight=i,a.sprite=new egret.Sprite,a.addChild(a.sprite),a.processBar(),a.intro(),a}return __extends(i,t),i.prototype.processBar=function(){var t=new e.ProcessBar(this.stageWidth,this.stageHeight,100,"Mission 2 > Complete");this.sprite.addChild(t)},i.prototype.intro=function(){var e=new egret.TextField;e.text="Thank you for travelling with The ARK!\n\nDownload a PDF with your journeys data\n\nWeChat with the developer \n\nRe-Embark on The ARK \n\nRecommend The ARK to your friends\n\nCoffee for the developer",e.width=this._width,e.x=this._x,e.y=100,this.sprite.addChild(e)},i}(egret.DisplayObjectContainer);e.Complete=t,__reflect(t.prototype,"game.Complete")}(game||(game={}));var game;!function(e){var t=function(t){function i(e,i,a,r,n,s,o){var h=t.call(this)||this;return h.count=0,h.playerList=[],h.characterList=[],h.allcharacterlist=[],h.sprite=new egret.Sprite,h.sprite.width=e,h.sprite.height=i,h.addChild(h.sprite),h.nickname=a,h.player=a,h.openid=r,h.status=o,h.game_secret=n,h.inviter=s,h.stageWidth=e,h.stageHeight=i,h.label2=new egret.TextField,h.label2.text="be ready friends: ",h.label2.height=30,h.label2.anchorOffsetX=h.label2.width/2,h.label2.anchorOffsetY=h.label2.height/2,h.label2.x=h.stageWidth/2,h.label2.y=h.stageHeight/6,h.label2.background=!0,h.label2.backgroundColor=16777215,h.label2.border=!0,h.label2.borderColor=65280,h.label2.fontFamily="Arial",h.label2.textColor=16711680,h.sprite.addChild(h.label2),"inviter"==o&&(h.label=new egret.TextField,h.label.text="Click on the top right corner to invite friends ",h.label.height=30,h.label.anchorOffsetX=h.label.width/2,h.label.anchorOffsetY=h.label.height/2,h.label.x=h.stageWidth/2,h.label.y=h.stageHeight/10,h.label.background=!0,h.label.backgroundColor=16777215,h.label.border=!0,h.label.borderColor=65280,h.label.fontFamily="Arial",h.label.textColor=16711680,h.sprite.addChild(h.label),h.label3=new egret.TextField,h.label3.text="play game",h.label3.height=30,h.label3.width=180,h.label3.anchorOffsetX=h.label3.width/2,h.label3.anchorOffsetY=h.label3.height/2,h.label3.x=h.stageWidth/2,h.label3.y=h.stageHeight/1.5,h.label3.background=!0,h.label3.backgroundColor=16777215,h.label3.border=!0,h.label3.borderColor=65280,h.label3.touchEnabled=!0,h.label3.fontFamily="Arial",h.label3.textColor=16711680,h.label3.addEventListener(egret.TouchEvent.TOUCH_BEGIN,h.onTouchBegin,h),h.sprite.addChild(h.label3),h.invateFriends()),h.timer=new egret.Timer(1e3,0),h.timer.addEventListener(egret.TimerEvent.TIMER,h.getPlayeList,h),h.timer.start(),h}return __extends(i,t),i.prototype.getPlayeList=function(){var t=this;base.API.Init("http://work.metatype.cn:8105/api/"),base.API.call("getPlayerList",{inviter_name:t.inviter,game_secret:t.game_secret,gameName:t.game_secret}).then(function(e){var i=e.result;i.forEach(function(e,i,a){var r=new egret.TextField;r.text=e,r.textAlign=egret.HorizontalAlign.CENTER,r.size=30,r.lineSpacing=10,r.touchEnabled=!0,r.border=!0,20*e.length<100?r.width=100:r.width=18*e.length,r.borderColor=65280,r.x=70,r.y=300+50*i,t.sprite.addChild(r)})}),"player"==t.status&&base.API.call("getGameStatus",{inviter_name:t.inviter,game_secret:t.game_secret,gameName:t.game_secret,openid:t.openid,nickname:t.nickname}).then(function(i){var a=i.result;1==a&&base.API.call("get_players_process",{game_secret:t.game_secret,inviter_name:t.inviter,player:t.nickname,gameName:t.game_secret}).then(function(i){var a=i.process;if("0.1"==a){var r=i.playercount,n=i.playerScore,s=t.game_secret,o=t.inviter,h=t.player,c=t.game_secret,l=t.stageWidth,d=t.stageHeight;t.timer.stop(),t.sprite.visible=!1;var g=new e.InitiatePartialInsights(s,o,h,c,l,d,r,n);t.stage.addChild(g)}else if("0.2"==a){var r=i.playercount,s=t.game_secret,p=t.inviter,h=t.player,u=t.game_secret,l=t.stageWidth,d=t.stageHeight;t.timer.stop(),this.sprite.visible=!1;var m=new e.CharacterChoosePage(s,p,h,u,l,d,r);this.stage.addChild(m)}else if("1.0.0"==a){base.API.call("get_player_characterlist",{game_secret:t.game_secret,inviter:t.inviter,player:t.player,gameName:t.game_secret}).then(function(i){var a=i.data,r=[];a.forEach(function(e,i,a){var r=e[0];-1==t.playerList.indexOf(r)&&(m++,t.allcharacterlist.push(e[1]),t.playerList.push(r))}),r.push(t.playerList),r.push(t.allcharacterlist);var n=[],s=[],o=[],h=[];t.playerList.forEach(function(e,i,a){e==t.player?(n.push(e),n.push(t.allcharacterlist[i])):(o.push(e),h.push(t.allcharacterlist[i]))}),s.push(o),s.push(h),n.push(s);var c=t.game_secret,l=t.inviter,d=t.player,g=t.game_secret,p=t.stage.stageWidth,u=t.stage.stageHeight,m=0;t.timer.stop(),t.sprite.visible=!1;var v=new e.Character(c,l,d,g,p,u,m,r,n);t.stage.addChild(v)})}else{t.inviter,t.game_secret,t.game_secret;t.sprite.visible=!1,t.timer.stop();var v=new e.GamePageOne(t.game_secret,t.inviter,t.nickname,t.game_secret,t.stage.stageWidth,t.stage.stageHeight);
t.stage.addChild(v)}})}),"inviter"==t.status&&base.API.call("getGameStatus",{inviter_name:t.inviter,game_secret:t.game_secret,gameName:t.game_secret,openid:t.openid,nickname:t.nickname}).then(function(i){var a=i.result;1==a&&base.API.call("get_players_process",{game_secret:t.game_secret,inviter_name:t.inviter,player:t.nickname,gameName:t.game_secret}).then(function(i){var a=i.process;if("0.1"==a){var r=i.playercount,n=i.playerScore,s=t.game_secret,o=t.inviter,h=t.player,c=t.game_secret,l=t.stageWidth,d=t.stageHeight;t.timer.stop(),t.sprite.visible=!1;var g=new e.InitiatePartialInsights(s,o,h,c,l,d,r,n);t.stage.addChild(g)}else if("0.2"==a){var r=i.playercount,s=t.game_secret,p=t.inviter,h=t.player,u=t.game_secret,l=t.stageWidth,d=t.stageHeight;this.sprite.visible=!1,t.timer.stop();var m=new e.CharacterChoosePage(s,p,h,u,l,d,r);this.stage.addChild(m)}else if("1.0.0"==a){var v=t;base.API.call("get_player_characterlist",{game_secret:v.game_secret,inviter:v.inviter,player:v.player,gameName:v.game_secret}).then(function(i){var a=i.data,r=[];a.forEach(function(e,i,a){var r=e[0];-1==t.playerList.indexOf(r)&&(m++,v.allcharacterlist.push(e[1]),v.playerList.push(r))}),r.push(v.playerList),r.push(v.allcharacterlist);var n=[],s=[],o=[],h=[];t.playerList.forEach(function(e,t,i){e==v.player?(n.push(e),n.push(v.allcharacterlist[t])):(o.push(e),h.push(v.allcharacterlist[t]))}),s.push(o),s.push(h),n.push(s);var c=v.game_secret,l=v.inviter,d=v.player,g=v.game_secret,p=v.stage.stageWidth,u=v.stage.stageHeight,m=0;t.timer.stop(),v.sprite.visible=!1;var x=new e.Character(c,l,d,g,p,u,m,r,n);v.stage.addChild(x)})}else{t.inviter,t.game_secret,t.game_secret;t.timer.stop(),t.sprite.visible=!1;var x=new e.GamePageOne(t.game_secret,t.inviter,t.nickname,t.game_secret,t.stage.stageWidth,t.stage.stageHeight);t.stage.addChild(x)}})})},i.prototype.invateFriends=function(){var e=window.location.href,t="http://ark.metatype.cn/index.html?game_id="+this.openid+"&inviter="+this.nickname;base.API.Init("http://work.metatype.cn:8105/api/");var i=this;base.API.call("wechatapi",{url:e}).then(function(e){var a=new BodyConfig;a.appId=e.params.appId,a.timestamp=e.params.timestamp,a.nonceStr=e.params.nonceStr,a.jsApiList=e.params.jsApiList,a.signature=e.params.signature,wx&&(wx.config(a),wx.ready(function(){var e="your friend "+i.nickname+" invite you to join the game";wx.onMenuShareAppMessage({title:"ARK",desc:e,link:t,imgUrl:"",type:"",dataUrl:"",trigger:function(){},success:function(e){},cancel:function(){},fail:function(e){}})}),wx.error(function(e){}))})["catch"](function(e){console.log(e)})},i.prototype.onTouchBegin=function(){var t=this.inviter,i=this.game_secret,a=this.game_secret;base.API.Init("http://work.metatype.cn:8105/api/"),base.API.call("create_game",{inviter:t,gameName:i,game_id:a}).then(function(e){}),this.sprite.visible=!1,this.timer.stop();var r=new e.GamePageOne(this.game_secret,this.inviter,this.inviter,this.game_secret,this.stage.stageWidth,this.stage.stageHeight);this.stage.addChild(r)},i}(egret.DisplayObjectContainer);e.CreateGame=t,__reflect(t.prototype,"game.CreateGame")}(game||(game={}));var game;!function(e){var t=function(t){function i(e,i,a,r,n,s,o){var h=t.call(this)||this;return h.stageWidth=0,h.stageHeight=0,h.game_secret="",h.gameName="",h.inviter="",h.player="",h._width=600,h.noticeHeight=90,h._x=20,h._margin=20,h.result=[],h.stageWidth=e,h.stageHeight=i,h.sprite=new egret.Sprite,h.inviter=r,h.player=o,h.game_secret=n,h.gameName=s,h.result=a,h.addChild(h.sprite),h.processBar(),h.notice(),h.add(),h.addFeedback(),h.rightIcon(),h}return __extends(i,t),i.prototype.processBar=function(){var t=new e.ProcessBar(this.stageWidth,this.stageHeight,85,"Mission 2 > Digest ADD");this.sprite.addChild(t)},i.prototype.notice=function(){this.noticeBox=new egret.TextField,this.noticeBox.text="Digest your 1 to 1 Feedback. Keep in mind: Feedback is a present from the heart. Direct feedback expresses care for your relationship.",this.noticeBox.textColor=0,this.noticeBox.width=this._width,this.noticeBox.x=this._x,this.noticeBox.y=60,this.noticeBox.background=!0,this.noticeBox.backgroundColor=16763955,this.sprite.addChild(this.noticeBox)},i.prototype.add=function(){var e=new egret.TextField;e.text="I would \nLOVE \nJOE\neven\nmore,\nif...",e.size=30,e.x=this._x,e.y=this.noticeBox.height+80,this.sprite.addChild(e)},i.prototype.addFeedback=function(){var e=new eui.Group,t='\n                        <e:Skin xmlns:e="http://ns.egret.com/eui" states="up,down" height="50">\n                            <e:Label text="{data}" textColor.down="0xFFFFFF" textColor.up="0x666666" horizontalCenter="0" verticalCenter="0"/> \n                        </e:Skin>',i=new eui.List,a=this.result[1];i.dataProvider=new eui.ArrayCollection(a),i.itemRendererSkinName=t,e.addChild(i);var r=new eui.Scroller;r.width=470,r.height=this.stageHeight-300,r.x=130+this._margin,r.y=this.noticeBox.height+80,r.viewport=e,this.sprite.addChild(r)},i.prototype.rightIcon=function(){var e=new egret.Bitmap(RES.getRes("right_png"));e.width=100,e.height=100,e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height/2,e.x=this.stageWidth-50,e.y=this.stageHeight/2,e.touchEnabled=!0,e.addEventListener(egret.TouchEvent.TOUCH_TAP,this.nextPage,this),this.sprite.addChild(e)},i.prototype.nextPage=function(){base.API.call("save_players_process",{inviter_name:this.inviter,game_secret:this.game_secret,player:this.player,game_name:this.gameName,process:"7"}).then(function(e){}),this.sprite.visible=!1;var t=new e.DigestAsk(this.stageWidth,this.stageHeight,this.result,this.inviter,this.game_secret,this.gameName,this.player);this.stage.addChild(t)},i}(egret.DisplayObjectContainer);e.DigestAdd=t,__reflect(t.prototype,"game.DigestAdd")}(game||(game={}));var game;!function(e){var t=function(t){function i(e,i,a,r,n,s,o){var h=t.call(this)||this;return h.stageWidth=0,h.stageHeight=0,h.game_secret="",h.gameName="",h.inviter="",h.player="",h._width=600,h.noticeHeight=90,h._x=20,h._margin=20,h.result=[],h.stageWidth=e,h.stageHeight=i,h.sprite=new egret.Sprite,h.inviter=r,h.player=o,h.game_secret=n,h.gameName=s,h.result=a,h.addChild(h.sprite),h.processBar(),h.notice(),h.ask(),h.askFeedback(),h.rightIcon(),h}return __extends(i,t),i.prototype.processBar=function(){var t=new e.ProcessBar(this.stageWidth,this.stageHeight,90,"Mission 2 > Digest ASK");this.sprite.addChild(t)},i.prototype.notice=function(){this.noticeBox=new egret.TextField,this.noticeBox.text="Digest your 1 to 1 Feedback. Keep in mind: Feedback is a present from the heart. Direct feedback expresses care for your relationship.",this.noticeBox.textColor=0,this.noticeBox.width=this._width,this.noticeBox.x=this._x,this.noticeBox.y=60,this.noticeBox.background=!0,this.noticeBox.backgroundColor=16763955,this.sprite.addChild(this.noticeBox)},i.prototype.ask=function(){var e=new egret.TextField;e.text="I always \nwanted\nto\nASK...\nJOE",e.size=30,e.x=this._x,e.y=this.noticeBox.height+80,this.sprite.addChild(e)},i.prototype.askFeedback=function(){var e=new eui.Group,t='\n                        <e:Skin xmlns:e="http://ns.egret.com/eui" states="up,down" height="50">\n                            <e:Label text="{data}" textColor.down="0xFFFFFF" textColor.up="0x666666" horizontalCenter="0" verticalCenter="0"/> \n                        </e:Skin>',i=new eui.List,a=this.result[2];i.dataProvider=new eui.ArrayCollection(a),i.itemRendererSkinName=t,e.addChild(i);var r=new eui.Scroller;r.width=470,r.height=this.stageHeight-300,r.x=130+this._margin,r.y=this.noticeBox.height+80,r.viewport=e,this.sprite.addChild(r)},i.prototype.rightIcon=function(){var e=new egret.Bitmap(RES.getRes("right_png"));e.width=100,e.height=100,e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height/2,e.x=this.stageWidth-50,e.y=this.stageHeight/2,e.touchEnabled=!0,e.addEventListener(egret.TouchEvent.TOUCH_TAP,this.nextPage,this),this.sprite.addChild(e)},i.prototype.nextPage=function(){base.API.call("save_players_process",{inviter_name:this.inviter,game_secret:this.game_secret,player:this.player,game_name:this.gameName,process:"8"}).then(function(e){}),this.sprite.visible=!1;var t=new e.Cliffhanger(this.stageWidth,this.stageHeight,this.inviter,this.game_secret,this.gameName,this.player);this.stage.addChild(t)},i}(egret.DisplayObjectContainer);e.DigestAsk=t,__reflect(t.prototype,"game.DigestAsk")}(game||(game={}));var game;!function(e){var t=function(t){function i(e,i,a,r,n,s,o){var h=t.call(this)||this;return h.stageWidth=0,h.stageHeight=0,h.game_secret="",h.gameName="",h.inviter="",h.player="",h._width=600,h.noticeHeight=90,h._x=20,h._margin=20,h.result=[],h.stageWidth=e,h.stageHeight=i,h.sprite=new egret.Sprite,h.inviter=r,h.player=o,h.game_secret=n,h.gameName=s,h.result=a,h.addChild(h.sprite),h.processBar(),h.notice(),h.love(),h.loveFeedback(),h.rightIcon(),h}return __extends(i,t),i.prototype.processBar=function(){var t=new e.ProcessBar(this.stageWidth,this.stageHeight,80,"Mission 2 > Digest LOVE");this.sprite.addChild(t)},i.prototype.notice=function(){this.noticeBox=new egret.TextField,this.noticeBox.text="Digest your 1 to 1 Feedback. Keep in mind: Feedback is a present from the heart. Direct feedback expresses care for your relationship.",this.noticeBox.textColor=0,this.noticeBox.width=this._width,this.noticeBox.x=this._x,this.noticeBox.y=60,this.noticeBox.background=!0,this.noticeBox.backgroundColor=16763955,this.sprite.addChild(this.noticeBox)},i.prototype.love=function(){var e=new egret.TextField;e.text="I LOVE \n\nJOE\nbecause...",e.size=30,e.x=this._x,e.y=this.noticeBox.height+80,this.sprite.addChild(e)},i.prototype.loveFeedback=function(){var e=new eui.Group,t='\n                        <e:Skin xmlns:e="http://ns.egret.com/eui" states="up,down" height="50">\n                            <e:Label text="{data}" textColor.down="0xFFFFFF" textColor.up="0x666666" horizontalCenter="0" verticalCenter="0"/> \n                        </e:Skin>',i=new eui.List,a=this.result[0];i.dataProvider=new eui.ArrayCollection(a),i.itemRendererSkinName=t,e.addChild(i);var r=new eui.Scroller;r.width=470,r.height=this.stageHeight-300,r.x=130+this._margin,r.y=this.noticeBox.height+80,r.viewport=e,this.sprite.addChild(r)},i.prototype.rightIcon=function(){var e=new egret.Bitmap(RES.getRes("right_png"));e.width=100,e.height=100,e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height/2,e.x=this.stageWidth-50,e.y=this.stageHeight/2,e.touchEnabled=!0,e.addEventListener(egret.TouchEvent.TOUCH_TAP,this.nextPage,this),this.sprite.addChild(e)},i.prototype.nextPage=function(){base.API.call("save_players_process",{inviter_name:this.inviter,game_secret:this.game_secret,player:this.player,game_name:this.gameName,process:"6"}).then(function(e){}),this.sprite.visible=!1;var t=new e.DigestAdd(this.stageWidth,this.stageHeight,this.result,this.inviter,this.game_secret,this.gameName,this.player);this.stage.addChild(t)},i}(egret.DisplayObjectContainer);e.DigestLove=t,__reflect(t.prototype,"game.DigestLove")}(game||(game={}));var game;!function(e){var t=function(t){function i(e,i,a,r,n){var s=t.call(this)||this;s.count=0,s.playerList=[],s.game_secret="",s.gameName="",s.isPlayer=0,s.inviter="",s.player="",s.allcharacterlist=[],s.playerCount=0,s.characterList=[],s.stageWidth=0,s.stageHeight=0,s.game_secret=e,s.gameName=i,s.inviter=a,s.sprite=new egret.Sprite,s.stageHeight=n,s.stageWidth=r,s.sprite.width=r,s.sprite.height=n,s.addChild(s.sprite);var o=new egret.Shape;o.graphics.beginFill(16774638),o.graphics.drawRect(0,0,300,50),o.graphics.endFill(),o.x=s.sprite.width/2+80,o.y=s.sprite.height/3,o.anchorOffsetX=o.width/2,o.anchorOffsetY=o.height/2,s.sprite.addChild(o);var h=new egret.Shape;h.graphics.beginFill(16774638),h.graphics.drawRect(0,0,300,50),h.graphics.endFill(),h.x=s.sprite.width/2+80,h.y=s.sprite.height/3-100,h.anchorOffsetX=h.width/2,h.anchorOffsetY=h.height/2,s.sprite.addChild(h),s.txInput2=new egret.TextField,s.txInput2.type=egret.TextFieldType.INPUT,s.txInput2.inputType=egret.TextFieldInputType.TEXT,s.txInput2.width=290,s.txInput2.height=50,s.txInput2.x=s.sprite.width/2+80,s.txInput2.y=s.sprite.height/3-100,s.txInput2.anchorOffsetX=s.txInput2.width/2,s.txInput2.anchorOffsetY=s.txInput2.height/2,s.txInput2.textColor=855309,s.txInput2.size=40;var c=new egret.TextField;c.text="input password:",c.x=s.sprite.width/2-320,c.y=s.sprite.height/3-118,c.size=30,s.sprite.addChild(c),s.sprite.addChild(s.txInput2),s.txInput=new egret.TextField,s.txInput.type=egret.TextFieldType.INPUT,s.txInput.inputType=egret.TextFieldInputType.TEXT,s.txInput.width=290,s.txInput.height=50,s.txInput.x=s.sprite.width/2+80,s.txInput.y=s.sprite.height/3,s.txInput.anchorOffsetX=s.txInput.width/2,s.txInput.anchorOffsetY=s.txInput.height/2,s.txInput.textColor=855309,s.txInput.size=40;var l=new egret.TextField;l.text="input your name:",l.x=s.sprite.width/2-320,l.y=s.sprite.height/3-18,l.size=30,s.sprite.addChild(l),s.sprite.addChild(s.txInput);var d=new egret.Shape;d.graphics.beginFill(52224),d.graphics.drawRect(0,0,200,50),d.graphics.endFill(),d.x=s.sprite.width/2,d.y=s.sprite.height/2,d.anchorOffsetX=d.width/2,d.anchorOffsetY=d.height/2,d.touchEnabled=!0,d.addEventListener(egret.TouchEvent.TOUCH_BEGIN,s.onTouchBegin,s),s.sprite.addChild(d);var g=new egret.TextField;return g.text="play",g.anchorOffsetX=g.width/2,g.anchorOffsetY=g.height/2,g.x=s.sprite.width/2,g.y=s.sprite.height/2,s.sprite.addChild(g),s.text2=new egret.TextField,s.text2.text="please input your name and the game's secret",s.text2.width=r,s.sprite.addChild(s.text2),s}return __extends(i,t),i.prototype.onTouchBegin=function(){var t=this.txInput.text;this.player=t;var i=this.txInput2.text;console.log("player:"+t);var a=this;t&&i?(base.API.Init("http://work.metatype.cn:8105/api/"),base.API.call("find_players",{game_secret:a.game_secret,gameName:a.gameName}).then(function(r){var n=r.player_list,s=n.indexOf(a.txInput.text);i!=a.game_secret?a.text2.text="please input the correct password to enter the game":-1==s?a.text2.text="you aren't invited !":a.stage&&base.API.call("get_players_process",{game_secret:a.game_secret,inviter_name:a.inviter,player:t,gameName:a.gameName}).then(function(r){console.log(r);var n=r.process,s=r.playercount,o=r.processson;if(a.playerCount=s,"2.0"==n){var h=new e.CharacterChoosePage(i,a.inviter,t,a.gameName,a.stage.stageWidth,a.stage.stageHeight,s);a.stage.addChild(h),a.sprite.visible=!1}else if("3"==n){var c=a,l=0;base.API.call("get_player_characterlist",{game_secret:c.game_secret,inviter:c.inviter,player:c.player,gameName:c.gameName}).then(function(t){var i=t.data;console.log(i);var r=[];i.forEach(function(e,t,i){var r=e[0];-1==a.playerList.indexOf(r)&&(l++,c.allcharacterlist.push(e[1]),c.playerList.push(r))}),console.log("character_list"),r.push(c.playerList),r.push(c.allcharacterlist);var n=[],s=[],h=[],d=[];a.playerList.forEach(function(e,t,i){e==c.player?(n.push(e),n.push(c.allcharacterlist[t])):(h.push(e),d.push(c.allcharacterlist[t]))}),s.push(h),s.push(d),n.push(s),console.log(n);var g=c.game_secret,p=c.inviter,u=c.player,m=c.gameName,v=c.stage.stageWidth,x=c.stage.stageHeight,y=o,f=new e.Character(g,p,u,m,v,x,y,r,n);c.stage.addChild(f),c.sprite.visible=!1})}else if("4"==n){var c=a,l=0;base.API.call("get_player_characterlist",{game_secret:c.game_secret,inviter:c.inviter,player:c.player,gameName:c.gameName}).then(function(r){var n=r.data,o=[];n.forEach(function(e,t,i){var r=e[0];-1==a.playerList.indexOf(r)&&(l++,c.allcharacterlist.push(e[1]),c.playerList.push(r))}),l==s&&(console.log("character_list"),o.push(c.playerList),o.push(c.allcharacterlist));var h=new e.TensionScaleResult(c.stage.stageWidth,c.stage.stageHeight,c.inviter,i,t,c.gameName,o,s);c.stage.addChild(h),c.sprite.visible=!1})}else{var d=new e.GamePageOne(i,a.inviter,t,a.gameName,a.stage.stageWidth,a.stage.stageHeight);a.stage.addChild(d),a.sprite.visible=!1}}),a.isPlayer=s})["catch"](function(e){console.log(e)})):this.text2.text="you must input your name and the game's secret"},i.prototype.onTouchEnd=function(){egret.log("onTouchEnd")},i.prototype.onTouchMove=function(){egret.log("onTouchMove")},i.prototype.onTouchTap=function(){egret.log("onTouchTap")},i}(egret.DisplayObjectContainer);e.EnterGame=t,__reflect(t.prototype,"game.EnterGame")}(game||(game={}));var game;!function(e){var t=function(t){function i(e,i,a,r,n,s,o,h,c,l,d){var g=t.call(this)||this;return g.stageWidth=0,g.stageHeight=0,g._x=20,g._width=230,g.character1="",g.character2="",g.playerName="",g.selfPerception=0,g.individualTensionScale=[],g.individualTensionScaleMedian=0,g.deviationBetweenITSM_SP=0,g.teamTensionScaleMedian=0,g.zoraMin=0,g.lowest=0,g.highest=0,g.count=0,g.median=0,g.votedScalesNumber=1,g.scalesNumber=7,g.stageWidth=e,g.stageHeight=i,g.character1=a,g.character2=r,g.playerName=n,g.selfPerception=s,g.game_secret=o,g.inviter=h,g.gameName=c,g.chooser=l,g.scorecount=d,g.sprite=new egret.Sprite,g.sprite.addEventListener(egret.Event.ADDED_TO_STAGE,g.tensionScale,g),g.addChild(g.sprite),g.character1Sprite=new egret.TextField,g.character2Sprite=new egret.TextField,g.itsm_Deviation=new egret.TextField,g.individualTensionScaleMedianPlayerName=new egret.TextField,g.sprite.addChild(g.character1Sprite),g.sprite.addChild(g.character2Sprite),g.sprite.addChild(g.itsm_Deviation),g.sprite.addChild(g.individualTensionScaleMedianPlayerName),g.zora=new egret.TextField,g.sprite.addChild(g.zora),g.zoraMedianLine=new egret.Shape,g.sprite.addChild(g.zoraMedianLine),g.initSprite(),g.timer=new egret.Timer(1e3,0),g.timer.addEventListener(egret.TimerEvent.TIMER,g.getttsm,g),g.timer.start(),g.rightIcon(),g.tiptext=new egret.TextField,g.noticetext=new egret.TextField,g.sprite.addChild(g.noticetext),g.sprite.addChild(g.tiptext),g.tip(),g.notice2(),g}return __extends(i,t),i.prototype.initSprite=function(){var e=this.character1Sprite;e.text=this.character1,e.x=this._x,e.width=this._width,e.textAlign=egret.HorizontalAlign.CENTER,e.border=!0,e.borderColor=0,e.background=!0,e.backgroundColor=5480339;var t=this.character2Sprite;t.text=this.character2,t.x=this._x,t.y=840,t.width=this._width,t.textAlign=egret.HorizontalAlign.CENTER,t.border=!0,t.borderColor=0,t.background=!0,t.backgroundColor=5480339;var i=new egret.Shape;i.graphics.lineStyle(2,11149824),i.graphics.moveTo(this._x+e.width/2,e.height),i.graphics.lineTo(this._x+t.width/2,t.y),i.graphics.endFill(),this.sprite.addChild(i);var a=this.zora;a.x=this._x,a.width=230,a.border=!0,a.background=!0,a.backgroundColor=13356134;var r=this.zoraMedianLine;r.graphics.lineStyle(5,3355443),r.graphics.moveTo(this._x,0),r.graphics.lineTo(250,0),r.graphics.endFill();var n=this.itsm_Deviation;n.text=this.individualTensionScaleMedian.toString()+"/"+this.deviationBetweenITSM_SP.toString(),n.textColor=0,n.x=this._x+this.character1Sprite.width/2,n.y=this.individualTensionScaleMedian/81*810-n.height/2,n.width=100,n.textAlign=egret.HorizontalAlign.CENTER,n.border=!0,n.borderColor=0,n.background=!0,n.backgroundColor=16777215;var s=this.individualTensionScaleMedianPlayerName;s.text=this.playerName,s.textColor=0,s.x=n.x-s.width,s.y=this.individualTensionScaleMedian/81*810-s.height/2,s.width=100,s.textAlign=egret.HorizontalAlign.CENTER,s.border=!0,s.borderColor=0},i.prototype.getttsm=function(){var e=this;base.API.Init("http://work.metatype.cn:8105/api/"),base.API.call("getttsmindividual",{inviter_name:e.inviter,game_secret:e.game_secret,player:e.playerName,gameName:e.gameName,c1:e.character1,c2:e.character2,chooser:e.chooser}).then(function(t){e.teamTensionScaleMedian=t.ttsm,e.individualTensionScale=t.individualTensionScale,e.playerCount=t.playerCount,e.votedScalesNumber=e.individualTensionScale.length+1,e.noticetext.text=Math.ceil(e.votedScalesNumber/e.playerCount*100).toString()+"% of your Teammates ("+e.votedScalesNumber.toString()+" out of "+e.playerCount+") have so far voted the "+e.character1+" & "+e.character2+"Tension Scale. Here are Early Insights:",e.tensionScale()})},i.prototype.notice=function(){var e=new egret.TextField;e.text="54% of your Teammates (7 out of 13) have so far voted the Carefulness & Power Tension Scale. Here are Early Insights:",e.width=600,e.x=-350,e.y=-130,e.background=!0,e.backgroundColor=3514259,this.sprite.addChild(e)},i.prototype.notice2=function(){var e=this.noticetext;e.width=600,e.x=-350,e.y=-130,e.background=!0,e.backgroundColor=3514259},i.prototype.tip2=function(){var e=this.tiptext;e.text="",e.width=350,e.x=-350,e.y=80,e.background=!0,e.backgroundColor=3514259,this.sprite.addChild(e)},i.prototype.tip=function(){var e=new egret.TextField;e.text="• Your Self-Perception at 6 points is inside the preliminary Zone of Responsible Action.\n\n• Your teammates rank you at 46 a total of 40 points higher than your self-perception at 6 points.\n\n• While 21 points is the lowest and 70 points the highest value that others attributed to you.\n\n• Thus 71% of your relationships on this scale are tense.",e.width=350,e.x=-350,e.y=-10,e.background=!0,e.backgroundColor=3514259,this.sprite.addChild(e)},i.prototype.rightIcon=function(){var e=new egret.Bitmap(RES.getRes("right_png"));e.width=100,e.height=100,e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height/2,e.x=140,e.y=this.stageHeight-230,e.touchEnabled=!0,e.addEventListener(egret.TouchEvent.TOUCH_TAP,this.nextTouch,this),this.sprite.addChild(e)},i.prototype.nextTouch=function(){var t="1",i="1";this.timer.stop(),base.API.Init("http://work.metatype.cn:8105/api/"),base.API.call("save_players_process",{inviter_name:this.inviter,game_secret:this.game_secret,player:this.playerName,game_name:this.gameName,process:"1."+this.scorecount.toString()+"2"}).then(function(e){}),this.sprite.visible=!1;var a=new e.KeepUpVoting(this.stageWidth,this.stageHeight,t,i,this.inviter,this.game_secret,this.playerName,this.gameName,this.scorecount);this.stage.addChild(a)},i.prototype.tensionScale=function(){var e=this,t=this.teamTensionScaleMedian;console.log(t);var i=10*t-2.5,a=t-13;this.zoraMin=a;var r=t+13,n=10*a,s=10*r,o=this.zora;o.height=s-n,o.y=n,this.sprite.setChildIndex(o,0),this.zoraMedianLine.y=i;var h=new egret.TextField;h.text=this.selfPerception.toString(),h.textColor=0,h.x=this._x+this.character1Sprite.width/2,h.y=this.selfPerception/81*810-h.height/2,h.width=70,h.textAlign=egret.HorizontalAlign.CENTER,h.border=!0,h.borderColor=0,h.background=!0,h.backgroundColor=16777215,(a>this.selfPerception||this.selfPerception>r)&&(h.backgroundColor=13408562),this.sprite.addChild(h);var c=new egret.TextField;c.text=this.playerName,c.textColor=0,c.x=h.x-c.width,c.y=this.selfPerception/81*810-c.height/2,c.width=100,c.textAlign=egret.HorizontalAlign.CENTER,c.border=!0,c.borderColor=0,18*this.playerName.length<100?(c.width=100,c.x=h.x-c.width):(c.width=18*this.playerName.length,c.x=h.x-c.width),this.sprite.addChild(c),this.individualTensionScale.length>0&&(console.log(this.individualTensionScale),this.individualTensionScaleMedian=Math.round(this.individualTensionScale.reduce(function(e,t){return t+=e})/this.individualTensionScale.length),this.deviationBetweenITSM_SP=this.selfPerception-this.individualTensionScaleMedian);var l=this.itsm_Deviation;l.text=this.individualTensionScaleMedian.toString()+"/"+this.deviationBetweenITSM_SP.toString(),l.y=this.individualTensionScaleMedian/81*810-l.height/2,(a>this.individualTensionScaleMedian||this.individualTensionScaleMedian>r)&&(l.backgroundColor=16711475),this.sprite.addChild(l);var d=this.individualTensionScaleMedianPlayerName;d.text=this.playerName,d.x=l.x-d.width,d.y=this.individualTensionScaleMedian/81*810-d.height/2,18*this.playerName.length<100?(d.width=100,d.x=l.x-d.width):(d.width=18*this.playerName.length,d.x=l.x-d.width),this.individualTensionScale.forEach(function(t,i,n){var s=new egret.TextField;s.text=e.individualTensionScale[i].toString(),s.x=e._x+e.character1Sprite.width/2,s.y=e.individualTensionScale[i]/81*810-s.height/2,s.width=70,s.textAlign=egret.HorizontalAlign.CENTER,s.textColor=0,s.border=!0,s.borderColor=0,s.background=!0,s.backgroundColor=16777215,i%2==0&&(s.x=e._x+e.character1Sprite.width/2-s.width),(a>e.individualTensionScale[i]||e.individualTensionScale[i]>r)&&(s.backgroundColor=13408562),e.sprite.addChild(s)});var g=this.individualTensionScale;g.sort();var p=(g.pop(),g.shift(),0);this.individualTensionScale.forEach(function(e,t,i){p+=e},0);Math.ceil(p/this.playerCount)},i}(egret.DisplayObjectContainer);e.ExpandedTensionScale=t,__reflect(t.prototype,"game.ExpandedTensionScale")}(game||(game={}));var game;!function(e){var t=function(t){function i(i,a,r,n,s,o){var h=t.call(this)||this;h.playerList=[],h.game_secret="",h.player="",h.gameName="",h.inviter="",h.stageWidth=0,h.stageHeight=0,h.characterTwo="Fully",h.characterOne="Insufficiently",h._touchStatus=!1,h._distance=new egret.Point,h.characterList=[],h.map={},h.playerSCore="",h.game_secret=i,h.player=r,h.gameName=n,h.inviter=a,h.stageWidth=s,h.stageHeight=o,h.sprite=new egret.Sprite,h.sprite.width=s,h.sprite.height=o,h.sprite.x=0,h.sprite.y=0,h.addChild(h.sprite),h.sprite.addEventListener(egret.Event.ADDED_TO_STAGE,h.getPlayList,h),h.clickTip(),h.rectShapeOne=new egret.Shape,h.rectShapeTwo=new egret.Shape,h.sprite.addChild(h.rectShapeOne),h.sprite.addChild(h.rectShapeTwo),h.drawRect();var c=new egret.TextField;c.text="Insufficiently",c.textAlign=egret.HorizontalAlign.CENTER,c.size=40,c.border=!0,c.width=280,c.borderColor=3825613,c.x=s-390,c.y=200,h.sprite.addChild(c),h._shape=new egret.Shape,h.addChild(h._shape),h.initGraphics(),h.charater2=new egret.TextField,h.sprite.addChild(h.charater2),h.initCharacter(s-390,h.stageHeight-150),h.rightIcon=new egret.Bitmap(RES.getRes("right_png")),h.rightIcon.width=100,h.rightIcon.height=100,h.rightIcon.anchorOffsetX=h.rightIcon.width/2,h.rightIcon.anchorOffsetY=h.rightIcon.height/2,h.rightIcon.x=s-50,h.rightIcon.y=o/2,h.rightIcon.touchEnabled=!0,h.rightIcon.visible=!1,h.addChild(h.rightIcon),h.rightIcon.addEventListener(egret.TouchEvent.TOUCH_BEGIN,h.nextTouch,h),h.closeIcon=new egret.Bitmap(RES.getRes("close-circle_png")),h.closeIcon.width=40,h.closeIcon.height=40,h.closeIcon.anchorOffsetX=h.closeIcon.width/2,h.closeIcon.anchorOffsetY=h.closeIcon.height/2,h.closeIcon.x=s-30,h.closeIcon.y=150,h.closeIcon.touchEnabled=!0,h.closeIcon.addEventListener(egret.TouchEvent.TOUCH_BEGIN,h.closeTip,h),h.addChild(h.closeIcon),h.tiptext=new egret.TextField,h.addChild(h.tiptext);var l=" The ARK is serving the cause of tapping into your teams‘ full potential. Your first task: ANONY- MOUSLY rank your team on this Potentiality Sca- le from 1 to 81.";h.tip(1,50,l,30);var d=new e.ProcessBar(s,o,5,"Inititate > Potential Scale");return h.sprite.addChild(d),h}return __extends(i,t),i.prototype.closeTip=function(){this.tiptext.parent&&this.removeChild(this.tiptext)},i.prototype.nextTouch=function(){if(this.stage){var t=this;base.API.Init("http://work.metatype.cn:8105/api/"),base.API.call("firstvote",{score:t.playerSCore,game_secret:t.game_secret,inviter_name:t.inviter,player:t.player,gameName:t.gameName}).then(function(e){console.log(e)}),base.API.call("save_players_process",{inviter_name:t.inviter,game_secret:t.game_secret,player:t.player,game_name:t.gameName,process:"0.1"}).then(function(i){var a=t.game_secret,r=t.inviter,n=t.player,s=t.gameName,o=t.stageWidth,h=t.stageHeight,c=t.playerSCore,l=t.playerList.length;t.sprite.visible=!1,t.removeChild(t.rightIcon),t.removeChild(t.closeIcon),t.closeTip(),t._shape.visible=!1;var d=new e.InitiatePartialInsights(a,r,n,s,o,h,l,c);t.stage.addChild(d)})}},i.prototype.tip=function(e,t,i,a){var r=this.tiptext;r.x=e,r.y=t,r.text=i,r.size=a,r.width=this.stageWidth},i.prototype.clickTip=function(){var e=new egret.TextField;e.text="Drag & Drop your  Icon on the scale  as you see fit. The question: In retro-spective, to what e-xtent does your te-am tap into its full  POTENTIAL...",e.width=250,e.x=30,e.y=450,e.background=!0,e.backgroundColor=3514259,this.sprite.addChild(e)},i.prototype.drawRect=function(){var e=this.rectShapeOne;e.graphics.beginFill(3514259,.5),e.graphics.drawRect(0,0,this.stageWidth+60,180),e.graphics.endFill();var t=this.rectShapeTwo;t.graphics.beginFill(3514259,.5),t.graphics.drawRect(0,this.stageHeight-100,this.stageWidth+60,200),t.graphics.endFill()},i.prototype.initGraphics=function(){var e=this._shape;e.graphics.lineStyle(2,16711935),e.graphics.moveTo(this.stageWidth-250,this.stageHeight-150),e.graphics.lineTo(this.stageWidth-250,240)},i.prototype.initCharacter=function(e,t){var i=this.charater2;i.text="Fully",i.textAlign=egret.HorizontalAlign.CENTER,i.size=40,i.border=!0,i.width=280,i.borderColor=3825613,i.x=e,i.y=t},i.prototype.getPlayList=function(){base.API.Init("http://work.metatype.cn:8105/api/");var e=this;base.API.call("get_player_list",{game_secret:e.game_secret,gameName:e.gameName,inviter:e.inviter}).then(function(t){var i=this;e.playerList=t.player_list,e.playerList.forEach(function(t,a,r){if(t==e.player){var n=new egret.TextField;n.text=t,n.textAlign=egret.HorizontalAlign.CENTER,n.size=30,n.lineSpacing=10,n.touchEnabled=!0,n.border=!0,18*t.length<100?n.width=100:n.width=18*t.length,n.borderColor=65280,n.x=70,n.y=300+50*a;var s=new egret.TextField;s.text="",s.size=30,s.border=!0,s.width=50,s.borderColor=65280,s.textAlign=egret.HorizontalAlign.CENTER,n.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(t){e._touchStatus=!0;var a=t.stageX,r=n.x,o=n.y,h=t.stageY;n.addEventListener(egret.TouchEvent.TOUCH_MOVE,function(t){if(e._touchStatus){n.x=t.stageX-a+r,n.y=t.stageY-h+o,s.parent&&s.parent.removeChild(s);var i=100;if(n.width>100&&(i=n.width),n.x>e.stageWidth-250-i&&(n.x=e.stageWidth-250-i,n.y>240&&n.y<e.stageHeight-150-n.height)){s.x=n.x+i,s.y=n.y;var c=(e.stageHeight-150-240-n.height)/81;s.text=Math.ceil((s.y-240)/c).toString(),e.sprite.addChild(s);var l=Math.ceil((s.y-240)/c).toString();e.playerSCore=l;var d=n.text;e.map[d]=l,e.rightIcon.visible=!0}n.y>e.stageHeight-150-n.height&&(n.y=e.stageHeight-150-n.height)}},i)},i),n.addEventListener(egret.TouchEvent.TOUCH_END,function(t){e._touchStatus=!1,n.removeEventListener(egret.TouchEvent.TOUCH_MOVE,i.mouseMove,i)},i),e.sprite.addChild(n)}})})},i}(egret.DisplayObjectContainer);e.GamePageOne=t,__reflect(t.prototype,"game.GamePageOne")}(game||(game={}));var game;!function(e){var t=function(t){function i(e,i,a,r){var n=t.call(this)||this;return n.game_list=[],n.stageWidth=0,n.stageHeight=0,n.stageWidth=e,n.stageHeight=i,n.sprite=new egret.Sprite,n.addChild(n.sprite),n.sprite.touchEnabled=!0,n.nickname=a,n.openid=r,n.label=new egret.TextField,n.label.text="start",n.label.height=30,n.label.width=80,n.label.anchorOffsetX=n.label.width/2,n.label.anchorOffsetY=n.label.height/2,n.label.x=n.stageWidth/2,n.label.y=n.stageHeight/2,n.label.touchEnabled=!0,n.label.background=!0,n.label.backgroundColor=16777215,n.label.border=!0,n.label.borderColor=65280,n.label.fontFamily="Arial",n.label.textColor=16711680,n.label.addEventListener(egret.TouchEvent.TOUCH_BEGIN,n.onTouchBegin,n),n.sprite.addChild(n.label),n}return __extends(i,t),i.prototype.onTouchBegin=function(){if(base.API.Init("http://work.metatype.cn:8105/api/"),base.API.call("create_game",{inviter:this.nickname,gameName:this.openid,game_id:this.openid}).then(function(e){})["catch"](function(e){}),this.stage){this.sprite.visible=!1;var t=new e.CreateGame(this.stage.stageWidth,this.stage.stageHeight,this.nickname,this.openid,this.openid,this.nickname,"inviter");this.stage.addChild(t)}},i}(egret.DisplayObjectContainer);e.Index=t,__reflect(t.prototype,"game.Index")}(game||(game={}));var Main=function(e){function t(){var t=e.call(this)||this;return t.addEventListener(egret.Event.ADDED_TO_STAGE,t.onAddToStage,t),t}return __extends(t,e),t.prototype.onAddToStage=function(e){egret.lifecycle.addLifecycleListener(function(e){e.onUpdate=function(){}}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()},this.runGame()["catch"](function(e){console.log(e)})},t.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){var e,t;
return __generator(this,function(i){switch(i.label){case 0:return[4,this.loadResource()];case 1:return i.sent(),this.createGameScene(),[4,RES.getResAsync("description_json")];case 2:return e=i.sent(),[4,platform.login()];case 3:return i.sent(),[4,platform.getUserInfo()];case 4:return t=i.sent(),console.log(t),[2]}})})},t.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var e,t;return __generator(this,function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),e=new LoadingUI,this.stage.addChild(e),[4,RES.loadConfig("resource/default.res.json","resource/")];case 1:return i.sent(),[4,RES.loadGroup("preload",0,e)];case 2:return i.sent(),this.stage.removeChild(e),[3,4];case 3:return t=i.sent(),console.error(t),[3,4];case 4:return[2]}})})},t.prototype.createGameScene=function(){base.API.Init("http://work.metatype.cn:8105/api/");var e=window.location.href;if(-1!=e.indexOf("game_id")){var t=e.split("?")[1].split("&")[0].split("=")[1],i=e.split("?")[1].split("&")[1].split("=")[1];if(-1!=e.indexOf("code")){var a=e.split("?")[1].split("&")[2].split("=")[1],r=this;base.API.call("wechatlogin",{code:a,inviter:i,game_name:t,game_secret:t}).then(function(e){var a=e.result,n=a.openid,s=a.nickname,o=r.stage.stageWidth,h=r.stage.stageHeight;base.API.call("getGameStatus",{inviter_name:i,game_secret:t,gameName:t,openid:n,nickname:s}).then(function(e){var a=e.result;if(2==a)alert("The game is in progress.");else if(3==a)alert("game over.");else{var c=new game.CreateGame(o,h,s,n,t,i,"player");r.stage.addChild(c)}})})}else{var n=encodeURIComponent("http://ark.metatype.cn/index.html?game_id="+t+"&nickname="+i);window.location.href="https://open.weixin.qq.com/connect/oauth2/authorize?appid=wxc7594d7d49e0235f&redirect_uri="+n+"&response_type=code&scope=snsapi_userinfo&state=1"}}else if(-1!=e.indexOf("code")){var a=e.split("?")[1].split("&")[0].split("=")[1];base.API.Init("http://work.metatype.cn:8105/api/");var s=this;base.API.call("wechatlogin",{code:a}).then(function(e){var t=e.result,i=t.openid,a=t.nickname,r=s.stage.stageWidth,n=s.stage.stageHeight,o=new game.Index(r,n,a,i);s.stage.addChild(o)})}else{var n=encodeURIComponent("http://ark.metatype.cn/index.html");window.location.href="https://open.weixin.qq.com/connect/oauth2/authorize?appid=wxc7594d7d49e0235f&redirect_uri="+n+"&response_type=code&scope=snsapi_userinfo&state=1"}},t.prototype.createBitmapByName=function(e){var t=new egret.Bitmap,i=RES.getRes(e);return t.texture=i,t},t.prototype.startAnimation=function(e){var t=this,i=new egret.HtmlTextParser,a=e.map(function(e){return i.parse(e)}),r=this.textfield,n=-1,s=function(){n++,n>=a.length&&(n=0);var e=a[n];r.textFlow=e;var i=egret.Tween.get(r);i.to({alpha:1},200),i.wait(2e3),i.to({alpha:0},200),i.call(s,t)};s()},t}(egret.DisplayObjectContainer);__reflect(Main.prototype,"Main");var game;!function(e){var t=function(t){function i(e,i,a,r,n){var s=t.call(this)||this;s.count=0,s.playerList=[],s.game_secret="",s.inviter="",s.gameName="",s.game_secret=e,s.inviter=i,s.gameName=a,s.sprite=new egret.Sprite,s.sprite.width=r,s.sprite.height=n,s.addChild(s.sprite);var o=new egret.Shape;o.graphics.beginFill(16774638),o.graphics.drawRect(0,0,300,50),o.graphics.endFill(),o.x=s.sprite.width/2+60,o.y=s.sprite.height/3,o.anchorOffsetX=o.width/2,o.anchorOffsetY=o.height/2,s.sprite.addChild(o),s.txInput=new egret.TextField,s.txInput.type=egret.TextFieldType.INPUT,s.txInput.inputType=egret.TextFieldInputType.TEXT,s.txInput.width=290,s.txInput.height=50,s.txInput.x=s.sprite.width/2+60,s.txInput.y=s.sprite.height/3,s.txInput.anchorOffsetX=s.txInput.width/2,s.txInput.anchorOffsetY=s.txInput.height/2,s.txInput.textColor=855309,s.txInput.size=40;var h=new egret.TextField;h.text="input player:",h.x=s.sprite.width/2-280,h.y=s.sprite.height/3-18,h.size=30,s.sprite.addChild(h),s.sprite.addChild(s.txInput);var c=new egret.Shape;c.graphics.beginFill(52224),c.graphics.drawRect(0,0,200,50),c.graphics.endFill(),c.x=s.sprite.width/2,c.y=s.sprite.height/2,c.anchorOffsetX=c.width/2,c.anchorOffsetY=c.height/2,c.touchEnabled=!0,c.addEventListener(egret.TouchEvent.TOUCH_BEGIN,s.onTouchBegin,s),s.sprite.addChild(c);var l=new egret.TextField;l.text="invite",l.anchorOffsetX=l.width/2,l.anchorOffsetY=l.height/2,l.x=s.sprite.width/2,l.y=s.sprite.height/2,s.sprite.addChild(l);var d=new egret.Shape;d.graphics.beginFill(52224),d.graphics.drawRect(0,0,200,50),d.graphics.endFill(),d.x=s.sprite.width/2,d.y=s.sprite.height/2+100,d.anchorOffsetX=c.width/2,d.anchorOffsetY=c.height/2,d.touchEnabled=!0,d.addEventListener(egret.TouchEvent.TOUCH_BEGIN,s.onTouchBegin2,s),s.sprite.addChild(d);var g=new egret.TextField;return g.text="play",g.anchorOffsetX=g.width/2,g.anchorOffsetY=g.height/2,g.x=s.sprite.width/2,g.y=s.sprite.height/2+100,s.sprite.addChild(g),s.text2=new egret.TextField,s.text2.text="You have invited "+s.count+" players",s.text2.width=r,s.sprite.addChild(s.text2),s}return __extends(i,t),i.prototype.invateFriends=function(){var e=new BodyConfig;e.appId="wx4f735f8d65cf5f28",e.debug=!0,wx&&(wx.config(e),wx.ready(function(){console.log(12),wx.checkJsApi({jsApiList:["chooseImage"],success:function(e){console.log(333),console.log(e)}})}))},i.prototype.onTouchBegin=function(){var e=this,t=this.txInput.text;if(t){var i=0;if(this.playerList.forEach(function(a,r,n){console.log(a),a==t&&(e.text2.text="please dont invite the duplicate player !",i=1)}),0==i){this.playerList.push(t),this.count+=1,this.text2.text="You have invited "+this.count+" players";var a=this;base.API.Init("http://work.metatype.cn:8105/api/"),base.API.call("create_player",{player_name:t,game_secret:a.game_secret,gameName:a.gameName,inviter:a.inviter}).then(function(e){console.log(e)})["catch"](function(e){console.log(e)})}}},i.prototype.onTouchBegin2=function(){if(this.playerList.length<2)this.text2.text="You must invite 3 players to start the game at least!";else{var t=this;if(this.stage){var i=new e.GamePageOne(t.game_secret,t.inviter,t.inviter,t.gameName,this.stage.stageWidth,this.stage.stageHeight);this.stage.addChild(i),t.sprite.visible=!1}}},i.prototype.onTouchEnd=function(){egret.log("onTouchEnd")},i.prototype.onTouchMove=function(){egret.log("onTouchMove")},i.prototype.onTouchTap=function(){egret.log("onTouchTap")},i}(egret.DisplayObjectContainer);e.InviteFriends=t,__reflect(t.prototype,"game.InviteFriends")}(game||(game={}));var game;!function(e){var t=function(t){function i(e,i,a,r,n,s,o,h,c,l,d){var g=t.call(this)||this;return g.stageWidth=0,g.stageHeight=0,g.game_secret="",g.gameName="",g.inviter="",g.player="",g._width=600,g.noticeHeight=140,g._x=20,g._margin=20,g.characterListParams=[],g.votedScalesNumber=1,g.scalesNumber=7,g.ttsms=[],g.player_list=[],g.votedPlayerList=[],g.remainingPlayersList=[],g.simulatedData=[],g.stageWidth=e,g.stageHeight=i,g.sprite=new egret.Sprite,g.addChild(g.sprite),g.player=a,g.inviter=r,g.game_secret=n,g.gameName=s,g.count=o,g.simulatedData=h,g.player_list=c,g.votedPlayerList=l,g.remainingPlayersList=d,g.scalesNumber=g.player_list.length,g.votedScalesNumber=g.votedPlayerList.length,g.remainingScalesNumber=g.scalesNumber-g.votedScalesNumber,g.background(),g.remainingPlayers(),g.votedPlayers(),g.processBar(),g.notice(),g.rightIcon(),g.noticeBox=new egret.TextField,g}return __extends(i,t),i.prototype.processBar=function(){var t=new e.ProcessBar(this.stageWidth,this.stageHeight,55,"Mission 2 > Keep Up Supporting");this.sprite.addChild(t)},i.prototype.notice=function(){var e=this.votedScalesNumber.toString(),t=this.scalesNumber.toString(),i=this.remainingScalesNumber.toString();this.noticeBox=new egret.TextField,this.noticeBox.text="Great! You answered "+e.toString()+" out of "+t.toString()+" Feedbacks. Fill in the remaining "+i.toString()+" to finish Mission 2 and Embrace your teammates anonymous Feedback for a better deployment of the team's potentialities.!",this.noticeBox.textColor=0,this.noticeBox.width=this._width,this.noticeBox.height=this.noticeHeight,this.noticeBox.x=this._x,this.noticeBox.y=60,this.noticeBox.background=!0,this.noticeBox.backgroundColor=16763955,this.sprite.addChild(this.noticeBox)},i.prototype.background=function(){var e=new egret.Shape;e.x=this._x/2,e.y=100,e.graphics.beginFill(13421772,1),e.graphics.drawRect(e.x,e.y,380,this.stageHeight),e.graphics.endFill(),this.sprite.addChild(e);var t=new egret.Shape;t.x=this._x/2+e.width/2+this._margin/2,t.y=100,t.graphics.beginFill(16763955,1),t.graphics.drawRect(t.x,t.y,200,this.stageHeight),t.graphics.endFill(),this.sprite.addChild(t)},i.prototype.remainingPlayers=function(){var e=new eui.Group,t='\n                        <e:Skin xmlns:e="http://ns.egret.com/eui" states="up,down" height="50">\n                            <e:Label text="{data}" textColor.down="0xFFFFFF" textColor.up="0x666666" horizontalCenter="0" verticalCenter="0"/> \n                        </e:Skin>',i=new eui.List,a=this.remainingPlayersList;i.dataProvider=new eui.ArrayCollection(a),i.itemRendererSkinName=t,e.addChild(i);var r=new eui.Scroller;r.width=380,r.height=this.stageHeight-80-120,r.x=r.width/2-40,r.y=230,r.viewport=e,this.sprite.addChild(r)},i.prototype.votedPlayers=function(){var e=new eui.Group,t='\n                        <e:Skin xmlns:e="http://ns.egret.com/eui" states="up,down" height="50">\n                            <e:Label text="{data}" textColor.down="0xFFFFFF" textColor.up="0x666666" horizontalCenter="0" verticalCenter="0"/> \n                        </e:Skin>',i=new eui.List,a=this.votedPlayerList;i.dataProvider=new eui.ArrayCollection(a),i.itemRendererSkinName=t,e.addChild(i);var r=new eui.Scroller;r.width=380,r.height=this.stageHeight-80-120,r.x=this.stageWidth-r.width/2+30,r.y=230,r.viewport=e,this.sprite.addChild(r)},i.prototype.rightIcon=function(){var e=new egret.Bitmap(RES.getRes("right_png"));e.width=100,e.height=100,e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height/2,e.x=this.stageWidth-50,e.y=this.stageHeight-50,e.touchEnabled=!0,e.addEventListener(egret.TouchEvent.TOUCH_TAP,this.nextPage,this),this.sprite.addChild(e)},i.prototype.nextPage=function(){if(this.count+1==this.player_list.length){base.API.call("save_players_process",{inviter_name:this.inviter,game_secret:this.game_secret,player:this.player,game_name:this.gameName,process:"5"}).then(function(e){});var t=this;base.API.Init("http://work.metatype.cn:8105/api/"),base.API.call("getOthersFeedback",{game_secret:t.game_secret,gameName:t.gameName,player:t.player,inviter:t.inviter}).then(function(i){var a=i.result;t.sprite.visible=!1;var r=new e.DigestLove(t.stageWidth,t.stageHeight,a,t.inviter,t.game_secret,t.gameName,t.player);t.stage.addChild(r)})}else{var i=this.count+1;this.sprite.visible=!1;var a=new e.LoveAddAsk(this.stageWidth,this.stageHeight,i,this.simulatedData,this.player,this.inviter,this.game_secret,this.gameName);this.stage.addChild(a)}},i}(egret.DisplayObjectContainer);e.KeepUpSupporting=t,__reflect(t.prototype,"game.KeepUpSupporting")}(game||(game={}));var game;!function(e){var t=function(t){function i(e,i,a,r,n,s,o,h,c){var l=t.call(this)||this;return l.stageWidth=0,l.stageHeight=0,l.game_secret="",l.gameName="",l.inviter="",l.player="",l._width=600,l._x=20,l._margin=20,l.characterListParams=[],l.votedScalesNumber=1,l.scalesNumber=7,l.remainingScalesNumber=l.scalesNumber-l.votedScalesNumber,l.simulatedData1=[],l.simulatedData2=[],l.ttsms=[],l.scorecount=0,l.stageWidth=e,l.stageHeight=i,l.game_secret=s,l.player=o,l.gameName=h,l.inviter=n,l.scorecount=c,l.sprite=new egret.Sprite,l.addChild(l.sprite),l.noticeBox=new egret.TextField,l.background(),l.sprite.addChild(l.noticeBox),l.initNotice(),l.processBar(),l.rightIcon(),l.timer=new egret.Timer(1e3,0),l.timer.addEventListener(egret.TimerEvent.TIMER,l.getGameResult,l),l.timer.start(),l}return __extends(i,t),i.prototype.initNotice=function(){var e=this.noticeBox;e.textColor=0,e.width=this._width,e.x=this._x,e.y=60,e.background=!0,e.backgroundColor=16763955},i.prototype.processBar=function(){var t=new e.ProcessBar(this.stageWidth,this.stageHeight,55,"Mission 1 > Keep Up Voting");this.sprite.addChild(t)},i.prototype.notice=function(){var e=this.votedScalesNumber.toString(),t=this.scalesNumber.toString(),i=this.remainingScalesNumber.toString();this.noticeBox=new egret.TextField,this.noticeBox.text="Great! You cleared "+e.toString()+" out of "+t.toString()+" Tension Scales. Vote the remaining "+i.toString()+" to finish Mission 1 and discover your teams Zone of Responsible Action!",this.noticeBox.textColor=0,this.noticeBox.width=this._width,this.noticeBox.x=this._x,this.noticeBox.y=60,this.noticeBox.background=!0,this.noticeBox.backgroundColor=16763955,this.sprite.addChild(this.noticeBox)},i.prototype.background=function(){var e=new egret.Shape;e.x=this._x/2,e.y=100,e.graphics.beginFill(13421772,1),e.graphics.drawRect(e.x,e.y,380,this.stageHeight),e.graphics.endFill(),this.sprite.addChild(e);var t=new egret.Shape;t.x=this._x/2+e.width/2+this._margin/2,t.y=100,t.graphics.beginFill(16763955,1),t.graphics.drawRect(t.x,t.y,200,this.stageHeight),t.graphics.endFill(),this.sprite.addChild(t)},i.prototype.getGameResult=function(){var e=this;base.API.Init("http://work.metatype.cn:8105/api/"),base.API.call("getKeepUpVotingData",{inviter_name:e.inviter,game_secret:e.game_secret,player:e.player,gameName:e.gameName}).then(function(t){e.simulatedData1=t.simulatedData1,e.simulatedData2=t.simulatedData2;var i=e.simulatedData2.length,a=i+e.simulatedData1.length,r=e.simulatedData1.length;e.noticeBox.text="Great! You cleared "+i.toString()+" out of "+a.toString()+" Tension Scales. Vote the remaining "+r.toString()+" to finish Mission 1 and discover your teams Zone of Responsible Action!",e.tensionScale()})},i.prototype.tensionScale=function(){var t=this;this.simulatedData1.forEach(function(i,a,r){var n=(i[0],i[1],Number(i[2].toString())),s=Number(i[3].toString()),o=Math.abs(s-n),h=n,c=0,l=new e.TensionScale(100,60,[i[0],i[1]],o,s,c,h);a%2==1?(l.x=25,l.y=210+100*(a-1)):a%2==0&&(l.x=215,l.y=210+100*a),t.sprite.addChild(l)}),this.simulatedData2.forEach(function(i,a,r){var n=(i[0],i[1],Number(i[2].toString())),s=Number(i[3].toString()),o=Number(i[4].toString()),h=0,c=new e.TensionScale(100,60,[i[0],i[1]],s,o,h,n);c.x=430,c.y=210+150*a,t.sprite.addChild(c)})},i.prototype.rightIcon=function(){var e=new egret.Bitmap(RES.getRes("right_png"));e.width=100,e.height=100,e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height/2,e.x=this.stageWidth-50,e.y=this.stageHeight-50,e.touchEnabled=!0,e.addEventListener(egret.TouchEvent.TOUCH_TAP,this.nextTouch,this),this.sprite.addChild(e)},i.prototype.nextTouch=function(){var t=this,i=t.scorecount+1;base.API.Init("http://work.metatype.cn:8105/api/"),base.API.call("getCharacterList",{inviter_name:t.inviter,game_secret:t.game_secret,player:t.player,gameName:t.gameName}).then(function(a){var r=a.characterListParams,n=a.playerCount;if(t.playerCount=n,n>i)if(void 0!=r[1][i]){t.timer.stop(),t.sprite.visible=!1;var s=new e.Character(t.game_secret,t.inviter,t.player,t.gameName,t.stageWidth,t.stageHeight,t.scorecount+1,r,[]);t.stage.addChild(s)}else alert("Please wait for others to choose scale");else base.API.call("save_players_process",{inviter_name:t.inviter,game_secret:t.game_secret,player:t.player,game_name:t.gameName,process:"2.0"}).then(function(i){t.timer.stop(),t.sprite.visible=!1;var a=new e.TensionScaleResult(t.stageWidth,t.stageHeight,t.inviter,t.game_secret,t.player,t.gameName,r,t.playerCount);t.stage.addChild(a)})})},i}(egret.DisplayObjectContainer);e.KeepUpVoting=t,__reflect(t.prototype,"game.KeepUpVoting")}(game||(game={}));var game;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.sprite=new egret.Sprite,t.sprite.graphics.beginFill(16711680),t.sprite.graphics.drawRect(0,0,100,100),t.sprite.graphics.endFill(),t.addChild(t.sprite),t.sprite.touchEnabled=!0,t.sprite.addEventListener(egret.TouchEvent.TOUCH_BEGIN,t.onTouchBegin,t),t.sprite.addEventListener(egret.TouchEvent.TOUCH_END,t.onTouchEnd,t),t.sprite.addEventListener(egret.TouchEvent.TOUCH_MOVE,t.onTouchMove,t),t.sprite.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onTouchTap,t),t}return __extends(t,e),t.prototype.onTouchBegin=function(){this.sprite.visible=!1},t.prototype.onTouchEnd=function(){egret.log("onTouchEnd")},t.prototype.onTouchMove=function(){egret.log("onTouchMove")},t.prototype.onTouchTap=function(){egret.log("onTouchTap")},t}(egret.DisplayObjectContainer);e.LoadingScene=t,__reflect(t.prototype,"game.LoadingScene")}(game||(game={}));var game;!function(e){var t=function(t){function i(e,i,a,r,n,s,o,h){var c=t.call(this)||this;return c.stageWidth=0,c.stageHeight=0,c.game_secret="",c.gameName="",c.inviter="",c.player="",c._width=600,c._x=20,c._margin=20,c.playerName="",c.simulatedData=[],c.player_list=[],console.log(r),c.stageWidth=e,c.stageHeight=i,c.sprite=new egret.Sprite,c.addChild(c.sprite),c.count=a,c.simulatedData=r,c.player=n,c.inviter=s,c.game_secret=o,c.gameName=h,c.rightIcon=new egret.Bitmap(RES.getRes("right_png")),c.rightIcon.width=100,c.rightIcon.height=100,c.rightIcon.anchorOffsetX=c.rightIcon.width/2,c.rightIcon.anchorOffsetY=c.rightIcon.height/2,c.rightIcon.x=e-50,c.rightIcon.y=i-100,c.rightIcon.touchEnabled=!0,c.rightIcon.addEventListener(egret.TouchEvent.TOUCH_TAP,c.rightNext,c),c.sprite.addChild(c.rightIcon),c.processBar(),c.notice(),c.love(),c.loveInput(),c.add(),c.addInput(),c.ask(),c.askInput(),c.tensionScale(),c.initData(),c}return __extends(i,t),i.prototype.rightNext=function(){if(""!=this.loveInputText.text&&""!=this.addInputText.text&&""!=this.askInputText.text){base.API.call("save_players_process",{inviter_name:this.inviter,game_secret:this.game_secret,player:this.player,game_name:this.gameName,process:"4."+this.count.toString()+".1"}).then(function(e){});var t=this;base.API.Init("http://work.metatype.cn:8105/api/"),base.API.call("push_feedback",{game_secret:t.game_secret,gameName:t.gameName,player:t.player,inviter_name:t.inviter,love:t.loveInputText.text,add:t.addInputText.text,ask:t.askInputText.text,teammate:t.playerName}).then(function(i){var a=t.count,r=i.result,n=r[0],s=r[1],o=r[2];t.sprite.visible=!1;var h=new e.Preview(t.stageWidth,t.stageHeight,t.player,t.inviter,t.game_secret,t.gameName,a,n,s,o,t.simulatedData);t.stage.addChild(h)})}else alert("Please fill in all the feedback boards.")},i.prototype.initData=function(){var e=this;base.API.Init("http://work.metatype.cn:8105/api/"),base.API.call("get_players",{inviter:e.inviter,game_secret:e.game_secret,gameName:e.gameName,player:e.player}).then(function(t){var i=t.result;console.log(i),e.player_list=i,e.playerName=e.player_list[e.count],e.noticeBox.text="Feedback time for "+e.playerName+"\nLook at the basic integrative powers & tensions as a basis for ANONYMOUS feedback. What do you LOVE about her as a teammate, what could she ADD and did you always wanted to ask her? Take 1 minute per question, write fast & from the heart."})},i.prototype.processBar=function(){var t=new e.ProcessBar(this.stageWidth,this.stageHeight,10,"Mission 2 > Love, Add, Ask");this.sprite.addChild(t)},i.prototype.notice=function(){this.noticeBox=new egret.TextField,this.noticeBox.text="Feedback time for "+this.playerName+"\nLook at the basic integrative powers & tensions as a basis for ANONYMOUS feedback. What do you LOVE about her as a teammate, what could she ADD and did you always wanted to ask her? Take 1 minute per question, write fast & from the heart.",this.noticeBox.textColor=0,this.noticeBox.width=this._width,this.noticeBox.x=this._x,this.noticeBox.y=60,this.noticeBox.background=!0,this.noticeBox.backgroundColor=16763955,this.sprite.addChild(this.noticeBox)},i.prototype.love=function(){var e=new egret.TextField;e.text="LOVE",e.size=40,e.x=this._x,e.y=this.noticeBox.height+80,this.sprite.addChild(e);var t=new egret.TextField;t.text="I love this person, \nbecause...",t.size=20,t.x=this._x,t.y=this.noticeBox.height+130,t.width=100,this.sprite.addChild(t)},i.prototype.loveInput=function(){this.loveInputText=new egret.TextField,this.loveInputText.type=egret.TextFieldType.INPUT,this.loveInputText.inputType=egret.TextFieldInputType.TEXT,this.loveInputText.width=250,this.loveInputText.height=250,this.loveInputText.x=this._x+120,this.loveInputText.y=this.noticeBox.height+60+this._margin,this.loveInputText.textColor=855309,this.loveInputText.size=20,this.loveInputText.border=!0,this.loveInputText.borderColor=0,this.loveInputText.multiline=!0,this.sprite.addChild(this.loveInputText)},i.prototype.add=function(){var e=new egret.TextField;e.text="ADD",e.size=40,e.x=this._x,e.y=this.noticeBox.height+100+250,this.sprite.addChild(e);var t=new egret.TextField;t.text="I would love this person even more, if...",t.size=20,t.x=this._x,t.y=this.noticeBox.height+130+250+this._margin,t.width=100,this.sprite.addChild(t)},i.prototype.addInput=function(){this.addInputText=new egret.TextField,this.addInputText.type=egret.TextFieldType.INPUT,this.addInputText.inputType=egret.TextFieldInputType.TEXT,this.addInputText.width=250,this.addInputText.height=250,this.addInputText.x=this._x+120,this.addInputText.y=this.noticeBox.height+60+2*this._margin+250,this.addInputText.textColor=855309,this.addInputText.size=20,this.addInputText.border=!0,this.addInputText.borderColor=0,this.addInputText.multiline=!0,this.sprite.addChild(this.addInputText)},i.prototype.ask=function(){var e=new egret.TextField;e.text="ASK",e.size=40,e.x=this._x,e.y=this.noticeBox.height+120+500,this.sprite.addChild(e);var t=new egret.TextField;t.text="I always wanted to ask you...",t.size=20,t.x=this._x,t.y=this.noticeBox.height+130+500+2*this._margin,t.width=100,this.sprite.addChild(t)},i.prototype.askInput=function(){this.askInputText=new egret.TextField,this.askInputText.type=egret.TextFieldType.INPUT,this.askInputText.inputType=egret.TextFieldInputType.TEXT,this.askInputText.width=250,this.askInputText.height=250,this.askInputText.x=this._x+120,this.askInputText.y=this.noticeBox.height+60+3*this._margin+500,this.askInputText.textColor=855309,this.askInputText.size=20,this.askInputText.border=!0,this.askInputText.borderColor=0,this.askInputText.multiline=!0,this.sprite.addChild(this.askInputText)},i.prototype.pushFeedback=function(){console.log("123")},i.prototype.tensionScale=function(){var t=this;this.simulatedData.forEach(function(i,a,r){var n=(i[0],i[1],Number(i[2].toString())),s=Number(i[3].toString()),o=Math.abs(s-n),h=n,c=0,l=new e.TensionScale(100,60,[i[0],i[1]],o,s,c,h);l.x=420,l.y=t.noticeBox.height+210+t._margin+150*(a-1),t.sprite.addChild(l)})},i}(egret.DisplayObjectContainer);e.LoveAddAsk=t,__reflect(t.prototype,"game.LoveAddAsk")}(game||(game={}));var game;!function(e){var t=function(e){function t(t,i){var a=e.call(this)||this;return a.stageWidth=0,a.stageHeight=0,a.stageWidth=t,a.stageHeight=i,a.sprite=new egret.Sprite,a.sprite.width=t,a.sprite.height=i,a.addChild(a.sprite),a.tipText(),a}return __extends(t,e),t.prototype.tipText=function(){var e=new egret.TextField,t=new egret.TextField;e.text="Higher numbers indicate bigger tensions between your self-perception & the teams attribution of your position on the scale:",e.size=30,e.x=0,e.y=0,e.width=this.stageWidth,e.background=!0,e.backgroundColor=4951491,t.text="• White values: mark areas of authentic action.            • Values over 13: indicate your dissociative effect on the team‘s organizing dynamics.                  • Red values: mark your self- perception as being outside ZORA.                                                    • Yellow Values: mark your attributed position as being outside ZORA.",t.size=30,t.x=0,t.y=90,t.width=this.stageWidth,t.background=!0,t.backgroundColor=4951491,this.sprite.addChild(e),this.sprite.addChild(t)},t}(egret.DisplayObjectContainer);e.MajorTensionsTip=t,__reflect(t.prototype,"game.MajorTensionsTip")}(game||(game={}));var game;!function(e){var t=function(e){function t(t,i,a,r,n,s,o,h,c,l){return e.call(this)||this}return __extends(t,e),t}(egret.DisplayObjectContainer);e.MissionOneResult=t,__reflect(t.prototype,"game.MissionOneResult")}(game||(game={}));var game;!function(e){var t=function(t){function i(e,i,a,r,n,s,o,h,c,l,d){var g=t.call(this)||this;return g.stageWidth=0,g.stageHeight=0,g._width=600,g._x=20,g.character1="Carefulness",g.character2="Power",g.playerName="Joe",g.selfPerception=6,g.game_secret="",g.gameName="",g.inviter="",g.chooser="",g.scorecount=0,g.stageWidth=e,g.stageHeight=i,g.sprite=new egret.Sprite,g.addChild(g.sprite),g.game_secret=h,g.playerName=n,g.gameName=c,g.inviter=o,g.character1=a,g.character2=r,g.chooser=d,g.selfPerception=s,g.scorecount=l,g.processBar(),g.drawPotentialScale(),g}return __extends(i,t),i.prototype.processBar=function(){var t=new e.ProcessBar(this.stageWidth,this.stageHeight,50,"Mission 1 > Partial Insights");this.sprite.addChild(t)},i.prototype.drawPotentialScale=function(){var t=new e.ExpandedTensionScale(this.stageWidth,this.stageHeight,this.character1,this.character2,this.playerName,this.selfPerception,this.game_secret,this.inviter,this.gameName,this.chooser,this.scorecount);t.x=this._x+350,t.y=180,this.sprite.addChild(t)},i}(egret.DisplayObjectContainer);e.MissionPartialInsights=t,__reflect(t.prototype,"game.MissionPartialInsights")}(game||(game={}));var game;!function(e){var t=function(t){function i(i,a,r,n,s,o,h){var c=t.call(this)||this;c.game_secret="",c.gameName="",c.inviter="",c.player="",c.stageWidth=0,c.stageHeight=0,c.characterListParams=[],c.simulatedData=[],c.ttsms=[],c.stageWidth=i,c.stageHeight=a,c.player=s,c.gameName=o,c.game_secret=n,c.inviter=r,c.characterListParams=h,c.sprite=new egret.Sprite,c.addChild(c.sprite),c.drawTitle(),c.drawResult(),c._shape=new egret.Shape,c.sprite.addChild(c._shape),c._shape.alpha=.5;var l=new e.ProcessBar(i,a,100,"Mission 1 > ZORA Map");return c.sprite.addChild(l),c.rightIcon=new egret.Bitmap(RES.getRes("right_png")),c.rightIcon.width=100,c.rightIcon.height=100,c.rightIcon.anchorOffsetX=c.rightIcon.width/2,c.rightIcon.anchorOffsetY=c.rightIcon.height/2,c.rightIcon.x=i-50,c.rightIcon.y=a-100,c.rightIcon.touchEnabled=!0,c.rightIcon.addEventListener(egret.TouchEvent.TOUCH_TAP,c.rightNext,c),c.sprite.addChild(c.rightIcon),c}return __extends(i,t),i.prototype.rightNext=function(){base.API.call("save_players_process",{inviter_name:this.inviter,game_secret:this.game_secret,player:this.player,game_name:this.gameName,process:"3"}).then(function(e){}),this.sprite.visible=!1;var t=new e.SettingSail(this.stageWidth,this.stageHeight,0,this.simulatedData,this.player,this.inviter,this.game_secret,this.gameName);this.stage.addChild(t)},i.prototype.getTTSMS=function(){var e=this;base.API.Init("http://work.metatype.cn:8105/api/"),base.API.call("get_ttsm",{characterListParams:e.characterListParams,inviter:e.inviter,gameSecret:e.game_secret,player:e.player,gameName:e.gameName}).then(function(t){var i=t.result;e.ttsms=i})},i.prototype.initGraphics=function(){var e=this._shape;e.graphics.lineStyle(2,16448210),e.graphics.moveTo(this.stageWidth/2,this.stageHeight),e.graphics.lineTo(this.stageWidth/2,130);var t=this._shape;t.graphics.beginFill(16774799,.5),t.graphics.lineStyle(0),t.graphics.drawRect(this.stageWidth/2-Math.ceil(200/81*13),130,2*Math.ceil(200/81*13),this.stageHeight),t.graphics.endFill()},i.prototype.drawResult=function(){var e=this;base.API.Init("http://work.metatype.cn:8105/api/"),base.API.call("get_game_score",{characterListParams:e.characterListParams,inviter:e.inviter,gameSecret:e.game_secret,player:e.player,gameName:e.gameName}).then(function(t){var i=t.result;e.simulatedData=i;var a=e;base.API.call("get_ttsm",{characterListParams:a.characterListParams,inviter:a.inviter,gameSecret:a.game_secret,player:a.player,gameName:a.gameName}).then(function(t){var i=t.result;a.ttsms=i,e.drawTensionScale(a.ttsms)}),e.initGraphics()})},i.prototype.drawTensionScale=function(t){var i=this;this.ttsms=t,this.simulatedData.forEach(function(t,a,r){try{var n=i.ttsms[a],s=(t[2].toString(),new e.ZORAMap(t[0],t[1],i.player,t[3],t[2],i.stageWidth,i.stageHeight,n,i.simulatedData,i.inviter,i.game_secret,i.gameName));s.y=200+150*(a-1),i.sprite.addChild(s)}catch(o){}})},i.prototype.drawLine=function(){var e=new egret.Shape;e.graphics.lineStyle(Math.ceil(200/81*13),16711935),e.graphics.moveTo(this.stageWidth/2,this.stageHeight),e.graphics.lineTo(this.stageWidth/2,150),this.sprite.addChild(e)},i.prototype.drawTitle=function(){var e=new egret.Shape;e.graphics.beginFill(3514259,.5),e.graphics.drawRect(0,0,this.stageWidth,130),e.graphics.endFill(),this.sprite.addChild(e);var t=new egret.TextField;t.text="Mission 1 Complete: Here is an image of you in your Team‘s Zone of Responsible Action.",t.size=30,t.width=this.stageWidth,t.x=1,t.y=50,this.sprite.addChild(t)},i}(egret.DisplayObjectContainer);e.MissionResult=t,__reflect(t.prototype,"game.MissionResult")}(game||(game={}));var game;!function(e){var t=function(t){function i(e,i,a,r,n,s){var o=t.call(this)||this;o.playerList=[],o.game_secret="",o.player="",o.gameName="",o.inviter="",o.stageWidth=0,o.stageHeight=0,o._touchStatus=!1,o._distance=new egret.Point,o.characterList=[],o.characterTwo="Fully",o.characterOne="Insufficiently",o.player_score_list=[],o.player_list=[],o.playerscore=0,o.middle=0,o.game_secret=e,o.player=a,o.gameName=r,o.inviter=i,o.stageWidth=n,o.stageHeight=s,o.sprite=new egret.Sprite,o.sprite.width=n,o.sprite.height=s,o.sprite.x=0,o.sprite.y=0,o.addChild(o.sprite),o.sprite.addEventListener(egret.Event.ADDED_TO_STAGE,o.getPlayScoreList,o),o.rectShapeOne=new egret.Shape,o.rectShapeTwo=new egret.Shape,o.sprite.addChild(o.rectShapeOne),o.sprite.addChild(o.rectShapeTwo),o.drawRect();var h=new egret.TextField;return h.text=o.characterOne,h.textAlign=egret.HorizontalAlign.CENTER,h.size=40,h.border=!0,h.width=280,h.borderColor=3825613,h.x=n-390,h.y=200,o.sprite.addChild(h),o._shape=new egret.Shape,o.addChild(o._shape),o.initGraphics(),o.charater2=new egret.TextField,o.sprite.addChild(o.charater2),o.initCharacter(n-390,o.stageHeight-150),o.rightIcon=new egret.Bitmap(RES.getRes("right_png")),o.rightIcon.width=100,o.rightIcon.height=100,o.rightIcon.anchorOffsetX=o.rightIcon.width/2,o.rightIcon.anchorOffsetY=o.rightIcon.height/2,o.rightIcon.x=n-50,o.rightIcon.y=s/2,o.addChild(o.rightIcon),o.rightIcon.touchEnabled=!0,o.rightIcon.addEventListener(egret.TouchEvent.TOUCH_BEGIN,o.nextTouch,o),o.closeIcon=new egret.Bitmap(RES.getRes("close-circle_png")),o.closeIcon.width=40,o.closeIcon.height=40,o.closeIcon.anchorOffsetX=o.closeIcon.width/2,o.closeIcon.anchorOffsetY=o.closeIcon.height/2,o.closeIcon.x=n-30,o.closeIcon.y=150,o.closeIcon.touchEnabled=!0,o.closeIcon.addEventListener(egret.TouchEvent.TOUCH_BEGIN,o.closeTip,o),o.addChild(o.closeIcon),o.tiptext=new egret.TextField,o.timer=new egret.Timer(1e3,0),o.timer.addEventListener(egret.TimerEvent.TIMER,o.getPlayScoreList,o),o.timer.start(),o.middleScore=new egret.TextField,o.middleScore.textAlign=egret.HorizontalAlign.CENTER,o.middleScore.size=30,o.middleScore.lineSpacing=10,o.middleScore.border=!0,o.middleScore.background=!0,o.middleScore.backgroundColor=8009611,o.middleScore.borderColor=65280,o.middleScore.visible=!1,o.sprite.addChild(o.middleScore),o.middlePlayer=new egret.TextField,o.middlePlayer.textAlign=egret.HorizontalAlign.CENTER,o.middlePlayer.size=30,o.middlePlayer.lineSpacing=10,o.middlePlayer.border=!0,o.middlePlayer.background=!0,o.middlePlayer.borderColor=65280,o.middlePlayer.visible=!1,o.middlePlayer.backgroundColor=7120589,o.sprite.addChild(o.middlePlayer),o}return __extends(i,t),i.prototype.getPlayScoreList=function(){var e=this;base.API.Init("http://work.metatype.cn:8105/api/"),base.API.call("get_player_score",{inviter:this.inviter,gameName:this.gameName,gameSecret:this.game_secret,player:this.player,character_one:this.characterOne,character_two:this.characterTwo,chooser:this.inviter}).then(function(t){e.player_list.forEach(function(t,i,a){var r=new egret.TextField;r.text=t,r.textAlign=egret.HorizontalAlign.CENTER,r.size=30,r.lineSpacing=10,r.touchEnabled=!0,r.border=!0,r.background=!0,r.borderColor=65280,r.alpha=.5;
var n=new egret.TextField;n.size=30,n.border=!0,n.background=!0,n.borderColor=57123,n.textAlign=egret.HorizontalAlign.CENTER,n.alpha=.5,t==e.player&&i!=e.player_score_list.length?(e.playerscore=e.player_score_list[i],r.backgroundColor=7120589):r.backgroundColor=6513507,18*t.length<100?r.width=100:r.width=18*t.length;var s=100;r.width>100&&(s=r.width),i%2!=0?(r.x=e.stageWidth-250-s,n.x=r.x-50):(r.x=e.stageWidth-250,n.x=r.x+s);var o=e.player_score_list[i];r.y=o*((e.stageHeight-150-240)/81)+240,e.sprite.addChild(r),n.text=e.player_score_list[i],n.width=50,n.y=r.y,n.backgroundColor=16744228,e.sprite.addChild(n)})})},i.prototype.closeTip=function(){this.tiptext.parent&&this.removeChild(this.tiptext)},i.prototype.nextTouch=function(){if(this.stage){var t=this.game_secret,i=this.inviter,a=this.player,r=this.gameName,n=this.stageWidth,s=this.stageHeight,o=0,h=[];this.characterList=[["zjy","1","2"],[["Loyality","Joy"],["Power","Courage"],["Harmony","Disruption"]]];var c=new e.Character(t,i,a,r,n,s,o,this.characterList,h);this.stage.addChild(c),this.sprite.visible=!1,this.tiptext.text="",this.removeChild(this.rightIcon),this.removeChild(this.closeIcon)}},i.prototype.tip=function(e,t,i,a){var r=this.tiptext;r.x=e,r.y=t,r.text=i,r.size=a,r.width=this.stageWidth},i.prototype.drawRect=function(){var e=this.rectShapeOne;e.graphics.beginFill(16711680,.5),e.graphics.drawRect(0,0,this.stageWidth+60,180),e.graphics.endFill();var t=this.rectShapeTwo;t.graphics.beginFill(16711680,.5),t.graphics.drawRect(0,this.stageHeight-100,this.stageWidth+60,200),t.graphics.endFill()},i.prototype.initGraphics=function(){var e=this._shape;e.graphics.lineStyle(2,16711935),e.graphics.moveTo(this.stageWidth-250,this.stageHeight-150),e.graphics.lineTo(this.stageWidth-250,240)},i.prototype.initCharacter=function(e,t){var i=this.charater2;i.text=this.characterTwo,i.textAlign=egret.HorizontalAlign.CENTER,i.size=40,i.border=!0,i.width=280,i.borderColor=3825613,i.x=e,i.y=t},i.prototype.onTouchEnd=function(){egret.log("onTouchEnd")},i.prototype.onTouchMove=function(){egret.log("onTouchMove")},i.prototype.onTouchTap=function(){egret.log("onTouchTap")},i}(egret.DisplayObjectContainer);e.PageOneResult=t,__reflect(t.prototype,"game.PageOneResult")}(game||(game={}));var game;!function(e){var t=function(e){function t(t,i,a,r,n,s,o,h,c,l,d){var g=e.call(this)||this;return g.stageWidth=0,g.stageHeight=0,g._x=20,g._width=230,g.character1="",g.character2="",g.playerName="",g.selfPerception=0,g.othersSelfPerception=[],g.zoraMin=0,g.lowest=0,g.highest=0,g.count=0,g.median=0,g.stageWidth=t,g.stageHeight=i,g.character1=a,g.character2=r,g.playerName=n,g.selfPerception=s,g.game_secret=o,g.inviter=h,g.player=c,g.gameName=l,g.playerCount=d,g.sprite=new egret.Sprite,g.sprite.addEventListener(egret.Event.ADDED_TO_STAGE,g.potentialScale,g),g.addChild(g.sprite),g.character1Sprite=new egret.TextField,g.character2Sprite=new egret.TextField,g.sprite.addChild(g.character1Sprite),g.sprite.addChild(g.character2Sprite),g._shape=new egret.Shape,g.sprite.addChild(g._shape),g.zora=new egret.TextField,g.sprite.addChild(g.zora),g.zoraMedianLine=new egret.Shape,g.sprite.addChild(g.zoraMedianLine),g.tiptext=new egret.TextField,g.tip(),g.initSprite(),g.timer=new egret.Timer(10,0),g.timer.addEventListener(egret.TimerEvent.TIMER,g.getOthersSelfPerception,g),g.timer.start(),g}return __extends(t,e),t.prototype.initSprite=function(){var e=this.character1Sprite;e.text=this.character1,e.x=this._x,e.width=this._width,e.textAlign=egret.HorizontalAlign.CENTER,e.border=!0,e.borderColor=0,e.background=!0,e.backgroundColor=5480339;var t=this.character2Sprite;t.text=this.character2,t.x=this._x,t.y=840,t.width=this._width,t.textAlign=egret.HorizontalAlign.CENTER,t.border=!0,t.borderColor=0,t.background=!0,t.backgroundColor=5480339;var i=new egret.Shape;i.graphics.lineStyle(2,11149824),i.graphics.moveTo(this._x+e.width/2,e.height),i.graphics.lineTo(this._x+t.width/2,t.y),i.graphics.endFill(),this.sprite.addChild(i);var a=this.zora;a.x=this._x,a.width=230,a.border=!0,a.background=!0,a.backgroundColor=13356134;var r=this.zoraMedianLine;r.graphics.lineStyle(5,3355443),r.graphics.moveTo(this._x,0),r.graphics.lineTo(250,0),r.graphics.endFill()},t.prototype.tip=function(){var e=this.tiptext;e.text="",e.width=350,e.x=-350,e.y=80,e.background=!0,e.backgroundColor=3514259,this.sprite.addChild(e)},t.prototype.getOthersSelfPerception=function(){var e=this.othersSelfPerception.length+1;e==this.playerCount&&this.timer.stop();var t=this;base.API.Init("http://work.metatype.cn:8105/api/"),base.API.call("getOthersSelfPerception",{inviter_name:t.inviter,game_secret:t.game_secret,player:t.player,gameName:t.gameName}).then(function(e){t.othersSelfPerception=e.OthersSelfPerceptionList,t.potentialScale(),t.tiptext.text=Math.ceil((t.othersSelfPerception.length+1)/t.playerCount*100).toString()+"% of your Team ("+(t.othersSelfPerception.length+1).toString()+"out of "+t.playerCount.toString()+")) has so far voted the Potential Scale. Invite everyone to follow suit.Here are Early Insights:\n\n• "+t.lowest.toString()+" is the lowest and "+t.highest.toString()+"    the highest value on the Scale.\n• The teams preliminary median is "+t.median.toString()+".\n• The perception of "+t.count.toString()+" people varies remarkably from the team average."})},t.prototype.potentialScale=function(){var e=this,t=[],i=0;t.push(Number(this.selfPerception)),this.othersSelfPerception.forEach(function(i,a,r){t.push(e.othersSelfPerception[a])});var a=Math.round(t.reduce(function(e,t){return t+=e})/t.length),r=10*a-2.5,n=a-13;this.zoraMin=n;var s=a+13,o=10*n,h=10*s;this.othersSelfPerception.forEach(function(t,a,r){var o=new egret.TextField;o.text=e.othersSelfPerception[a].toString(),o.x=e._x+e.character1Sprite.width/2,o.y=e.othersSelfPerception[a]/81*810-o.height/2,o.width=70,o.textAlign=egret.HorizontalAlign.CENTER,o.textColor=0,o.border=!0,o.borderColor=0,o.background=!0,o.backgroundColor=16776908,a%2==0&&(o.x=e._x+e.character1Sprite.width/2-o.width),(n>e.othersSelfPerception[a]||e.othersSelfPerception[a]>s)&&(o.backgroundColor=16711475,i++),e.sprite.addChild(o)});var c=t.sort();this.lowest=c[0],this.highest=c.pop(),this.median=a,console.log(o),console.log(h);var l=this.zora;l.height=h-o,l.y=o,this.sprite.setChildIndex(l,0),this.zoraMedianLine.y=r;var d=new egret.TextField;d.text=this.selfPerception.toString(),d.textColor=0,d.x=this._x+this.character1Sprite.width/2,d.y=this.selfPerception/81*810-d.height/2,d.width=70,d.textAlign=egret.HorizontalAlign.CENTER,d.border=!0,d.borderColor=0,d.background=!0,d.backgroundColor=16777215,(n>this.selfPerception||this.selfPerception>s)&&(d.backgroundColor=13408562,i++),this.sprite.addChild(d),this.count=i;var g=new egret.TextField;g.text=this.playerName,g.textColor=0,g.x=d.x-g.width,g.y=this.selfPerception/81*810-g.height/2,g.width=100,g.textAlign=egret.HorizontalAlign.CENTER,g.border=!0,g.borderColor=0,18*this.playerName.length<100?(g.width=100,g.x=d.x-g.width):(g.width=18*this.playerName.length,g.x=d.x-g.width),this.sprite.addChild(g)},t}(egret.DisplayObjectContainer);e.PotentialScale=t,__reflect(t.prototype,"game.PotentialScale")}(game||(game={}));var game;!function(e){var t=function(t){function i(e,i,a,r,n,s,o,h,c,l,d){var g=t.call(this)||this;return g.stageWidth=0,g.stageHeight=0,g.game_secret="",g.gameName="",g.inviter="",g.player="",g._width=600,g._x=20,g._margin=20,g.loveFeedbackList=[],g.addFeedbackList=[],g.askFeedbackList=[],g.count=0,g.simulatedData=[],g.stageWidth=e,g.stageHeight=i,g.sprite=new egret.Sprite,g.player=a,g.inviter=r,g.game_secret=n,g.gameName=s,g.count=o,g.simulatedData=d,g.loveFeedbackList=h,g.addFeedbackList=c,g.askFeedbackList=l,g.addChild(g.sprite),g.processBar(),g.notice(),g.love(),g.add(),g.ask(),g.loveFeedback(),g.askFeedback(),g.addFeedback(),g.rightIcon(),g}return __extends(i,t),i.prototype.processBar=function(){var t=new e.ProcessBar(this.stageWidth,this.stageHeight,15,"Love, Add, Ask > PREVIEW");this.sprite.addChild(t)},i.prototype.notice=function(){this.noticeBox=new egret.TextField,this.noticeBox.text="You receive previews on your feedback in return for your efforts. The full list with all feedbacks will be your reward upon completion of Mission 2.",this.noticeBox.textColor=0,this.noticeBox.width=this._width,this.noticeBox.x=this._x,this.noticeBox.y=60,this.noticeBox.background=!0,this.noticeBox.backgroundColor=16763955,this.sprite.addChild(this.noticeBox)},i.prototype.love=function(){var e=new egret.TextField;e.text="LOVE",e.size=40,e.x=this._x,e.y=this.noticeBox.height+80,this.sprite.addChild(e)},i.prototype.loveFeedback=function(){var e=new eui.Group,t='\n                        <e:Skin xmlns:e="http://ns.egret.com/eui" states="up,down" height="50">\n                            <e:Label text="{data}" textColor.down="0xFFFFFF" textColor.up="0x666666" horizontalCenter="0" verticalCenter="0"/> \n                        </e:Skin>',i=new eui.List,a=this.loveFeedbackList;i.dataProvider=new eui.ArrayCollection(a),i.itemRendererSkinName=t,e.addChild(i);var r=new eui.Scroller;r.width=470,r.height=(this.stageHeight-120-2*this._margin)/3,r.x=130+this._margin,r.y=this.noticeBox.height+80,r.viewport=e,this.sprite.addChild(r)},i.prototype.add=function(){var e=new egret.TextField;e.text="ADD",e.size=40,e.x=this._x,e.y=this.noticeBox.height+80+(this.stageHeight-120-2*this._margin)/3+this._margin,this.sprite.addChild(e)},i.prototype.addFeedback=function(){var e=new eui.Group,t='\n                        <e:Skin xmlns:e="http://ns.egret.com/eui" states="up,down" height="50">\n                            <e:Label text="{data}" textColor.down="0xFFFFFF" textColor.up="0x666666" horizontalCenter="0" verticalCenter="0"/> \n                        </e:Skin>',i=new eui.List,a=this.addFeedbackList;i.dataProvider=new eui.ArrayCollection(a),i.itemRendererSkinName=t,e.addChild(i);var r=new eui.Scroller;r.width=470,r.height=(this.stageHeight-120-2*this._margin)/3,r.x=130+this._margin,r.y=this.noticeBox.height+80+2*(this.stageHeight-120-2*this._margin)/3+this._margin,r.viewport=e,this.sprite.addChild(r)},i.prototype.ask=function(){var e=new egret.TextField;e.text="ASK",e.size=40,e.x=this._x,e.y=this.noticeBox.height+80+2*(this.stageHeight-120-2*this._margin)/3+this._margin,this.sprite.addChild(e)},i.prototype.askFeedback=function(){var e=new eui.Group,t='\n                        <e:Skin xmlns:e="http://ns.egret.com/eui" states="up,down" height="50">\n                            <e:Label text="{data}" textColor.down="0xFFFFFF" textColor.up="0x666666" horizontalCenter="0" verticalCenter="0"/> \n                        </e:Skin>',i=new eui.List,a=this.askFeedbackList;i.dataProvider=new eui.ArrayCollection(a),i.itemRendererSkinName=t,e.addChild(i);var r=new eui.Scroller;r.width=470,r.height=(this.stageHeight-120-2*this._margin)/3,r.x=130+this._margin,r.y=this.noticeBox.height+80+(this.stageHeight-120-2*this._margin)/3+this._margin,r.viewport=e,this.sprite.addChild(r)},i.prototype.rightIcon=function(){var e=new egret.Bitmap(RES.getRes("right_png"));e.width=100,e.height=100,e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height/2,e.x=this.stageWidth-50,e.y=this.stageHeight/2,e.touchEnabled=!0,e.addEventListener(egret.TouchEvent.TOUCH_TAP,this.nextPage,this),this.sprite.addChild(e)},i.prototype.nextPage=function(){base.API.call("save_players_process",{inviter_name:this.inviter,game_secret:this.game_secret,player:this.player,game_name:this.gameName,process:"4."+this.count.toString()+".2"}).then(function(e){});var t=this;base.API.Init("http://work.metatype.cn:8105/api/"),base.API.call("get_players",{inviter:t.inviter,game_secret:t.game_secret,gameName:t.gameName,player:t.player}).then(function(i){var a=i.result,r=a,n=a.slice(0,t.count+1),s=a.slice(t.count+1),o=r.length,h=n.length,c=o-h;if(console.log(c),0==c)base.API.call("save_players_process",{inviter_name:t.inviter,game_secret:t.game_secret,player:t.player,game_name:t.gameName,process:"5"}).then(function(e){}),console.log(t.inviter),base.API.call("getOthersFeedback",{game_secret:t.game_secret,gameName:t.gameName,player:t.player,inviter:t.inviter}).then(function(i){var a=i.result;t.sprite.visible=!1;var r=new e.DigestLove(t.stageWidth,t.stageHeight,a,t.inviter,t.game_secret,t.gameName,t.player);t.stage.addChild(r)});else{t.sprite.visible=!1;var l=new e.KeepUpSupporting(t.stageWidth,t.stageHeight,t.player,t.inviter,t.game_secret,t.gameName,t.count,t.simulatedData,r,n,s);t.stage.addChild(l)}})},i}(egret.DisplayObjectContainer);e.Preview=t,__reflect(t.prototype,"game.Preview")}(game||(game={}));var game;!function(e){var t=function(t){function i(e,i){var a=t.call(this)||this;return a.stageWidth=0,a.stageHeight=0,a.game_secret="",a.gameName="",a.inviter="",a.player="",a._width=600,a._x=20,a._margin=20,a.stageWidth=e,a.stageHeight=i,a.sprite=new egret.Sprite,a.addChild(a.sprite),a.processBar(),a.notice(),a.love(),a.loveFeedback(),a.add(),a.ask(),a.askFeedback(),a.addFeedback(),a.rightIcon(),a}return __extends(i,t),i.prototype.processBar=function(){var t=new e.ProcessBar(this.stageWidth,this.stageHeight,15,"Love, Add, Ask > PREVIEW");this.sprite.addChild(t)},i.prototype.notice=function(){this.noticeBox=new egret.TextField,this.noticeBox.text="You receive previews on your feedback in return for your efforts. The full list with all feedbacks will be your reward upon completion of Mission 2.",this.noticeBox.textColor=0,this.noticeBox.width=this._width,this.noticeBox.x=this._x,this.noticeBox.y=60,this.noticeBox.background=!0,this.noticeBox.backgroundColor=16763955,this.sprite.addChild(this.noticeBox)},i.prototype.love=function(){var e=new egret.TextField;e.text="LOVE",e.size=40,e.x=this._x,e.y=this.noticeBox.height+80,this.sprite.addChild(e)},i.prototype.loveFeedback=function(){var e=new eui.Group,t='\n                        <e:Skin xmlns:e="http://ns.egret.com/eui" states="up,down" height="50">\n                            <e:Label text="{data}" textColor.down="0xFFFFFF" textColor.up="0x666666" horizontalCenter="0" verticalCenter="0"/> \n                        </e:Skin>',i=new eui.List,a=["Example text Example text text","doloru inctiae et, qui tem eos ","niminctur moluptu reius.Solum,","reiciis natureped molumet,cupta","mint. Eimil inctur, volo et ut",". Uciaecte cus se te nus ullace","atio. Uciaecte cus se volo te","doloru inctiae et, qui tem eos ","niminctur moluptu reius.Solum,","reiciis natureped molumet,cupta","mint. Eimil inctur, volo et ut",". Uciaecte cus se te nus ullace","atio. Uciaecte cus se volo te","doloru inctiae et, qui tem eos ","niminctur moluptu reius.Solum,","reiciis natureped molumet,cupta","mint. Eimil inctur, volo et ut",". Uciaecte cus se te nus ullace","atio. Uciaecte cus se volo te","doloru inctiae et, qui tem eos ","niminctur moluptu reius.Solum,","reiciis natureped molumet,cupta","mint. Eimil inctur, volo et ut",". Uciaecte cus se te nus ullace","atio. Uciaecte cus se volo te","doloru inctiae et, qui tem eos ","niminctur moluptu reius.Solum,","reiciis natureped molumet,cupta","mint. Eimil inctur, volo et ut",". Uciaecte cus se te nus ullace","atio. Uciaecte cus se volo te","doloru inctiae et, qui tem eos ","niminctur moluptu reius.Solum,","reiciis natureped molumet,cupta","mint. Eimil inctur, volo et ut",". Uciaecte cus se te nus ullace","atio. Uciaecte cus se volo te","doloru inctiae et, qui tem eos ","niminctur moluptu reius.Solum,","reiciis natureped molumet,cupta","mint. Eimil inctur, volo et ut",". Uciaecte cus se te nus ullace"];i.dataProvider=new eui.ArrayCollection(a),i.itemRendererSkinName=t,e.addChild(i);var r=new eui.Scroller;r.width=470,r.height=(this.stageHeight-120-2*this._margin)/3,r.x=130+this._margin,r.y=this.noticeBox.height+80,r.viewport=e,this.sprite.addChild(r)},i.prototype.add=function(){var e=new egret.TextField;e.text="ADD",e.size=40,e.x=this._x,e.y=this.noticeBox.height+80+(this.stageHeight-120-2*this._margin)/3+this._margin,this.sprite.addChild(e)},i.prototype.addFeedback=function(){var e=new eui.Group,t='\n                        <e:Skin xmlns:e="http://ns.egret.com/eui" states="up,down" height="50">\n                            <e:Label text="{data}" textColor.down="0xFFFFFF" textColor.up="0x666666" horizontalCenter="0" verticalCenter="0"/> \n                        </e:Skin>',i=new eui.List,a=["Example text Example text text","doloru inctiae et, qui tem eos ","niminctur moluptu reius.Solum,","reiciis natureped molumet,cupta","mint. Eimil inctur, volo et ut",". Uciaecte cus se te nus ullace","atio. Uciaecte cus se volo te","doloru inctiae et, qui tem eos ","niminctur moluptu reius.Solum,","reiciis natureped molumet,cupta","mint. Eimil inctur, volo et ut",". Uciaecte cus se te nus ullace","atio. Uciaecte cus se volo te","doloru inctiae et, qui tem eos ","niminctur moluptu reius.Solum,","reiciis natureped molumet,cupta","mint. Eimil inctur, volo et ut",". Uciaecte cus se te nus ullace","atio. Uciaecte cus se volo te","doloru inctiae et, qui tem eos ","niminctur moluptu reius.Solum,","reiciis natureped molumet,cupta","mint. Eimil inctur, volo et ut",". Uciaecte cus se te nus ullace","atio. Uciaecte cus se volo te","doloru inctiae et, qui tem eos ","niminctur moluptu reius.Solum,","reiciis natureped molumet,cupta","mint. Eimil inctur, volo et ut",". Uciaecte cus se te nus ullace","atio. Uciaecte cus se volo te","doloru inctiae et, qui tem eos ","niminctur moluptu reius.Solum,","reiciis natureped molumet,cupta","mint. Eimil inctur, volo et ut",". Uciaecte cus se te nus ullace","atio. Uciaecte cus se volo te","doloru inctiae et, qui tem eos ","niminctur moluptu reius.Solum,","reiciis natureped molumet,cupta","mint. Eimil inctur, volo et ut",". Uciaecte cus se te nus ullace"];i.dataProvider=new eui.ArrayCollection(a),i.itemRendererSkinName=t,e.addChild(i);var r=new eui.Scroller;r.width=470,r.height=(this.stageHeight-120-2*this._margin)/3,r.x=130+this._margin,r.y=this.noticeBox.height+80+2*(this.stageHeight-120-2*this._margin)/3+this._margin,r.viewport=e,this.sprite.addChild(r)},i.prototype.ask=function(){var e=new egret.TextField;e.text="ASK",e.size=40,e.x=this._x,e.y=this.noticeBox.height+80+2*(this.stageHeight-120-2*this._margin)/3+this._margin,this.sprite.addChild(e)},i.prototype.askFeedback=function(){var e=new eui.Group,t='\n                        <e:Skin xmlns:e="http://ns.egret.com/eui" states="up,down" height="50">\n                            <e:Label text="{data}" textColor.down="0xFFFFFF" textColor.up="0x666666" horizontalCenter="0" verticalCenter="0"/> \n                        </e:Skin>',i=new eui.List,a=["Example text Example text text","doloru inctiae et, qui tem eos ","niminctur moluptu reius.Solum,","reiciis natureped molumet,cupta","mint. Eimil inctur, volo et ut",". Uciaecte cus se te nus ullace","atio. Uciaecte cus se volo te","doloru inctiae et, qui tem eos ","niminctur moluptu reius.Solum,","reiciis natureped molumet,cupta","mint. Eimil inctur, volo et ut",". Uciaecte cus se te nus ullace","atio. Uciaecte cus se volo te","doloru inctiae et, qui tem eos ","niminctur moluptu reius.Solum,","reiciis natureped molumet,cupta","mint. Eimil inctur, volo et ut",". Uciaecte cus se te nus ullace","atio. Uciaecte cus se volo te","doloru inctiae et, qui tem eos ","niminctur moluptu reius.Solum,","reiciis natureped molumet,cupta","mint. Eimil inctur, volo et ut",". Uciaecte cus se te nus ullace","atio. Uciaecte cus se volo te","doloru inctiae et, qui tem eos ","niminctur moluptu reius.Solum,","reiciis natureped molumet,cupta","mint. Eimil inctur, volo et ut",". Uciaecte cus se te nus ullace","atio. Uciaecte cus se volo te","doloru inctiae et, qui tem eos ","niminctur moluptu reius.Solum,","reiciis natureped molumet,cupta","mint. Eimil inctur, volo et ut",". Uciaecte cus se te nus ullace","atio. Uciaecte cus se volo te","doloru inctiae et, qui tem eos ","niminctur moluptu reius.Solum,","reiciis natureped molumet,cupta","mint. Eimil inctur, volo et ut",". Uciaecte cus se te nus ullace"];i.dataProvider=new eui.ArrayCollection(a),i.itemRendererSkinName=t,e.addChild(i);var r=new eui.Scroller;r.width=470,r.height=(this.stageHeight-120-2*this._margin)/3,r.x=130+this._margin,r.y=this.noticeBox.height+80+(this.stageHeight-120-2*this._margin)/3+this._margin,r.viewport=e,this.sprite.addChild(r)},i.prototype.rightIcon=function(){var e=new egret.Bitmap(RES.getRes("right_png"));e.width=100,e.height=100,e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height/2,e.x=this.stageWidth-50,e.y=this.stageHeight/2,e.touchEnabled=!0,e.addEventListener(egret.TouchEvent.TOUCH_TAP,this.rightIcon,this),this.sprite.addChild(e)},i}(egret.DisplayObjectContainer);e.Preview2=t,__reflect(t.prototype,"game.Preview2")}(game||(game={}));var game;!function(e){var t=function(e){function t(t,i,a,r){var n=e.call(this)||this;return n.stageWidth=0,n.stageHeight=0,n.processX=20,n.process=100,n.missionName="",n.stageWidth=t,n.stageHeight=i,n.sprite=new egret.Sprite,n.process=a,n.missionName=r,n.addChild(n.sprite),n.processBar(),n}return __extends(t,e),t.prototype.processBar=function(){var e=new egret.Shape,t=new egret.Shape,i=new egret.TextField,a=new egret.TextField;e.graphics.beginFill(5357252),e.graphics.drawRect(0,0,this.stageWidth,50),e.graphics.endFill(),t.graphics.beginFill(3617171),t.graphics.drawRect(this.processX,10,2*this.process,30),t.graphics.endFill(),i.text=this.process.toString()+"%",i.size=20,i.x=this.processX+2*this.process+15,i.y=15,i.textColor=16777215,this.process>50&&(i.x=(this.processX+2*this.process)/2-15*(this.process/100)),a.text=this.missionName,a.textAlign=egret.VerticalAlign.MIDDLE,a.size=27,a.x=250,a.y=5,a.textColor=16777215,this.sprite.addChild(e),this.sprite.addChild(t),this.sprite.addChild(i),this.sprite.addChild(a)},t}(egret.DisplayObjectContainer);e.ProcessBar=t,__reflect(t.prototype,"game.ProcessBar")}(game||(game={}));var game;!function(e){var t=function(t){function i(e,i,a,r,n,s,o,h){var c=t.call(this)||this;return c.stageWidth=0,c.stageHeight=0,c.game_secret="",c.gameName="",c.inviter="",c.player="",c._width=600,c._x=20,c._margin=20,c.stageWidth=e,c.stageHeight=i,c.sprite=new egret.Sprite,c.addChild(c.sprite),c.simulatedData=r,c.player=n,c.inviter=s,c.game_secret=o,c.gameName=h,c.processBar(),c.intro(),c.rightIcon(),c}return __extends(i,t),i.prototype.processBar=function(){var t=new e.ProcessBar(this.stageWidth,this.stageHeight,5,"Mission 2 > Setting Sail");this.sprite.addChild(t)},i.prototype.intro=function(){var e=new egret.TextField;e.text="To progress in containing your team‘s tensions set sail to:\n\n• Learn about your teams major tensions\n• Give 1 on 1 Feedback to help safeguarding your Zone of Responsible Action (ZORA)\nLearn what others LOVE about you, what they think you should ADD & what they always wanted to ASK you.",e.width=this._width,e.x=this._x,e.y=100,this.sprite.addChild(e);var t=new egret.Bitmap(RES.getRes("bg_jpg"));t.width=this._width,t.height=550,t.x=this._x,t.y=e.y+e.height+this._margin,this.sprite.addChild(t);var i=new egret.TextField;i.text="The treasure at the end of Mission TWO? Embrace your teammates anonymous Feedback for a better deployment of the team‘s potentialities.",i.width=this._width,i.x=this._x,i.y=t.y+t.height+this._margin,this.sprite.addChild(i)},i.prototype.rightIcon=function(){var e=new egret.Bitmap(RES.getRes("right_png"));e.width=100,e.height=100,e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height/2,e.x=this.stageWidth-50,e.y=this.stageHeight/2,e.touchEnabled=!0,e.addEventListener(egret.TouchEvent.TOUCH_TAP,this.nextPage,this),this.sprite.addChild(e)},i.prototype.nextPage=function(){base.API.call("save_players_process",{inviter_name:this.inviter,game_secret:this.game_secret,player:this.player,game_name:this.gameName,process:"4.0.0"}).then(function(e){});var t=0;this.sprite.visible=!1;var i=new e.LoveAddAsk(this.stageWidth,this.stageHeight,t,this.simulatedData,this.player,this.inviter,this.game_secret,this.gameName);this.stage.addChild(i)},i}(egret.DisplayObjectContainer);e.SettingSail=t,__reflect(t.prototype,"game.SettingSail")}(game||(game={}));var game;!function(e){var t=function(t){function i(e,i,a,r){var n=t.call(this)||this;return n.stageWidth=0,n.stageHeight=0,n.game_secret="",n.gameName="",n.inviter="",n.player="",n._width=600,n.noticeHeight=80,n._x=20,n._margin=20,n.simulatedData=[["Family","Narcissism",20,40,[14,7,20,15,11,25,7,12,31,16,14,20,14]],["Sensuality","Fighting",10,24,[4,7,2,5,6,5,7,4,31,16,14,20,14]],["Loyality","Joy",30,19,[14,7,2,5,11,5,7,12,22,16,4,2,14]],["Harmony","Disruption",4,15,[14,7,2,5,11,5,7,5,1,6,14,20,14]],["Carefulness","Power",12,11,[14,7,2,5,1,5,7,2,1,6,4,20,14]]],n.absoluteValueOfDeviationList=[14,7,2,5,11,5,7,12,31,16,14,20,14],n.stageWidth=e,n.stageHeight=i,n.sprite=new egret.Sprite,n.addChild(n.sprite),n.processBar(),n.notice(),n.background(),n.rightIcon(),n}return __extends(i,t),i.prototype.processBar=function(){var t=new e.ProcessBar(this.stageWidth,this.stageHeight,60,"Mission 2 > Team Tensions");this.sprite.addChild(t)},i.prototype.notice=function(){this.noticeBox=new egret.TextField,this.noticeBox.text="Identify the major integrative values and sources of tension within your team.",this.noticeBox.textColor=0,this.noticeBox.width=this._width,this.noticeBox.height=this.noticeHeight,this.noticeBox.x=this._x,this.noticeBox.y=60,this.noticeBox.background=!0,this.noticeBox.backgroundColor=16763955,this.sprite.addChild(this.noticeBox)},i.prototype.background=function(){var e=new egret.Shape;e.x=this._x/2,e.y=this.noticeBox.height,e.graphics.beginFill(13421772,1),e.graphics.drawRect(e.x,e.y,200,this.stageHeight),e.graphics.endFill(),this.sprite.addChild(e)},i.prototype.rightIcon=function(){var e=new egret.Bitmap(RES.getRes("right_png"));e.width=100,e.height=100,e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height/2,e.x=this.stageWidth-50,e.y=this.stageHeight/2,e.touchEnabled=!0,this.sprite.addChild(e)},i}(egret.DisplayObjectContainer);e.TeamTensions=t,__reflect(t.prototype,"game.TeamTensions")}(game||(game={}));var game;!function(e){var t=function(e){function t(t,i,a,r,n,s,o){var h=e.call(this)||this;return h.stageWidth=0,h.stageHeight=0,h.select_list=[],h.selfPerception=1,h.individualTensionScaleMedian=60,h.absoluteValueOfDeviation=0,h.teamTensionScaleMedian=30,h.ZORAMin=0,h.ZORAMax=0,h.select_list=a,h.selfPerception=n,h.teamTensionScaleMedian=s,h.absoluteValueOfDeviation=r,h.ZORAMin=h.teamTensionScaleMedian-13,h.ZORAMax=h.teamTensionScaleMedian+13,h.individualTensionScaleMedian=o,h.stageWidth=t,h.stageHeight=i,h.sprite=new egret.Sprite,h.addChild(h.sprite),h.sprite.touchEnabled=!0,h.drawCharacter(),h.drawScore(),h}return __extends(t,e),t.prototype.drawCharacter=function(){var e=(255+167772.15*Math.floor(100*Math.random()),new egret.Shape);e.graphics.beginFill(7434694),e.graphics.drawRect(0,0,180,60),e.graphics.endFill(),this.sprite.addChild(e);var t=new egret.Shape;t.graphics.beginFill(7434694),t.graphics.drawRect(0,80,180,60),t.graphics.endFill(),this.sprite.addChild(t);var i=new egret.TextField;i.textAlign=egret.HorizontalAlign.CENTER,i.x=e.x,i.y=10,i.text=this.select_list[0],this.sprite.addChild(i);var a=new egret.TextField;a.textAlign=egret.HorizontalAlign.CENTER,a.x=t.x,a.y=90,a.text=this.select_list[1],this.sprite.addChild(a)},t.prototype.drawScore=function(){var e=new egret.Shape,t=new egret.Shape,i=new egret.Shape,a=new egret.TextField;e.graphics.beginFill(12665667),e.graphics.lineStyle(2,16777215),e.graphics.drawCircle(90,70,30),e.graphics.endFill(),t.graphics.beginFill(13224552),t.graphics.lineStyle(2,16777215),t.graphics.drawCircle(90,70,30),t.graphics.endFill(),i.graphics.beginFill(16513522),i.graphics.lineStyle(2,16777215),i.graphics.drawCircle(90,70,30),i.graphics.endFill(),this.ZORAMin>this.selfPerception||this.selfPerception>this.ZORAMax?(this.sprite.addChild(e),(this.ZORAMin>this.individualTensionScaleMedian||this.individualTensionScaleMedian>this.ZORAMax)&&(t.graphics.beginFill(12665667),t.graphics.lineStyle(0,16777215),t.graphics.drawCircle(90,70,20),t.graphics.endFill(),this.sprite.addChild(t))):this.ZORAMin<=this.selfPerception&&this.selfPerception<=this.ZORAMax&&(this.ZORAMin<=this.individualTensionScaleMedian&&this.individualTensionScaleMedian<=this.ZORAMax?this.sprite.addChild(i):(this.ZORAMin>this.individualTensionScaleMedian||this.individualTensionScaleMedian>this.ZORAMax)&&this.sprite.addChild(t)),a.text=this.absoluteValueOfDeviation.toString(),a.size=20,a.textColor=0,a.x=80,a.y=60,this.sprite.addChild(a),0==this.individualTensionScaleMedian&&this.sprite.removeChild(a)},t}(egret.DisplayObjectContainer);e.TeamTensionScale=t,__reflect(t.prototype,"game.TeamTensionScale")}(game||(game={}));var game;!function(e){var t=function(e){function t(t,i,a,r,n,s,o){var h=e.call(this)||this;return h.stageWidth=0,h.stageHeight=0,h.select_list=[],h.selfPerciption=1,h.individualTensionScaleMedian=60,h.absoluteValueOfDeviation=0,h.teamTensionScaleMedian=30,h.ZORAMin=0,h.ZORAMax=0,h.select_list=a,h.selfPerciption=n,h.teamTensionScaleMedian=s,h.absoluteValueOfDeviation=r,h.ZORAMin=h.teamTensionScaleMedian-13,h.ZORAMax=h.teamTensionScaleMedian+13,h.individualTensionScaleMedian=o,h.stageWidth=t,h.stageHeight=i,h.sprite=new egret.Sprite,h.addChild(h.sprite),h.sprite.touchEnabled=!0,h.drawCharacter(),h.drawScore(),h}return __extends(t,e),t.prototype.drawCharacter=function(){var e=(255+167772.15*Math.floor(100*Math.random()),new egret.Shape),t=new egret.Shape;e.graphics.beginFill(7434694),e.graphics.drawRect(0,0,180,60),e.graphics.endFill();var i=new egret.TextField;i.x=e.x,i.y=10,i.text=this.select_list[0],t.graphics.beginFill(7434694),t.graphics.drawRect(0,80,180,60),t.graphics.endFill();var a=new egret.TextField;a.x=t.x,a.y=90,a.text=this.select_list[1],this.sprite.addChild(e),this.sprite.addChild(t),this.sprite.addChild(i),this.sprite.addChild(a)},t.prototype.drawScore=function(){var e=new egret.Shape,t=new egret.Shape,i=new egret.Shape,a=new egret.TextField;e.graphics.beginFill(12665667),e.graphics.lineStyle(2,16777215),e.graphics.drawCircle(90,70,30),e.graphics.endFill(),t.graphics.beginFill(13224552),t.graphics.lineStyle(2,16777215),t.graphics.drawCircle(90,70,30),t.graphics.endFill(),i.graphics.beginFill(16513522),i.graphics.lineStyle(2,16777215),i.graphics.drawCircle(90,70,30),i.graphics.endFill(),this.ZORAMin>this.selfPerciption||this.selfPerciption>this.ZORAMax?(this.sprite.addChild(e),(this.ZORAMin>this.individualTensionScaleMedian||this.individualTensionScaleMedian>this.ZORAMax)&&(t.graphics.beginFill(12665667),t.graphics.lineStyle(0,16777215),t.graphics.drawCircle(90,70,20),t.graphics.endFill(),this.sprite.addChild(t))):this.ZORAMin<=this.selfPerciption&&this.selfPerciption<=this.ZORAMax&&(this.ZORAMin<=this.individualTensionScaleMedian&&this.individualTensionScaleMedian<=this.ZORAMax?this.sprite.addChild(i):(this.ZORAMin>this.individualTensionScaleMedian||this.individualTensionScaleMedian>this.ZORAMax)&&this.sprite.addChild(t)),a.text=this.absoluteValueOfDeviation.toString(),a.size=20,a.textColor=0,a.x=80,a.y=60,this.sprite.addChild(a),0==this.individualTensionScaleMedian&&this.sprite.removeChild(a)},t}(egret.DisplayObjectContainer);e.TensionScale=t,__reflect(t.prototype,"game.TensionScale")}(game||(game={}));var game;!function(e){var t=function(t){function i(i,a,r,n,s,o,h,c){var l=t.call(this)||this;l.unselectedCharacterList=[],l.selectedChaeacterList=[],l.game_secret="",l.player="",l.gameName="",l.inviter="",l.characterListParams=[],l.stageWidth=0,l.stageHeight=0,l.playerCount=0,l.simulatedData=[],l._touchStatus=!1,l.ttsms=[],l.game_secret=n,l.player=s,l.gameName=o,l.inviter=r,l.characterListParams=h,l.playerCount=c,console.log(h),l.stageWidth=i,l.stageHeight=a,l.sprite=new egret.Sprite,l.addChild(l.sprite),l.sprite.touchEnabled=!0,l.drawTensionScale(),l.drawTitle(),l.timer=new egret.Timer(1e3,0),l.timer.addEventListener(egret.TimerEvent.TIMER,l.getGameResult,l),l.timer.start(),l.rightIcon=new egret.Bitmap(RES.getRes("right_png")),l.rightIcon.width=100,l.rightIcon.height=100,l.rightIcon.anchorOffsetX=l.rightIcon.width/2,l.rightIcon.anchorOffsetY=l.rightIcon.height/2,l.rightIcon.x=i-50,l.rightIcon.y=a-100,l.rightIcon.touchEnabled=!0,l.rightIcon.addEventListener(egret.TouchEvent.TOUCH_TAP,l.rightNext,l);
var d=new e.ProcessBar(i,a,90,"Mission 1 > Major Tensions");l.sprite.addChild(d);var g=new e.MajorTensionsTip(i,a);return g.y=a-300,g.x=3,g.width=i-3,l.sprite.addChild(g),l}return __extends(i,t),i.prototype.getGameResult=function(){var e=this;base.API.Init("http://work.metatype.cn:8105/api/"),base.API.call("get_game_score",{characterListParams:e.characterListParams,inviter:e.inviter,gameSecret:e.game_secret,player:e.player,gameName:e.gameName}).then(function(t){var i=t.result;e.ttsms=t.ttsms,e.simulatedData=i,e.drawTensionScale()})},i.prototype.drawTitle=function(){var e=new egret.Shape;e.graphics.beginFill(3514259,.5),e.graphics.drawRect(0,0,this.stageWidth,130),e.graphics.endFill(),this.sprite.addChild(e);var t=new egret.TextField;t.text="Identify the major sources of tension with you teammates",t.size=30,t.width=this.stageWidth,t.x=1,t.y=50,this.sprite.addChild(t)},i.prototype.drawTensionScale=function(){var t=this;this.simulatedData.forEach(function(i,a,r){try{var n=Number(i[3].toString()),s=Number(i[2].toString()),o=(i[0],i[2],Math.abs(n-s)),h=s,c=new e.TensionScale(100,60,[i[0],i[1]],o,n,Number(t.ttsms[a]),h);a%2==1?(c.x=150,c.y=150+100*(a-1)):a%2==0&&(c.x=350,c.y=150+100*a),t.sprite.addChild(c)}catch(l){}}),this.simulatedData&&this.playerCount==this.simulatedData.length&&(this.sprite.addChild(this.rightIcon),this.timer.stop())},i.prototype.rightNext=function(){var t=!0;if(this.simulatedData.forEach(function(e,i,a){e.length<4&&(alert("Please wait for everyone to finish scoring."),t=!1)}),1==t){var i=this;if(base.API.call("save_players_process",{inviter_name:i.inviter,game_secret:i.game_secret,player:i.player,game_name:i.gameName,process:"2.1"}).then(function(e){}),i.stage){i.sprite.visible=!1;var a=new e.MissionResult(i.stageWidth,i.stageHeight,i.inviter,i.game_secret,i.player,i.gameName,i.characterListParams);i.stage.addChild(a)}}},i.prototype.getRandomScore=function(e,t){var i=t-e,a=Math.random();return e+Math.round(a*i)},i.prototype.onTouchEnd=function(){egret.log("onTouchEnd")},i.prototype.onTouchMove=function(){egret.log("onTouchMove")},i.prototype.onTouchTap=function(){egret.log("onTouchTap")},i}(egret.DisplayObjectContainer);e.TensionScaleResult=t,__reflect(t.prototype,"game.TensionScaleResult")}(game||(game={}));var game;!function(e){var t=function(e){function t(t,i,a,r,n,s,o,h,c,l,d,g){var p=e.call(this)||this;return p.playerList=[],p.game_secret="",p.player="",p.gameName="",p.inviter="",p.stageWidth=0,p.stageHeight=0,p.characterTwo="Fully",p.characterOne="Insufficiently",p._touchStatus=!1,p._distance=new egret.Point,p.playerScore="",p.tensionMedian="",p.player_name="",p.median=0,p.characterList=[],p.map={},p.ttsm=0,p.selfPerciption=1,p.individualTensionScaleMedian=60,p.absoluteValueOfDeviation=0,p.teamTensionScaleMedian=30,p.ZORAMin=0,p.ZORAMax=0,p.stageWidth=s,p.stageHeight=o,p.ttsm=Number(h),p.inviter=l,p.player=a,p.game_secret=d,p.gameName=g,p.playerScore=r,p.tensionMedian=n,p.characterTwo=i,p.characterOne=t,p.player_name=a,p.simulatedData=c,p.median=Math.abs(Number(r)-Number(n)),p.absoluteValueOfDeviation=p.median,p.selfPerciption=Number(p.playerScore),p.individualTensionScaleMedian=Number(p.tensionMedian),p.teamTensionScaleMedian=p.ttsm,p.ZORAMin=p.teamTensionScaleMedian-13,p.ZORAMax=p.teamTensionScaleMedian+13,p.sprite=new egret.Sprite,p.sprite.width=s,p.sprite.height=o,p.sprite.x=0,p.sprite.y=0,p.addChild(p.sprite),p._shape=new egret.Shape,p.sprite.addChild(p._shape),p.drawVoteArea(),p}return __extends(t,e),t.prototype.drawVoteArea=function(){var e=new egret.TextField,t=new egret.TextField,i=this._shape,a=new egret.TextField,r=new egret.TextField,n=Math.ceil((Number(this.playerScore)-this.ttsm)*(200/81)+this.stageWidth/2),s=new egret.TextField,o=new egret.TextField,h=Math.ceil((Number(this.tensionMedian)-this.ttsm)*(200/81)+this.stageWidth/2);e.text=this.characterOne,e.textAlign=egret.HorizontalAlign.CENTER,e.size=30,e.border=!0,e.width=60,e.height=120,e.borderColor=3825613,e.background=!0,e.backgroundColor=16513522,e.textColor=0,e.x=Math.ceil(this.stageWidth/2-(200/81*this.ttsm+60)),e.y=150,t.text=this.characterTwo,t.textAlign=egret.HorizontalAlign.CENTER,t.size=30,t.border=!0,t.width=60,t.height=120,t.borderColor=3825613,t.x=this.stageWidth/2+Math.ceil(200/81*(81-this.ttsm)+60),t.y=150,t.background=!0,t.backgroundColor=16513522,t.textColor=0,i.graphics.lineStyle(2,14492194),i.graphics.moveTo(e.x+60,210),i.graphics.lineTo(t.x,210),a.text=this.player_name,a.textAlign=egret.HorizontalAlign.CENTER,a.size=20,a.border=!0,a.width=50,a.height=20,a.anchorOffsetX=a.width/2,a.anchorOffsetY=a.height/2,a.borderColor=0,a.x=n,a.y=260,a.rotation=270,a.textColor=0,r.text=this.playerScore,r.textAlign=egret.HorizontalAlign.CENTER,r.size=20,r.border=!0,r.width=50,r.height=20,r.borderColor=0,r.x=n,r.y=210,r.rotation=270,r.textColor=0,r.anchorOffsetX=r.width/2,r.anchorOffsetY=r.height/2,s.text=this.tensionMedian+"/"+this.median,s.textAlign=egret.HorizontalAlign.CENTER,s.size=20,s.border=!0,s.width=60,s.height=20,s.borderColor=0,s.x=h,s.y=210,s.rotation=270,s.textColor=0,s.anchorOffsetX=s.width/2,s.anchorOffsetY=s.height/2,o.text=this.player_name,o.textAlign=egret.HorizontalAlign.CENTER,o.size=20,o.border=!0,o.width=60,o.height=20,o.borderColor=0,o.x=h,o.y=270,o.rotation=270,o.textColor=0,o.anchorOffsetX=o.width/2,o.anchorOffsetY=o.height/2,this.ZORAMin>this.selfPerciption||this.selfPerciption>this.ZORAMax?(r.background=!0,r.backgroundColor=12665667,this.ZORAMin>this.individualTensionScaleMedian||this.individualTensionScaleMedian>this.ZORAMax?(s.background=!0,s.backgroundColor=13224552):(s.background=!0,s.backgroundColor=16513522),e.backgroundColor=6184542,t.backgroundColor=6184542):this.ZORAMin<=this.selfPerciption&&this.selfPerciption<=this.ZORAMax&&(r.background=!0,r.backgroundColor=16513522,this.ZORAMin<=this.individualTensionScaleMedian&&this.individualTensionScaleMedian<=this.ZORAMax?(r.background=!0,r.backgroundColor=16513522,s.background=!0,s.backgroundColor=16513522):(this.ZORAMin>this.individualTensionScaleMedian||this.individualTensionScaleMedian>this.ZORAMax)&&(s.background=!0,s.backgroundColor=13224552,e.backgroundColor=6184542,t.backgroundColor=6184542)),this.sprite.addChild(e),this.sprite.addChild(t),this.sprite.addChild(i),this.sprite.addChild(a),this.sprite.addChild(r),this.sprite.addChild(s),this.sprite.addChild(o)},t}(egret.DisplayObjectContainer);e.ZORAMap=t,__reflect(t.prototype,"game.ZORAMap")}(game||(game={}));