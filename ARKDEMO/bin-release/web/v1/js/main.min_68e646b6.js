var __reflect=this&&this.__reflect||function(e,t,i){e.__class__=t,i?i.push(t):i=[t],e.__types__=e.__types__?i.concat(e.__types__):i},__extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);i.prototype=t.prototype,e.prototype=new i},__awaiter=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))(function(n,a){function o(e){try{h(r.next(e))}catch(t){a(t)}}function s(e){try{h(r["throw"](e))}catch(t){a(t)}}function h(e){e.done?n(e.value):new i(function(t){t(e.value)}).then(o,s)}h((r=r.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){function i(e){return function(t){return r([e,t])}}function r(i){if(n)throw new TypeError("Generator is already executing.");for(;h;)try{if(n=1,a&&(o=a[2&i[0]?"return":i[0]?"throw":"next"])&&!(o=o.call(a,i[1])).done)return o;switch(a=0,o&&(i=[0,o.value]),i[0]){case 0:case 1:o=i;break;case 4:return h.label++,{value:i[1],done:!1};case 5:h.label++,a=i[1],i=[0];continue;case 7:i=h.ops.pop(),h.trys.pop();continue;default:if(o=h.trys,!(o=o.length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){h=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){h.label=i[1];break}if(6===i[0]&&h.label<o[1]){h.label=o[1],o=i;break}if(o&&h.label<o[2]){h.label=o[2],h.ops.push(i);break}o[2]&&h.ops.pop(),h.trys.pop();continue}i=t.call(e,h)}catch(r){i=[6,r],a=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var n,a,o,s,h={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},game;!function(e){var t=function(t){function i(e,i){var r=t.call(this)||this;r.count=0,r.playerList=[],r.sprite=new egret.Sprite,r.sprite.width=e,r.sprite.height=i,r.addChild(r.sprite);var n=new egret.Shape;n.graphics.beginFill(16774638),n.graphics.drawRect(0,0,300,50),n.graphics.endFill(),n.x=r.sprite.width/2+60,n.y=r.sprite.height/3,n.anchorOffsetX=n.width/2,n.anchorOffsetY=n.height/2,r.sprite.addChild(n),r.txInput=new egret.TextField,r.txInput.type=egret.TextFieldType.INPUT,r.txInput.inputType=egret.TextFieldInputType.TEXT,r.txInput.width=290,r.txInput.height=50,r.txInput.x=r.sprite.width/2+60,r.txInput.y=r.sprite.height/3,r.txInput.anchorOffsetX=r.txInput.width/2,r.txInput.anchorOffsetY=r.txInput.height/2,r.txInput.textColor=855309,r.txInput.size=40;var a=new egret.TextField;a.text="game id:",a.x=r.sprite.width/2-280,a.y=r.sprite.height/3-18,a.size=30,r.sprite.addChild(a),r.sprite.addChild(r.txInput);var o=new egret.Shape;o.graphics.beginFill(16774638),o.graphics.drawRect(0,0,300,50),o.graphics.endFill(),o.x=r.sprite.width/2+60,o.y=r.sprite.height/3-80,o.anchorOffsetX=o.width/2,o.anchorOffsetY=o.height/2,r.sprite.addChild(o);var s=new egret.Shape;s.graphics.beginFill(16774638),s.graphics.drawRect(0,0,300,50),s.graphics.endFill(),s.x=r.sprite.width/2+60,s.y=r.sprite.height/3-160,s.anchorOffsetX=o.width/2,s.anchorOffsetY=o.height/2,r.sprite.addChild(s),r.txInput2=new egret.TextField,r.txInput2.type=egret.TextFieldType.INPUT,r.txInput2.inputType=egret.TextFieldInputType.TEXT,r.txInput2.width=290,r.txInput2.height=50,r.txInput2.x=r.sprite.width/2+60,r.txInput2.y=r.sprite.height/3-75,r.txInput2.anchorOffsetX=r.txInput2.width/2,r.txInput2.anchorOffsetY=r.txInput2.height/2,r.txInput2.textColor=855309,r.txInput2.size=40;var h=new egret.TextField;h.text="game name:",h.x=r.sprite.width/2-280,h.y=r.sprite.height/3-90,h.size=30,r.sprite.addChild(h),r.sprite.addChild(r.txInput2),r.txInput3=new egret.TextField,r.txInput3.type=egret.TextFieldType.INPUT,r.txInput3.inputType=egret.TextFieldInputType.TEXT,r.txInput3.width=290,r.txInput3.height=50,r.txInput3.x=r.sprite.width/2+60,r.txInput3.y=r.sprite.height/3-150,r.txInput3.anchorOffsetX=r.txInput3.width/2,r.txInput3.anchorOffsetY=r.txInput3.height/2,r.txInput3.textColor=855309,r.txInput3.size=40;var c=new egret.TextField;c.text="your name:",c.x=r.sprite.width/2-280,c.y=r.sprite.height/3-170,c.size=30,r.sprite.addChild(c),r.sprite.addChild(r.txInput3);var l=new egret.Shape;l.graphics.beginFill(52224),l.graphics.drawRect(0,0,200,50),l.graphics.endFill(),l.x=r.sprite.width/2,l.y=r.sprite.height/2,l.anchorOffsetX=l.width/2,l.anchorOffsetY=l.height/2,l.touchEnabled=!0,l.addEventListener(egret.TouchEvent.TOUCH_BEGIN,r.onTouchBegin,r),r.sprite.addChild(l);var g=new egret.TextField;return g.text="create",g.anchorOffsetX=g.width/2,g.anchorOffsetY=g.height/2,g.x=r.sprite.width/2,g.y=r.sprite.height/2,r.sprite.addChild(g),r.text2=new egret.TextField,r.text2.width=e,r.sprite.addChild(r.text2),r}return __extends(i,t),i.prototype.onTouchBegin=function(){var t=this.txInput3.text,i=this.txInput2.text,r=this.txInput.text;if(t&&i&&r){if(base.API.Init("http://39.104.85.167:8105/api/"),base.API.call("create_game",{inviter:t,gameName:i,game_id:r}).then(function(e){})["catch"](function(e){console.log(e)}),this.stage){var n=new e.InviteFriends(r,t,i,this.stage.stageWidth,this.stage.stageHeight);this.stage.addChild(n),this.sprite.visible=!1}}else this.text2.text="you must input your name , the game's name and the game_id"},i.prototype.onTouchEnd=function(){egret.log("onTouchEnd")},i.prototype.onTouchMove=function(){egret.log("onTouchMove")},i.prototype.onTouchTap=function(){egret.log("onTouchTap")},i}(egret.DisplayObjectContainer);e.CreateGame=t,__reflect(t.prototype,"game.CreateGame")}(game||(game={}));var LoadingUI=function(e){function t(){var t=e.call(this)||this;return t.createView(),t}return __extends(t,e),t.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},t.prototype.onProgress=function(e,t){this.textField.text="Loading..."+e+"/"+t},t}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var DebugPlatform=function(){function e(){}return e.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2,{nickName:"username"}]})})},e.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},e}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var base;!function(e){var t=function(){function e(e){this.baseUrl=e}return e.Init=function(t){e.instance=new e(t)},e.call=function(e,t){return __awaiter(this,void 0,void 0,function(){var i,r=this;return __generator(this,function(n){return i=new Promise(function(i,n){var a=new egret.HttpRequest;a.responseType=egret.HttpResponseType.TEXT,a.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8"),a.open(r.instance.baseUrl+e+"/","POST"),a.send(JSON.stringify(t)),a.addEventListener(egret.Event.COMPLETE,function(e){var t=JSON.parse(a.response);t.success?i(t.result):n({code:t.code,msg:t.msg})},r)}),[2,i]})})},e.instance=null,e}();e.API=t,__reflect(t.prototype,"base.API")}(base||(base={}));var base;!function(e){var t=function(){function e(){}return e.prototype.getAsset=function(e,t,i){function r(r){t.call(i,r,e)}var n=RES.getRes(e);n?r(n):RES.getResAsync(e,r,this)},e}();e.AssetAdapter=t,__reflect(t.prototype,"base.AssetAdapter",["eui.IAssetAdapter"])}(base||(base={}));var Button=function(e){function t(t,i){var r=e.call(this)||this,n=new eui.Group;n.width=t,n.height=i,r.addChild(n);var a=new eui.VerticalLayout;a.gap=30,a.verticalAlign=egret.VerticalAlign.MIDDLE,a.horizontalAlign=egret.HorizontalAlign.CENTER,n.layout=a;var o=new egret.Shape;o.graphics.beginFill(13378065),o.graphics.drawCircle(12,12,6),o.graphics.endFill(),r._icon=o;var s=new egret.RenderTexture;s.drawToTexture(o);var h=new eui.Button;return h.label="按钮",h.icon=s,h.addEventListener(egret.TouchEvent.TOUCH_TAP,r.onTouch,r),n.addChild(h),r}return __extends(t,e),t.prototype.onTouch=function(e){var t=e.target,i=new egret.RenderTexture;switch(i.drawToTexture(this._icon),e.type){case egret.TouchEvent.TOUCH_BEGIN:t.icon=i;break;case egret.TouchEvent.TOUCH_END:t.icon=null}},t}(eui.UILayer);__reflect(Button.prototype,"Button");var base;!function(e){var t=function(){function e(){}return e.prototype.getTheme=function(e,t,i,r){function n(e){t.call(r,e)}function a(t){t.resItem.url===e&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,a,null),i.call(r))}var o=this;"undefined"!=typeof generateEUI?egret.callLater(function(){t.call(r,generateEUI)},this):"undefined"!=typeof generateEUI2?RES.getResByUrl("resource/gameEui.json",function(e,i){window.JSONParseClass.setData(e),n(e),egret.callLater(function(){t.call(r,generateEUI2)},o)},this,RES.ResourceItem.TYPE_JSON):(RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,a,null),RES.getResByUrl(e,n,this,RES.ResourceItem.TYPE_TEXT))},e}();e.ThemeAdapter=t,__reflect(t.prototype,"base.ThemeAdapter",["eui.IThemeAdapter"])}(base||(base={}));var game;!function(e){var t=function(t){function i(e,i,r,n,a,o,s,h){var c=t.call(this)||this;return c.playerList=[],c.game_secret="",c.player="",c.gameName="",c.inviter="",c.characterTwo="",c.characterOne="",c.stageWidth=0,c.stageHeight=0,c._touchStatus=!1,c._distance=new egret.Point,c.characterList=[],c.characterListParams=[],c.charaChooser=[],c.map={},c.game_secret=e,c.player=r,c.gameName=n,c.inviter=i,c.count=s,c.characterListParams=h,c.characterList=h[1],c.charaChooser=h[0],c.characterTwo=c.characterList[s][1],c.characterOne=c.characterList[s][0],c.stageWidth=a,c.stageHeight=o,c.sprite=new egret.Sprite,c.sprite.width=a,c.sprite.height=o,c.sprite.x=0,c.sprite.y=0,c.addChild(c.sprite),c.sprite.addEventListener(egret.Event.ADDED_TO_STAGE,c.getPlayList,c),c.rectShapeOne=new egret.Shape,c.rectShapeTwo=new egret.Shape,c.sprite.addChild(c.rectShapeOne),c.sprite.addChild(c.rectShapeTwo),c.drawRect(),c._shape=new egret.Shape,c.addChild(c._shape),c.initGraphics(),c.charater1=new egret.TextField,c.sprite.addChild(c.charater1),c.initCharacter1(a-390,200),c.charater2=new egret.TextField,c.sprite.addChild(c.charater2),c.initCharacter(a-390,c.stageHeight-150),c.rightIcon=new egret.Bitmap(RES.getRes("right_png")),c.rightIcon.width=100,c.rightIcon.height=100,c.rightIcon.anchorOffsetX=c.rightIcon.width/2,c.rightIcon.anchorOffsetY=c.rightIcon.height/2,c.rightIcon.x=a-50,c.rightIcon.y=o/2,c.addChild(c.rightIcon),c.rightIcon.touchEnabled=!0,c.rightIcon.addEventListener(egret.TouchEvent.TOUCH_BEGIN,c.nextTouch,c),c.closeIcon=new egret.Bitmap(RES.getRes("close-circle_png")),c.closeIcon.width=40,c.closeIcon.height=40,c.closeIcon.anchorOffsetX=c.closeIcon.width/2,c.closeIcon.anchorOffsetY=c.closeIcon.height/2,c.closeIcon.x=a-30,c.closeIcon.y=150,c.closeIcon.touchEnabled=!0,c.closeIcon.addEventListener(egret.TouchEvent.TOUCH_BEGIN,c.closeTip,c),c.addChild(c.closeIcon),c.tiptext=new egret.TextField,c}return __extends(i,t),i.prototype.closeTip=function(){this.tiptext.parent&&this.removeChild(this.tiptext)},i.prototype.nextTouch=function(){var t=this.sprite.numChildren-this.playerList.length-4;if(this.playerList.length==t){var i=this.game_secret,r=this.inviter,n=this.player,a=this.gameName,o=this.stageWidth,s=this.stageHeight;if(this.count+1==this.characterList.length){console.log("所有性格打分结束");var h=new e.TensionScaleResult(o,s,r,i,n,a,this.characterListParams);this.stage.addChild(h),this.sprite.visible=!1,this._shape.visible=!1,this.rightIcon.visible=!1}else{console.log("打分结束"),base.API.Init("http://39.104.85.167:8105/api/"),base.API.call("set_player_score",{params:this.map,inviter_name:this.inviter,gameSecret:this.game_secret,player:this.player,gameName:this.gameName,charaChooser:this.charaChooser[this.count],characterOne:this.characterOne,characterTwo:this.characterTwo}).then(function(e){console.log(e)}),this.count+=1;var c=new e.Character(i,r,n,a,o,s,this.count,this.characterListParams);this.sprite.visible=!1,this.removeChild(this.rightIcon),this.removeChild(this.closeIcon),this._shape.visible=!1,this.stage.addChild(c),this.tiptext.text=""}}else this.addChild(this.tiptext),this.tip(100,100,"Everyone must be graded!")},i.prototype.tip=function(e,t,i){var r=this.tiptext;r.x=e,r.y=t,r.text=i,r.size=40,r.width=this.stageWidth},i.prototype.drawRect=function(){var e=this.rectShapeOne;e.graphics.beginFill(16711680,.5),e.graphics.drawRect(0,0,this.stageWidth+60,180),e.graphics.endFill();var t=this.rectShapeTwo;t.graphics.beginFill(16711680,.5),t.graphics.drawRect(0,this.stageHeight-100,this.stageWidth+60,200),t.graphics.endFill()},i.prototype.initGraphics=function(){var e=this._shape;e.graphics.lineStyle(2,16711935),e.graphics.moveTo(this.stageWidth-250,this.stageHeight-150),e.graphics.lineTo(this.stageWidth-250,240)},i.prototype.initCharacter=function(e,t){var i=this.charater2;i.text=this.characterTwo,i.textAlign=egret.HorizontalAlign.CENTER,i.size=40,i.border=!0,i.width=280,i.borderColor=3825613,i.x=e,i.y=t},i.prototype.initCharacter1=function(e,t){var i=this.charater1;i.text=this.characterOne,i.textAlign=egret.HorizontalAlign.CENTER,i.size=40,i.border=!0,i.width=280,i.borderColor=3825613,i.x=e,i.y=t},i.prototype.getPlayList=function(){base.API.Init("http://39.104.85.167:8105/api/");var e=this;base.API.call("get_player_list",{game_secret:e.game_secret,gameName:e.gameName,inviter:e.inviter}).then(function(t){var i=this;e.playerList=t.player_list,e.playerList.forEach(function(t,r,n){var a=new egret.TextField;a.text=t,a.textAlign=egret.HorizontalAlign.CENTER,a.size=30,a.lineSpacing=10,a.touchEnabled=!0,a.border=!0,18*t.length<100?a.width=100:a.width=18*t.length,a.borderColor=65280,a.x=70,a.y=300+50*r;var o=new egret.TextField;o.text="",o.size=30,o.border=!0,o.width=50,o.borderColor=65280,o.textAlign=egret.HorizontalAlign.CENTER,a.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(t){e._touchStatus=!0;var r=t.stageX,n=a.x,s=a.y,h=t.stageY;a.addEventListener(egret.TouchEvent.TOUCH_MOVE,function(t){if(e._touchStatus){a.x=t.stageX-r+n,a.y=t.stageY-h+s,o.parent&&o.parent.removeChild(o);var i=100;if(a.width>100&&(i=a.width),a.x>e.stageWidth-250-i&&(a.x=e.stageWidth-250-i,a.y>240&&a.y<e.stageHeight-100)){o.x=a.x+i,o.y=a.y;var c=(e.stageHeight-150-240)/81;o.text=Math.ceil((o.y-240)/c).toString(),e.sprite.addChild(o);var l=Math.ceil((o.y-240)/c).toString(),g=a.text;e.map[g]=l,console.log(e.map)}}},i)},i),a.addEventListener(egret.TouchEvent.TOUCH_END,function(t){e._touchStatus=!1,a.removeEventListener(egret.TouchEvent.TOUCH_MOVE,i.mouseMove,i)},i),e.sprite.addChild(a)})})},i.prototype.onTouchEnd=function(){egret.log("onTouchEnd")},i.prototype.onTouchMove=function(){egret.log("onTouchMove")},i.prototype.onTouchTap=function(){egret.log("onTouchTap")},i}(egret.DisplayObjectContainer);e.Character=t,__reflect(t.prototype,"game.Character")}(game||(game={}));var game;!function(e){var t=function(t){function i(e,i,r,n,a,o,s){var h=t.call(this)||this;return h.unselectedCharacterList=[],h.selectedChaeacterList=[],h.game_secret="",h.gameName="",h.inviter="",h.player="",h.stageWidth=0,h.stageHeight=0,h.count=0,h._touchStatus=!1,h.select_list=[],h.playerCount=0,h.playerList=[],h.flag1=0,h.flag2=0,h.characterList=[],h.allcharacterlist=[],h.chooseText=[],h.stageWidth=a,h.stageHeight=o,h.player=r,h.gameName=n,h.game_secret=e,h.inviter=i,h.playerCount=s,h.sprite=new egret.Sprite,h.addChild(h.sprite),h.sprite.touchEnabled=!0,h.titleBackground=new egret.Shape,h.sprite.addChild(h.titleBackground),h.drawTitleBackground(),h.createTitle(),h.getCharacterList(),h.drawSplitLine(),h.confirmButton=new egret.Shape,h.confirmButton.graphics.beginFill(52224),h.confirmButton.graphics.drawRect(0,0,200,50),h.confirmButton.graphics.endFill(),h.confirmButton.y=230,h.confirmButton.x=100,h.confirmButton.touchEnabled=!0,h.confirmButton.addEventListener(egret.TouchEvent.TOUCH_TAP,h.addTensionScale,h),h.confirmText=new egret.TextField,h.confirmText.text="Confirm",h.confirmText.size=30,h.confirmText.x=h.confirmButton.x+50,h.confirmText.y=h.confirmButton.y+10,h.sprite.addChild(h.confirmButton),h.sprite.addChild(h.confirmText),h.confirmText.visible=!1,h.confirmButton.visible=!1,h.rightIcon=new egret.Bitmap(RES.getRes("right_png")),h.rightIcon.width=100,h.rightIcon.height=100,h.rightIcon.anchorOffsetX=h.rightIcon.width/2,h.rightIcon.anchorOffsetY=h.rightIcon.height/2,h.rightIcon.x=a-50,h.rightIcon.y=o-100,h.rightIcon.touchEnabled=!0,h.rightIcon.addEventListener(egret.TouchEvent.TOUCH_TAP,h.rightNext,h),h.chooseone=new egret.TextField,h.chooseone.textAlign=egret.HorizontalAlign.CENTER,h.chooseone.textAlign=egret.VerticalAlign.MIDDLE,h.chooseone.size=30,h.chooseone.text="point & click",h.chooseone.lineSpacing=10,h.chooseone.border=!0,h.chooseone.width=190,h.chooseone.borderColor=3825613,h.chooseone.height=40,h.chooseone.y=170,h.chooseone.touchEnabled=!0,h.chooseone.addEventListener(egret.TouchEvent.TOUCH_TAP,h.touchone,h),h.sprite.addChild(h.chooseone),h.choosetwo=new egret.TextField,h.choosetwo.textAlign=egret.HorizontalAlign.CENTER,h.chooseone.textAlign=egret.VerticalAlign.BOTTOM,h.choosetwo.size=30,h.choosetwo.lineSpacing=10,h.choosetwo.text="point & click",h.choosetwo.border=!0,h.choosetwo.width=190,h.choosetwo.borderColor=3825613,h.choosetwo.height=40,h.choosetwo.y=170,h.choosetwo.x=210,h.choosetwo.touchEnabled=!0,h.choosetwo.addEventListener(egret.TouchEvent.TOUCH_TAP,h.touchtwo,h),h.sprite.addChild(h.choosetwo),h.timer=new egret.Timer(1e3,0),h.timer.addEventListener(egret.TimerEvent.TIMER,h.getPlayerCharacterList,h),h.timer.start(),h}return __extends(i,t),i.prototype.touchone=function(){if(this.chooseText[0]){this.chooseone.text="";var e=new egret.TextField;e.text=this.chooseText[0],e.textAlign=egret.HorizontalAlign.CENTER,e.size=30,e.lineSpacing=10,e.border=!0,e.width=this.chooseone.width,e.height=this.chooseone.height,e.background=!0,e.borderColor=6513507,e.backgroundColor=7434694,e.x=this.chooseone.x,e.y=this.chooseone.y,this.sprite.addChild(e)}},i.prototype.touchtwo=function(){if(this.chooseText[1]){this.choosetwo.text="";var e=new egret.TextField;e.text=this.chooseText[1],e.textAlign=egret.HorizontalAlign.CENTER,e.size=30,e.lineSpacing=10,e.border=!0,e.width=this.choosetwo.width,e.height=this.choosetwo.height,e.background=!0,e.borderColor=6513507,e.backgroundColor=7434694,e.x=this.choosetwo.x,e.y=this.choosetwo.y,this.sprite.addChild(e),this.confirmButton.visible=!0,this.confirmText.visible=!0}},i.prototype.rightNext=function(){if(this.stage){var t=this.game_secret,i=this.inviter,r=this.player,n=this.gameName,a=this.stageWidth,o=this.stageHeight,s=0,h=new e.Character(t,i,r,n,a,o,s,this.characterList);this.stage.addChild(h),this.sprite.visible=!1,this.rightIcon.visible=!1}},i.prototype.getPlayerCharacterList=function(){var t=this;base.API.Init("http://39.104.85.167:8105/api/"),base.API.call("get_player_characterlist",{game_secret:t.game_secret,inviter:t.inviter,player:t.player,gameName:t.gameName}).then(function(i){var r=i.data;r.forEach(function(i,r,n){var a=i[0];if(-1==t.playerList.indexOf(a)){t.count++;var o=new e.TensionScale(t.stageWidth,t.stageHeight,i[1],0);t.allcharacterlist.push(i[1]),t.sprite.addChild(o),o.x=t.stageWidth-200,o.y=150*t.count,t.playerList.push(a)}}),t.count==t.playerCount&&(t.characterList.push(t.playerList),t.characterList.push(t.allcharacterlist),t.addChild(t.rightIcon),t.timer.stop())})},i.prototype.startGame=function(t,i,r){if(this.stage){var n=new e.EnterGame(t,i,r,this.stage.stageWidth,this.stage.stageHeight);this.stage.addChild(n),this.sprite.visible=!1,this.label.visible=!1}},i.prototype.drawTitleBackground=function(){var e=this.titleBackground;e.graphics.beginFill(16711680,.5),e.graphics.drawRect(0,0,this.stageWidth,130),e.graphics.endFill()},i.prototype.createTitle=function(){var e=new egret.TextField;e.text="Task: SCREEN through the list and name the TWOSOMES of formative tensions that unite, seperate and define the organizing dynamics in your team.",e.size=30,e.width=this.stageWidth,e.x=320-e.textWidth/2,e.y=10,this.sprite.addChild(e)},i.prototype.drawSplitLine=function(){var e=new egret.Shape;e.graphics.lineStyle(2,16777215),e.graphics.moveTo(400,this.stageHeight),e.graphics.lineTo(400,130),e.graphics.endFill(),this.sprite.addChild(e)},i.prototype.getCharacterList=function(){base.API.Init("http://39.104.85.167:8105/api/");var e=this;base.API.call("get_character_list",{}).then(function(t){var i=this;e.unselectedCharacterList=t.characters,e.unselectedCharacterList.forEach(function(t,r,n){var a=new egret.TextField;a.text=t,a.textAlign=egret.HorizontalAlign.CENTER,a.size=30,a.lineSpacing=10,a.touchEnabled=!0,a.border=!0,a.width=100,a.borderColor=65280,a.x=70,a.y=300+50*r,a.background=!0,a.backgroundColor=6513507,18*t.length<100?a.width=100:a.width=18*t.length,a.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){2==e.chooseText.length?a.touchEnabled=!1:(e.chooseText.push(a.text),e.select_list.push(a.text),a.backgroundColor=65280,a.alpha=.4,a.touchEnabled=!1)},i),e.sprite.addChild(a)})})},i.prototype.addTensionScale=function(){var t=this;if((this.select_list.length=2)&&(base.API.Init("http://39.104.85.167:8105/api/"),base.API.call("save_character_choose",{inviterName:t.inviter,gameSecret:t.game_secret,playerName:t.player,gameName:t.gameName,charaChooser:t.select_list}).then(function(e){t.confirmButton.touchEnabled=!1})),this.stage){var i=new e.TensionScale(this.stageWidth,this.stageHeight,this.select_list,0);console.log(i),this.sprite.addChild(i),i.x=this.stageWidth-200,i.y=150*(this.count+1)}},i.prototype.onTouchBegin=function(){if(this.stage){var t=new e.CreateGame(this.stage.stageWidth,this.stage.stageHeight);this.stage.addChild(t),this.sprite.visible=!1,this.label.visible=!1}},i.prototype.onTouchEnd=function(){egret.log("onTouchEnd")},i.prototype.onTouchMove=function(){egret.log("onTouchMove")},i.prototype.onTouchTap=function(){egret.log("onTouchTap")},i}(egret.DisplayObjectContainer);e.CharacterChoosePage=t,__reflect(t.prototype,"game.CharacterChoosePage")}(game||(game={}));var Main=function(e){function t(){var t=e.call(this)||this;return t.addEventListener(egret.Event.ADDED_TO_STAGE,t.onAddToStage,t),t}return __extends(t,e),t.prototype.onAddToStage=function(e){egret.lifecycle.addLifecycleListener(function(e){e.onUpdate=function(){}}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()},this.runGame()["catch"](function(e){console.log(e)})},t.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){var e,t;return __generator(this,function(i){switch(i.label){case 0:return[4,this.loadResource()];case 1:return i.sent(),this.createGameScene(),[4,RES.getResAsync("description_json")];case 2:return e=i.sent(),[4,platform.login()];case 3:return i.sent(),[4,platform.getUserInfo()];case 4:return t=i.sent(),console.log(t),[2]}})})},t.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var e,t;return __generator(this,function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),e=new LoadingUI,this.stage.addChild(e),[4,RES.loadConfig("resource/default.res.json","resource/")];case 1:return i.sent(),[4,RES.loadGroup("preload",0,e)];case 2:return i.sent(),this.stage.removeChild(e),[3,4];case 3:return t=i.sent(),console.error(t),[3,4];case 4:return[2]}})})},t.prototype.createGameScene=function(){var e=this.stage.stageWidth,t=this.stage.stageHeight,i=new game.Index(e,t);this.stage.addChild(i)},t.prototype.createBitmapByName=function(e){var t=new egret.Bitmap,i=RES.getRes(e);return t.texture=i,t},t.prototype.startAnimation=function(e){var t=this,i=new egret.HtmlTextParser,r=e.map(function(e){return i.parse(e)}),n=this.textfield,a=-1,o=function(){a++,a>=r.length&&(a=0);var e=r[a];n.textFlow=e;var i=egret.Tween.get(n);i.to({alpha:1},200),i.wait(2e3),i.to({alpha:0},200),i.call(o,t)};o()},t}(egret.DisplayObjectContainer);__reflect(Main.prototype,"Main");var game;!function(e){var t=function(t){function i(e,i,r,n,a){var o=t.call(this)||this;o.count=0,o.playerList=[],o.game_secret="",o.gameName="",o.isPlayer=0,o.inviter="",o.game_secret=e,o.gameName=i,o.inviter=r,o.sprite=new egret.Sprite,o.sprite.width=n,o.sprite.height=a,o.addChild(o.sprite);var s=new egret.Shape;s.graphics.beginFill(16774638),s.graphics.drawRect(0,0,300,50),s.graphics.endFill(),s.x=o.sprite.width/2+80,s.y=o.sprite.height/3,s.anchorOffsetX=s.width/2,s.anchorOffsetY=s.height/2,o.sprite.addChild(s);var h=new egret.Shape;h.graphics.beginFill(16774638),h.graphics.drawRect(0,0,300,50),h.graphics.endFill(),h.x=o.sprite.width/2+80,h.y=o.sprite.height/3-100,h.anchorOffsetX=h.width/2,h.anchorOffsetY=h.height/2,o.sprite.addChild(h),o.txInput2=new egret.TextField,o.txInput2.type=egret.TextFieldType.INPUT,o.txInput2.inputType=egret.TextFieldInputType.TEXT,o.txInput2.width=290,o.txInput2.height=50,o.txInput2.x=o.sprite.width/2+80,o.txInput2.y=o.sprite.height/3-100,o.txInput2.anchorOffsetX=o.txInput2.width/2,o.txInput2.anchorOffsetY=o.txInput2.height/2,o.txInput2.textColor=855309,o.txInput2.size=40;var c=new egret.TextField;c.text="input game secret:",c.x=o.sprite.width/2-320,c.y=o.sprite.height/3-118,c.size=30,o.sprite.addChild(c),o.sprite.addChild(o.txInput2),o.txInput=new egret.TextField,o.txInput.type=egret.TextFieldType.INPUT,o.txInput.inputType=egret.TextFieldInputType.TEXT,o.txInput.width=290,o.txInput.height=50,o.txInput.x=o.sprite.width/2+80,o.txInput.y=o.sprite.height/3,o.txInput.anchorOffsetX=o.txInput.width/2,o.txInput.anchorOffsetY=o.txInput.height/2,o.txInput.textColor=855309,o.txInput.size=40;var l=new egret.TextField;l.text="input your name:",l.x=o.sprite.width/2-320,l.y=o.sprite.height/3-18,l.size=30,o.sprite.addChild(l),o.sprite.addChild(o.txInput);var g=new egret.Shape;g.graphics.beginFill(52224),g.graphics.drawRect(0,0,200,50),g.graphics.endFill(),g.x=o.sprite.width/2,g.y=o.sprite.height/2,g.anchorOffsetX=g.width/2,g.anchorOffsetY=g.height/2,g.touchEnabled=!0,g.addEventListener(egret.TouchEvent.TOUCH_BEGIN,o.onTouchBegin,o),o.sprite.addChild(g);var d=new egret.TextField;return d.text="play",d.anchorOffsetX=d.width/2,d.anchorOffsetY=d.height/2,d.x=o.sprite.width/2,d.y=o.sprite.height/2,o.sprite.addChild(d),o.text2=new egret.TextField,o.text2.text="please input your name and the game's secret",o.text2.width=n,o.sprite.addChild(o.text2),o}return __extends(i,t),i.prototype.onTouchBegin=function(){var t=this.txInput.text,i=this.txInput2.text;console.log("player:"+t);var r=this;t&&i?(console.log(i),console.log(this.game_secret),base.API.Init("http://39.104.85.167:8105/api/"),base.API.call("find_players",{game_secret:r.game_secret,gameName:r.gameName}).then(function(n){console.log(n);var a=n.player_list;console.log(r.txInput.text);var o=a.indexOf(r.txInput.text);if(console.log(o),i!=r.game_secret)r.text2.text="please input the correct secret to enter the game";else if(-1==o)r.text2.text="you aren't invited !";else if(r.stage){console.log(33333);var s=new e.GamePageOne(i,r.inviter,t,r.gameName,r.stage.stageWidth,r.stage.stageHeight);r.stage.addChild(s),r.sprite.visible=!1}r.isPlayer=o})["catch"](function(e){console.log(e)})):this.text2.text="you must input your name and the game's secret"},i.prototype.onTouchEnd=function(){egret.log("onTouchEnd")},i.prototype.onTouchMove=function(){egret.log("onTouchMove")},i.prototype.onTouchTap=function(){egret.log("onTouchTap")},i}(egret.DisplayObjectContainer);e.EnterGame=t,__reflect(t.prototype,"game.EnterGame")}(game||(game={}));var game;!function(e){var t=function(t){function i(e,i,r,n,a,o){var s=t.call(this)||this;s.playerList=[],s.game_secret="",s.player="",s.gameName="",s.inviter="",s.stageWidth=0,s.stageHeight=0,s.characterTwo="Fully",s.characterOne="Insufficiently",s._touchStatus=!1,s._distance=new egret.Point,s.characterList=[],s.map={},s.game_secret=e,s.player=r,s.gameName=n,s.inviter=i,s.stageWidth=a,s.stageHeight=o,s.sprite=new egret.Sprite,s.sprite.width=a,s.sprite.height=o,s.sprite.x=0,s.sprite.y=0,s.addChild(s.sprite),s.sprite.addEventListener(egret.Event.ADDED_TO_STAGE,s.getPlayList,s),s.rectShapeOne=new egret.Shape,s.rectShapeTwo=new egret.Shape,s.sprite.addChild(s.rectShapeOne),s.sprite.addChild(s.rectShapeTwo),s.drawRect();var h=new egret.TextField;h.text="Insufficiently",h.textAlign=egret.HorizontalAlign.CENTER,h.size=40,h.border=!0,h.width=280,h.borderColor=3825613,h.x=a-390,h.y=200,s.sprite.addChild(h),s._shape=new egret.Shape,s.addChild(s._shape),s.initGraphics(),s.charater2=new egret.TextField,s.sprite.addChild(s.charater2),s.initCharacter(a-390,s.stageHeight-150),s.rightIcon=new egret.Bitmap(RES.getRes("right_png")),s.rightIcon.width=100,s.rightIcon.height=100,s.rightIcon.anchorOffsetX=s.rightIcon.width/2,s.rightIcon.anchorOffsetY=s.rightIcon.height/2,s.rightIcon.x=a-50,s.rightIcon.y=o/2,s.rightIcon.touchEnabled=!0,s.rightIcon.visible=!1,s.addChild(s.rightIcon),s.rightIcon.addEventListener(egret.TouchEvent.TOUCH_BEGIN,s.nextTouch,s),s.closeIcon=new egret.Bitmap(RES.getRes("close-circle_png")),s.closeIcon.width=40,s.closeIcon.height=40,s.closeIcon.anchorOffsetX=s.closeIcon.width/2,s.closeIcon.anchorOffsetY=s.closeIcon.height/2,s.closeIcon.x=a-30,s.closeIcon.y=150,s.closeIcon.touchEnabled=!0,s.closeIcon.addEventListener(egret.TouchEvent.TOUCH_BEGIN,s.closeTip,s),s.addChild(s.closeIcon),s.tiptext=new egret.TextField,s.addChild(s.tiptext);var c=" The ARK is serving the cause of tapping into your teams‘ full potential. Your first task: ANONY- MOUSLY rank your team on this Potentiality Sca- le from 1 to 81.";return s.tip(1,1,c,30),s}return __extends(i,t),i.prototype.closeTip=function(){this.tiptext.parent&&this.removeChild(this.tiptext)},i.prototype.nextTouch=function(){this.sprite.numChildren-this.playerList.length-4;if(this.stage){var t=this.game_secret,i=this.inviter,r=this.player,n=this.gameName,a=this.stageWidth,o=this.stageHeight,s=this.playerList.length,h=new e.CharacterChoosePage(t,i,r,n,a,o,s);this.stage.addChild(h),this.sprite.visible=!1,this.removeChild(this.rightIcon),this.removeChild(this.closeIcon),this.closeTip(),this._shape.visible=!1}},i.prototype.tip=function(e,t,i,r){var n=this.tiptext;n.x=e,n.y=t,n.text=i,n.size=r,n.width=this.stageWidth},i.prototype.drawRect=function(){var e=this.rectShapeOne;e.graphics.beginFill(16711680,.5),e.graphics.drawRect(0,0,this.stageWidth+60,180),e.graphics.endFill();var t=this.rectShapeTwo;t.graphics.beginFill(16711680,.5),t.graphics.drawRect(0,this.stageHeight-100,this.stageWidth+60,200),t.graphics.endFill()},i.prototype.initGraphics=function(){var e=this._shape;e.graphics.lineStyle(2,16711935),e.graphics.moveTo(this.stageWidth-250,this.stageHeight-150),e.graphics.lineTo(this.stageWidth-250,240)},i.prototype.initCharacter=function(e,t){var i=this.charater2;i.text="Fully",i.textAlign=egret.HorizontalAlign.CENTER,i.size=40,i.border=!0,i.width=280,i.borderColor=3825613,i.x=e,i.y=t},i.prototype.getPlayList=function(){base.API.Init("http://39.104.85.167:8105/api/");var e=this;base.API.call("get_player_list",{game_secret:e.game_secret,gameName:e.gameName,inviter:e.inviter}).then(function(t){var i=this;e.playerList=t.player_list,console.log(e.playerList),e.playerList.forEach(function(t,r,n){if(t==e.player){var a=new egret.TextField;a.text=t,a.textAlign=egret.HorizontalAlign.CENTER,a.size=30,a.lineSpacing=10,a.touchEnabled=!0,a.border=!0,18*t.length<100?a.width=100:a.width=18*t.length,a.borderColor=65280,a.x=70,a.y=300+50*r;var o=new egret.TextField;o.text="",o.size=30,o.border=!0,o.width=50,o.borderColor=65280,o.textAlign=egret.HorizontalAlign.CENTER,a.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(t){e._touchStatus=!0;var r=t.stageX,n=a.x,s=a.y,h=t.stageY;a.addEventListener(egret.TouchEvent.TOUCH_MOVE,function(t){if(e._touchStatus){a.x=t.stageX-r+n,a.y=t.stageY-h+s,o.parent&&o.parent.removeChild(o);var i=100;if(a.width>100&&(i=a.width),a.x>e.stageWidth-250-i&&(a.x=e.stageWidth-250-i,a.y>240&&a.y<e.stageHeight-150-a.height)){o.x=a.x+i,o.y=a.y;var c=(e.stageHeight-150-240-a.height)/81;o.text=Math.ceil((o.y-240)/c).toString(),e.sprite.addChild(o);
var l=Math.ceil((o.y-240)/c).toString(),g=a.text;e.map[g]=l,e.rightIcon.visible=!0}a.y>e.stageHeight-150-a.height&&(a.y=e.stageHeight-150-a.height)}},i)},i),a.addEventListener(egret.TouchEvent.TOUCH_END,function(t){e._touchStatus=!1,a.removeEventListener(egret.TouchEvent.TOUCH_MOVE,i.mouseMove,i)},i),e.sprite.addChild(a)}})})},i.prototype.onTouchEnd=function(){egret.log("onTouchEnd")},i.prototype.onTouchMove=function(){egret.log("onTouchMove")},i.prototype.onTouchTap=function(){egret.log("onTouchTap")},i}(egret.DisplayObjectContainer);e.GamePageOne=t,__reflect(t.prototype,"game.GamePageOne")}(game||(game={}));var game;!function(e){var t=function(t){function i(e,i){var r=t.call(this)||this;return r.game_list=[],r.stageWidth=0,r.stageHeight=0,r.stageWidth=e,r.stageHeight=i,r.sprite=new egret.Sprite,r.addChild(r.sprite),r.sprite.touchEnabled=!0,r.label=new egret.TextField,r.label.text="create game",r.label.height=80,r.label.width=180,r.label.anchorOffsetX=r.label.width/2,r.label.anchorOffsetY=r.label.height/2,r.label.x=r.stageWidth/2,r.label.y=r.stageHeight,r.label.touchEnabled=!0,r.label.background=!0,r.label.backgroundColor=16777215,r.label.border=!0,r.label.borderColor=65280,r.label.fontFamily="Arial",r.label.textColor=16711680,r.label.addEventListener(egret.TouchEvent.TOUCH_BEGIN,r.onTouchBegin,r),r.addChild(r.label),r.sprite.addEventListener(egret.Event.ADDED_TO_STAGE,r.getGameList,r),r}return __extends(i,t),i.prototype.getGameList=function(){base.API.Init("http://39.104.85.167:8105/api/");var e=this;base.API.call("get_game_list",{}).then(function(t){var i=this;this.game_list=t.gameList,this.game_list.forEach(function(t,r,n){var a=new egret.TextField;a.text=t[1],a.size=40,a.lineSpacing=10,a.touchEnabled=!0,a.border=!0,a.borderColor=65280,a.anchorOffsetX=a.width/2,a.anchorOffsetY=a.height/2,a.x=e.stageWidth/2,a.y=100+50*r,a.addEventListener(egret.TouchEvent.TOUCH_BEGIN,e.startGame.bind(e,t[0],t[1],t[2]),i),e.sprite.addChild(a)})})},i.prototype.startGame=function(t,i,r){if(this.stage){var n=new e.EnterGame(t,i,r,this.stage.stageWidth,this.stage.stageHeight);this.stage.addChild(n),this.sprite.visible=!1,this.label.visible=!1}},i.prototype.onTouchBegin=function(){if(console.log(this.stage),this.stage){var t=new e.CreateGame(this.stage.stageWidth,this.stage.stageHeight);this.stage.addChild(t),this.sprite.visible=!1,this.label.visible=!1}},i.prototype.onTouchEnd=function(){egret.log("onTouchEnd")},i.prototype.onTouchMove=function(){egret.log("onTouchMove")},i.prototype.onTouchTap=function(){egret.log("onTouchTap")},i}(egret.DisplayObjectContainer);e.Index=t,__reflect(t.prototype,"game.Index")}(game||(game={}));var game;!function(e){var t=function(t){function i(e,i,r,n,a){var o=t.call(this)||this;o.count=0,o.playerList=[],o.game_secret="",o.inviter="",o.gameName="",o.game_secret=e,o.inviter=i,o.gameName=r,o.sprite=new egret.Sprite,o.sprite.width=n,o.sprite.height=a,o.addChild(o.sprite);var s=new egret.Shape;s.graphics.beginFill(16774638),s.graphics.drawRect(0,0,300,50),s.graphics.endFill(),s.x=o.sprite.width/2+60,s.y=o.sprite.height/3,s.anchorOffsetX=s.width/2,s.anchorOffsetY=s.height/2,o.sprite.addChild(s),o.txInput=new egret.TextField,o.txInput.type=egret.TextFieldType.INPUT,o.txInput.inputType=egret.TextFieldInputType.TEXT,o.txInput.width=290,o.txInput.height=50,o.txInput.x=o.sprite.width/2+60,o.txInput.y=o.sprite.height/3,o.txInput.anchorOffsetX=o.txInput.width/2,o.txInput.anchorOffsetY=o.txInput.height/2,o.txInput.textColor=855309,o.txInput.size=40;var h=new egret.TextField;h.text="input player:",h.x=o.sprite.width/2-280,h.y=o.sprite.height/3-18,h.size=30,o.sprite.addChild(h),o.sprite.addChild(o.txInput);var c=new egret.Shape;c.graphics.beginFill(52224),c.graphics.drawRect(0,0,200,50),c.graphics.endFill(),c.x=o.sprite.width/2,c.y=o.sprite.height/2,c.anchorOffsetX=c.width/2,c.anchorOffsetY=c.height/2,c.touchEnabled=!0,c.addEventListener(egret.TouchEvent.TOUCH_BEGIN,o.onTouchBegin,o),o.sprite.addChild(c);var l=new egret.TextField;l.text="invite",l.anchorOffsetX=l.width/2,l.anchorOffsetY=l.height/2,l.x=o.sprite.width/2,l.y=o.sprite.height/2,o.sprite.addChild(l);var g=new egret.Shape;g.graphics.beginFill(52224),g.graphics.drawRect(0,0,200,50),g.graphics.endFill(),g.x=o.sprite.width/2,g.y=o.sprite.height/2+100,g.anchorOffsetX=c.width/2,g.anchorOffsetY=c.height/2,g.touchEnabled=!0,g.addEventListener(egret.TouchEvent.TOUCH_BEGIN,o.onTouchBegin2,o),o.sprite.addChild(g);var d=new egret.TextField;return d.text="play",d.anchorOffsetX=d.width/2,d.anchorOffsetY=d.height/2,d.x=o.sprite.width/2,d.y=o.sprite.height/2+100,o.sprite.addChild(d),o.text2=new egret.TextField,o.text2.text="You have invited "+o.count+" players",o.text2.width=n,o.sprite.addChild(o.text2),o}return __extends(i,t),i.prototype.onTouchBegin=function(){var e=this,t=this.txInput.text;if(t){var i=0;if(this.playerList.forEach(function(r,n,a){console.log(r),r==t&&(e.text2.text="please dont invite the duplicate player !",i=1)}),0==i){this.playerList.push(t),this.count+=1,this.text2.text="You have invited "+this.count+" players";var r=this;base.API.Init("http://39.104.85.167:8105/api/"),base.API.call("create_player",{player_name:t,game_secret:r.game_secret,gameName:r.gameName,inviter:r.inviter}).then(function(e){console.log(e)})["catch"](function(e){console.log(e)})}}},i.prototype.onTouchBegin2=function(){if(this.playerList.length<2)this.text2.text="You must invite 3 players to start the game at least!";else{var t=this;if(this.stage){var i=new e.GamePageOne(t.game_secret,t.inviter,t.inviter,t.gameName,this.stage.stageWidth,this.stage.stageHeight);this.stage.addChild(i),t.sprite.visible=!1}}},i.prototype.onTouchEnd=function(){egret.log("onTouchEnd")},i.prototype.onTouchMove=function(){egret.log("onTouchMove")},i.prototype.onTouchTap=function(){egret.log("onTouchTap")},i}(egret.DisplayObjectContainer);e.InviteFriends=t,__reflect(t.prototype,"game.InviteFriends")}(game||(game={}));var game;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.sprite=new egret.Sprite,t.sprite.graphics.beginFill(16711680),t.sprite.graphics.drawRect(0,0,100,100),t.sprite.graphics.endFill(),t.addChild(t.sprite),t.sprite.touchEnabled=!0,t.sprite.addEventListener(egret.TouchEvent.TOUCH_BEGIN,t.onTouchBegin,t),t.sprite.addEventListener(egret.TouchEvent.TOUCH_END,t.onTouchEnd,t),t.sprite.addEventListener(egret.TouchEvent.TOUCH_MOVE,t.onTouchMove,t),t.sprite.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onTouchTap,t),t}return __extends(t,e),t.prototype.onTouchBegin=function(){this.sprite.visible=!1},t.prototype.onTouchEnd=function(){egret.log("onTouchEnd")},t.prototype.onTouchMove=function(){egret.log("onTouchMove")},t.prototype.onTouchTap=function(){egret.log("onTouchTap")},t}(egret.DisplayObjectContainer);e.LoadingScene=t,__reflect(t.prototype,"game.LoadingScene")}(game||(game={}));var game;!function(e){var t=function(t){function i(e,i,r,n,a,o){var s=t.call(this)||this;s.playerList=[],s.game_secret="",s.player="",s.gameName="",s.inviter="",s.stageWidth=0,s.stageHeight=0,s._touchStatus=!1,s._distance=new egret.Point,s.characterList=[],s.characterTwo="Fully",s.characterOne="Insufficiently",s.player_score_list=[],s.player_list=[],s.playerscore=0,s.middle=0,s.game_secret=e,s.player=r,s.gameName=n,s.inviter=i,s.stageWidth=a,s.stageHeight=o,s.sprite=new egret.Sprite,s.sprite.width=a,s.sprite.height=o,s.sprite.x=0,s.sprite.y=0,s.addChild(s.sprite),s.sprite.addEventListener(egret.Event.ADDED_TO_STAGE,s.getPlayScoreList,s),s.rectShapeOne=new egret.Shape,s.rectShapeTwo=new egret.Shape,s.sprite.addChild(s.rectShapeOne),s.sprite.addChild(s.rectShapeTwo),s.drawRect();var h=new egret.TextField;return h.text=s.characterOne,h.textAlign=egret.HorizontalAlign.CENTER,h.size=40,h.border=!0,h.width=280,h.borderColor=3825613,h.x=a-390,h.y=200,s.sprite.addChild(h),s._shape=new egret.Shape,s.addChild(s._shape),s.initGraphics(),s.charater2=new egret.TextField,s.sprite.addChild(s.charater2),s.initCharacter(a-390,s.stageHeight-150),s.rightIcon=new egret.Bitmap(RES.getRes("right_png")),s.rightIcon.width=100,s.rightIcon.height=100,s.rightIcon.anchorOffsetX=s.rightIcon.width/2,s.rightIcon.anchorOffsetY=s.rightIcon.height/2,s.rightIcon.x=a-50,s.rightIcon.y=o/2,s.addChild(s.rightIcon),s.rightIcon.touchEnabled=!0,s.rightIcon.addEventListener(egret.TouchEvent.TOUCH_BEGIN,s.nextTouch,s),s.closeIcon=new egret.Bitmap(RES.getRes("close-circle_png")),s.closeIcon.width=40,s.closeIcon.height=40,s.closeIcon.anchorOffsetX=s.closeIcon.width/2,s.closeIcon.anchorOffsetY=s.closeIcon.height/2,s.closeIcon.x=a-30,s.closeIcon.y=150,s.closeIcon.touchEnabled=!0,s.closeIcon.addEventListener(egret.TouchEvent.TOUCH_BEGIN,s.closeTip,s),s.addChild(s.closeIcon),s.tiptext=new egret.TextField,s.timer=new egret.Timer(1e3,0),s.timer.addEventListener(egret.TimerEvent.TIMER,s.getPlayScoreList,s),s.timer.start(),s.middleScore=new egret.TextField,s.middleScore.textAlign=egret.HorizontalAlign.CENTER,s.middleScore.size=30,s.middleScore.lineSpacing=10,s.middleScore.border=!0,s.middleScore.background=!0,s.middleScore.backgroundColor=8009611,s.middleScore.borderColor=65280,s.middleScore.visible=!1,s.sprite.addChild(s.middleScore),s.middlePlayer=new egret.TextField,s.middlePlayer.textAlign=egret.HorizontalAlign.CENTER,s.middlePlayer.size=30,s.middlePlayer.lineSpacing=10,s.middlePlayer.border=!0,s.middlePlayer.background=!0,s.middlePlayer.borderColor=65280,s.middlePlayer.visible=!1,s.middlePlayer.backgroundColor=7120589,s.sprite.addChild(s.middlePlayer),s}return __extends(i,t),i.prototype.getPlayScoreList=function(){var e=this;base.API.Init("http://39.104.85.167:8105/api/"),base.API.call("get_player_score",{inviter:this.inviter,gameName:this.gameName,gameSecret:this.game_secret,player:this.player,character_one:this.characterOne,character_two:this.characterTwo,chooser:this.inviter}).then(function(t){e.player_list.forEach(function(t,i,r){var n=new egret.TextField;n.text=t,n.textAlign=egret.HorizontalAlign.CENTER,n.size=30,n.lineSpacing=10,n.touchEnabled=!0,n.border=!0,n.background=!0,n.borderColor=65280,n.alpha=.5;var a=new egret.TextField;a.size=30,a.border=!0,a.background=!0,a.borderColor=57123,a.textAlign=egret.HorizontalAlign.CENTER,a.alpha=.5,t==e.player&&i!=e.player_score_list.length?(e.playerscore=e.player_score_list[i],n.backgroundColor=7120589):n.backgroundColor=6513507,18*t.length<100?n.width=100:n.width=18*t.length;var o=100;n.width>100&&(o=n.width),i%2!=0?(n.x=e.stageWidth-250-o,a.x=n.x-50):(n.x=e.stageWidth-250,a.x=n.x+o);var s=e.player_score_list[i];n.y=s*((e.stageHeight-150-240)/81)+240,e.sprite.addChild(n),a.text=e.player_score_list[i],a.width=50,a.y=n.y,a.backgroundColor=16744228,e.sprite.addChild(a)})})},i.prototype.closeTip=function(){this.tiptext.parent&&this.removeChild(this.tiptext)},i.prototype.nextTouch=function(){if(this.stage){var t=this.game_secret,i=this.inviter,r=this.player,n=this.gameName,a=this.stageWidth,o=this.stageHeight,s=0;this.characterList=[["zjy","1","2"],[["Loyality","Joy"],["Power","Courage"],["Harmony","Disruption"]]];var h=new e.Character(t,i,r,n,a,o,s,this.characterList);this.stage.addChild(h),this.sprite.visible=!1,this.tiptext.text="",this.removeChild(this.rightIcon),this.removeChild(this.closeIcon)}},i.prototype.tip=function(e,t,i,r){var n=this.tiptext;n.x=e,n.y=t,n.text=i,n.size=r,n.width=this.stageWidth},i.prototype.drawRect=function(){var e=this.rectShapeOne;e.graphics.beginFill(16711680,.5),e.graphics.drawRect(0,0,this.stageWidth+60,180),e.graphics.endFill();var t=this.rectShapeTwo;t.graphics.beginFill(16711680,.5),t.graphics.drawRect(0,this.stageHeight-100,this.stageWidth+60,200),t.graphics.endFill()},i.prototype.initGraphics=function(){var e=this._shape;e.graphics.lineStyle(2,16711935),e.graphics.moveTo(this.stageWidth-250,this.stageHeight-150),e.graphics.lineTo(this.stageWidth-250,240)},i.prototype.initCharacter=function(e,t){var i=this.charater2;i.text=this.characterTwo,i.textAlign=egret.HorizontalAlign.CENTER,i.size=40,i.border=!0,i.width=280,i.borderColor=3825613,i.x=e,i.y=t},i.prototype.onTouchEnd=function(){egret.log("onTouchEnd")},i.prototype.onTouchMove=function(){egret.log("onTouchMove")},i.prototype.onTouchTap=function(){egret.log("onTouchTap")},i}(egret.DisplayObjectContainer);e.PageOneResult=t,__reflect(t.prototype,"game.PageOneResult")}(game||(game={}));var game;!function(e){var t=function(t){function i(e,i,r,n){var a=t.call(this)||this;return a.unselectedCharacterList=[],a.selectedChaeacterList=[],a.game_secret="",a.gameName="",a.inviter="",a.stageWidth=0,a.stageHeight=0,a._touchStatus=!1,a.select_list=[],a.score="",a.select_list=r,a.score=n,a.stageWidth=e,a.stageHeight=i,a.sprite=new egret.Sprite,a.addChild(a.sprite),a.sprite.touchEnabled=!0,a.drawCharacter(),a.drawScore(),a}return __extends(i,t),i.prototype.drawCharacter=function(){var e=(255+167772.15*Math.floor(100*Math.random()),new egret.Shape),t=new egret.Shape;e.graphics.beginFill(7434694),e.graphics.drawRect(0,0,180,60),e.graphics.endFill();var i=new egret.TextField;i.x=e.x,console.log(e.y),console.log(e.x),i.y=10,i.text=this.select_list[0],t.graphics.beginFill(7434694),t.graphics.drawRect(0,80,180,60),t.graphics.endFill();var r=new egret.TextField;r.x=t.x,r.y=90,r.text=this.select_list[1],console.log(t.y),console.log(t.x),this.sprite.addChild(e),this.sprite.addChild(t),this.sprite.addChild(i),this.sprite.addChild(r)},i.prototype.drawScore=function(){var e=new egret.Shape,t=new egret.TextField,i=(255+167772.15*Math.floor(100*Math.random()),255+167772.15*Math.floor(100*Math.random()),this.score);e.graphics.beginFill(8388564,.7),e.graphics.lineStyle(2,8232640),e.graphics.drawCircle(90,70,20),e.graphics.endFill(),this.sprite.addChild(e),t.text=i,t.size=20,t.textColor=16777215,t.x=80,t.y=60,this.sprite.addChild(t)},i.prototype.onTouchBegin=function(){if(this.stage){var t=new e.CreateGame(this.stage.stageWidth,this.stage.stageHeight);this.stage.addChild(t),this.sprite.visible=!1,this.label.visible=!1}},i.prototype.getRandomScore=function(e,t){var i=t-e,r=Math.random();return e+Math.round(r*i)},i.prototype.onTouchEnd=function(){egret.log("onTouchEnd")},i.prototype.onTouchMove=function(){egret.log("onTouchMove")},i.prototype.onTouchTap=function(){egret.log("onTouchTap")},i}(egret.DisplayObjectContainer);e.TensionScale=t,__reflect(t.prototype,"game.TensionScale")}(game||(game={}));var game;!function(e){var t=function(t){function i(e,i,r,n,a,o,s){var h=t.call(this)||this;return h.unselectedCharacterList=[],h.selectedChaeacterList=[],h.game_secret="",h.player="",h.gameName="",h.inviter="",h.characterListParams=[],h.stageWidth=0,h.stageHeight=0,h.simulatedData=[],h._touchStatus=!1,h.game_secret=n,h.player=a,h.gameName=o,h.inviter=r,h.characterListParams=s,console.log(s),h.stageWidth=e,h.stageHeight=i,h.sprite=new egret.Sprite,h.addChild(h.sprite),h.sprite.touchEnabled=!0,h.drawTensionScale(),h.drawTitle(),h.timer=new egret.Timer(1e3,0),h.timer.addEventListener(egret.TimerEvent.TIMER,h.getGameResult,h),h.timer.start(),h}return __extends(i,t),i.prototype.getGameResult=function(){var e=this;base.API.Init("http://39.104.85.167:8105/api/"),base.API.call("get_game_score",{characterListParams:e.characterListParams,inviter:e.inviter,gameSecret:e.game_secret,player:e.player,gameName:e.gameName}).then(function(t){var i=t.result;e.simulatedData=i,e.drawTensionScale()})},i.prototype.startGame=function(t,i,r){if(this.stage){var n=new e.EnterGame(t,i,r,this.stage.stageWidth,this.stage.stageHeight);this.stage.addChild(n),this.sprite.visible=!1,this.label.visible=!1}},i.prototype.drawTitle=function(){var e=new egret.Shape;e.graphics.beginFill(65280,.5),e.graphics.drawRect(0,0,this.stageWidth,130),e.graphics.endFill(),this.sprite.addChild(e);var t=new egret.TextField;t.text="Identify the major sources of tension with you teammates",t.size=30,t.width=this.stageWidth,t.x=20,t.y=2,this.sprite.addChild(t)},i.prototype.drawTensionScale=function(){var t=this;console.log(this.simulatedData),this.simulatedData.forEach(function(i,r,n){try{var a=i[2].toString(),o=new e.TensionScale(100,60,[i[0],i[1]],a);r%2==1?(o.x=150,o.y=150+100*(r-1)):r%2==0&&(o.x=350,o.y=150+100*r),t.sprite.addChild(o)}catch(s){console.log(1111111)}})},i.prototype.onTouchBegin=function(){if(this.stage){var t=new e.CreateGame(this.stage.stageWidth,this.stage.stageHeight);this.stage.addChild(t),this.sprite.visible=!1,this.label.visible=!1}},i.prototype.getRandomScore=function(e,t){var i=t-e,r=Math.random();return e+Math.round(r*i)},i.prototype.onTouchEnd=function(){egret.log("onTouchEnd")},i.prototype.onTouchMove=function(){egret.log("onTouchMove")},i.prototype.onTouchTap=function(){egret.log("onTouchTap")},i}(egret.DisplayObjectContainer);e.TensionScaleResult=t,__reflect(t.prototype,"game.TensionScaleResult")}(game||(game={}));