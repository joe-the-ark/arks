var __reflect=this&&this.__reflect||function(e,t,i){e.__class__=t,i?i.push(t):i=[t],e.__types__=e.__types__?i.concat(e.__types__):i},__extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);i.prototype=t.prototype,e.prototype=new i},__awaiter=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))(function(a,n){function o(e){try{h(r.next(e))}catch(t){n(t)}}function s(e){try{h(r["throw"](e))}catch(t){n(t)}}function h(e){e.done?a(e.value):new i(function(t){t(e.value)}).then(o,s)}h((r=r.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){function i(e){return function(t){return r([e,t])}}function r(i){if(a)throw new TypeError("Generator is already executing.");for(;h;)try{if(a=1,n&&(o=n[2&i[0]?"return":i[0]?"throw":"next"])&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[0,o.value]),i[0]){case 0:case 1:o=i;break;case 4:return h.label++,{value:i[1],done:!1};case 5:h.label++,n=i[1],i=[0];continue;case 7:i=h.ops.pop(),h.trys.pop();continue;default:if(o=h.trys,!(o=o.length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){h=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){h.label=i[1];break}if(6===i[0]&&h.label<o[1]){h.label=o[1],o=i;break}if(o&&h.label<o[2]){h.label=o[2],h.ops.push(i);break}o[2]&&h.ops.pop(),h.trys.pop();continue}i=t.call(e,h)}catch(r){i=[6,r],n=0}finally{a=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var a,n,o,s,h={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},game;!function(e){var t=function(t){function i(e,i,r,a,n,o,s,h){var c=t.call(this)||this;return c.stageWidth=0,c.stageHeight=0,c._width=600,c._x=20,c.character1="Insufficiently",c.character2="Fully",c.playerName="Joe",c.selfPerception=20,c.othersSelfPerception=[27,31,40,47,63],c.stageWidth=n,c.stageHeight=o,c.sprite=new egret.Sprite,c.game_secret=e,c.inviter=i,c.player=r,c.gameName=a,c.playerCount=s,c.selfPerception=h,c.playerName=r,c.addChild(c.sprite),c.processBar(),c.tip(),c.rightIcon(),c.drawPotentialScale(),c}return __extends(i,t),i.prototype.processBar=function(){var t=new e.ProcessBar(this.stageWidth,this.stageHeight,12,"Initaite > Partial Insights");this.sprite.addChild(t)},i.prototype.tip=function(){var e=new egret.TextField;e.text="Our Basic Hypothesis is simple: a containment of tensions within the team results in less conflict & a better deployment of the team‘s potentialities.\n\n\n\n\n\n",e.width=this._width,e.x=this._x,e.y=this.stageHeight-180,e.background=!0,e.backgroundColor=3514259,this.sprite.addChild(e)},i.prototype.rightIcon=function(){var e=new egret.Bitmap(RES.getRes("right_png"));e.width=100,e.height=100,e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height/2,e.x=this.stageWidth-50,e.y=this.stageHeight-50,e.touchEnabled=!0,e.addEventListener(egret.TouchEvent.TOUCH_TAP,this.nextTouch,this),this.sprite.addChild(e)},i.prototype.drawPotentialScale=function(){var t=new e.PotentialScale(this.stageWidth,this.stageHeight,this.character1,this.character2,this.playerName,this.selfPerception,this.game_secret,this.inviter,this.player,this.gameName,this.playerCount);t.x=this._x+350,t.y=80,this.sprite.addChild(t)},i.prototype.nextTouch=function(){var t=this.game_secret,i=this.inviter,r=this.player,a=this.gameName,n=this.stageWidth,o=this.stageHeight,s=(this.selfPerception,this.playerCount),h=new e.CharacterChoosePage(t,i,r,a,n,o,s);this.stage.addChild(h),this.sprite.visible=!1},i}(egret.DisplayObjectContainer);e.InitiatePartialInsights=t,__reflect(t.prototype,"game.InitiatePartialInsights")}(game||(game={}));var LoadingUI=function(e){function t(){var t=e.call(this)||this;return t.createView(),t}return __extends(t,e),t.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},t.prototype.onProgress=function(e,t){this.textField.text="Loading..."+e+"/"+t},t}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var DebugPlatform=function(){function e(){}return e.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2,{nickName:"username"}]})})},e.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},e}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var base;!function(e){var t=function(){function e(e){this.baseUrl=e}return e.Init=function(t){e.instance=new e(t)},e.call=function(e,t){return __awaiter(this,void 0,void 0,function(){var i,r=this;return __generator(this,function(a){return i=new Promise(function(i,a){var n=new egret.HttpRequest;n.responseType=egret.HttpResponseType.TEXT,n.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8"),n.open(r.instance.baseUrl+e+"/","POST"),n.send(JSON.stringify(t)),n.addEventListener(egret.Event.COMPLETE,function(e){var t=JSON.parse(n.response);t.success?i(t.result):a({code:t.code,msg:t.msg})},r)}),[2,i]})})},e.instance=null,e}();e.API=t,__reflect(t.prototype,"base.API")}(base||(base={}));var base;!function(e){var t=function(){function e(){}return e.prototype.getAsset=function(e,t,i){function r(r){t.call(i,r,e)}var a=RES.getRes(e);a?r(a):RES.getResAsync(e,r,this)},e}();e.AssetAdapter=t,__reflect(t.prototype,"base.AssetAdapter",["eui.IAssetAdapter"])}(base||(base={}));var Button=function(e){function t(t,i){var r=e.call(this)||this,a=new eui.Group;a.width=t,a.height=i,r.addChild(a);var n=new eui.VerticalLayout;n.gap=30,n.verticalAlign=egret.VerticalAlign.MIDDLE,n.horizontalAlign=egret.HorizontalAlign.CENTER,a.layout=n;var o=new egret.Shape;o.graphics.beginFill(13378065),o.graphics.drawCircle(12,12,6),o.graphics.endFill(),r._icon=o;var s=new egret.RenderTexture;s.drawToTexture(o);var h=new eui.Button;return h.label="按钮",h.icon=s,h.addEventListener(egret.TouchEvent.TOUCH_TAP,r.onTouch,r),a.addChild(h),r}return __extends(t,e),t.prototype.onTouch=function(e){var t=e.target,i=new egret.RenderTexture;switch(i.drawToTexture(this._icon),e.type){case egret.TouchEvent.TOUCH_BEGIN:t.icon=i;break;case egret.TouchEvent.TOUCH_END:t.icon=null}},t}(eui.UILayer);__reflect(Button.prototype,"Button");var base;!function(e){var t=function(){function e(){}return e.prototype.getTheme=function(e,t,i,r){function a(e){t.call(r,e)}function n(t){t.resItem.url===e&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,n,null),i.call(r))}var o=this;"undefined"!=typeof generateEUI?egret.callLater(function(){t.call(r,generateEUI)},this):"undefined"!=typeof generateEUI2?RES.getResByUrl("resource/gameEui.json",function(e,i){window.JSONParseClass.setData(e),a(e),egret.callLater(function(){t.call(r,generateEUI2)},o)},this,RES.ResourceItem.TYPE_JSON):(RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,n,null),RES.getResByUrl(e,a,this,RES.ResourceItem.TYPE_TEXT))},e}();e.ThemeAdapter=t,__reflect(t.prototype,"base.ThemeAdapter",["eui.IThemeAdapter"])}(base||(base={}));var game;!function(e){var t=function(t){function i(i,r,a,n,o,s,h,c,l){var g=t.call(this)||this;g.playerList=[],g.game_secret="",g.player="",g.gameName="",g.inviter="",g.characterTwo="",g.characterOne="",g.stageWidth=0,g.stageHeight=0,g._touchStatus=!1,g._distance=new egret.Point,g.characterList=[],g.characterListParams=[],g.charaChooser=[],g.playerAndOthersCharacterList=[],g.map={},g.game_secret=i,g.player=a,g.gameName=n,g.inviter=r,g.count=h,g.characterListParams=c,g.playerAndOthersCharacterList=l,g.characterList=c[1],g.charaChooser=c[0],g.characterTwo=g.characterList[h][1],g.characterOne=g.characterList[h][0],g.stageWidth=o,g.stageHeight=s,g.sprite=new egret.Sprite,g.sprite.width=o,g.sprite.height=s,g.sprite.x=0,g.sprite.y=0,g.addChild(g.sprite),g.sprite.addEventListener(egret.Event.ADDED_TO_STAGE,g.getPlayList,g),g.rectShapeOne=new egret.Shape,g.rectShapeTwo=new egret.Shape,g.sprite.addChild(g.rectShapeOne),g.sprite.addChild(g.rectShapeTwo),g.drawRect(),g._shape=new egret.Shape,g.addChild(g._shape),g.initGraphics(),g.charater1=new egret.TextField,g.sprite.addChild(g.charater1),g.initCharacter1(o-390,200),g.charater2=new egret.TextField,g.sprite.addChild(g.charater2),g.initCharacter(o-390,g.stageHeight-150),g.rightIcon=new egret.Bitmap(RES.getRes("right_png")),g.rightIcon.width=100,g.rightIcon.height=100,g.rightIcon.anchorOffsetX=g.rightIcon.width/2,g.rightIcon.anchorOffsetY=g.rightIcon.height/2,g.rightIcon.x=o-50,g.rightIcon.y=s/2,g.addChild(g.rightIcon),g.rightIcon.touchEnabled=!0,g.rightIcon.addEventListener(egret.TouchEvent.TOUCH_BEGIN,g.nextTouch,g),g.closeIcon=new egret.Bitmap(RES.getRes("close-circle_png")),g.closeIcon.width=40,g.closeIcon.height=40,g.closeIcon.anchorOffsetX=g.closeIcon.width/2,g.closeIcon.anchorOffsetY=g.closeIcon.height/2,g.closeIcon.x=o-30,g.closeIcon.y=150,g.closeIcon.touchEnabled=!0,g.closeIcon.addEventListener(egret.TouchEvent.TOUCH_BEGIN,g.closeTip,g),g.addChild(g.closeIcon),g.tiptext=new egret.TextField;var d=Math.ceil((h+1)/g.charaChooser.length*65+20),p=new e.ProcessBar(o,s,d,"Mission 1 > Vote Tension Scale");return g.sprite.addChild(p),g}return __extends(i,t),i.prototype.closeTip=function(){this.tiptext.parent&&this.removeChild(this.tiptext)},i.prototype.nextTouch=function(){var t=this.sprite.numChildren-this.playerList.length-5;if(this.playerList.length==t){var i=(this.game_secret,this.inviter,this.player,this.gameName,this.stageWidth,this.stageHeight,this.characterListParams[1][this.count][0]),r=this.characterListParams[1][this.count][1];base.API.Init("http://work.metatype.cn:8105/api/"),base.API.call("set_player_score",{params:this.map,inviter_name:this.inviter,gameSecret:this.game_secret,player:this.player,gameName:this.gameName,charaChooser:this.charaChooser[this.count],characterOne:i,characterTwo:r}).then(function(e){console.log(e)});var a=this.count,n=this.charaChooser[this.count],o=new e.MissionPartialInsights(this.stageWidth,this.stageHeight,i,r,this.player,this.player_score,this.inviter,this.game_secret,this.gameName,a,n);this.sprite.visible=!1,this.removeChild(this.rightIcon),this.removeChild(this.closeIcon),this._shape.visible=!1,this.stage.addChild(o),this.tiptext.text=""}else this.addChild(this.tiptext),this.tip(100,100,"Everyone must be graded!")},i.prototype.tip=function(e,t,i){var r=this.tiptext;r.x=e,r.y=t,r.text=i,r.size=40,r.width=this.stageWidth},i.prototype.drawRect=function(){var e=this.rectShapeOne;e.graphics.beginFill(3514259,.5),e.graphics.drawRect(0,0,this.stageWidth+60,180),e.graphics.endFill();var t=this.rectShapeTwo;t.graphics.beginFill(3514259,.5),t.graphics.drawRect(0,this.stageHeight-100,this.stageWidth+60,200),t.graphics.endFill()},i.prototype.initGraphics=function(){var e=this._shape;e.graphics.lineStyle(2,16711935),e.graphics.moveTo(this.stageWidth-250,this.stageHeight-150),e.graphics.lineTo(this.stageWidth-250,240)},i.prototype.initCharacter=function(e,t){var i=this.charater2;i.text=this.characterTwo,i.textAlign=egret.HorizontalAlign.CENTER,i.size=40,i.border=!0,i.width=280,i.borderColor=3825613,i.x=e,i.y=t},i.prototype.initCharacter1=function(e,t){var i=this.charater1;i.text=this.characterOne,i.textAlign=egret.HorizontalAlign.CENTER,i.size=40,i.border=!0,i.width=280,i.borderColor=3825613,i.x=e,i.y=t},i.prototype.getPlayList=function(){base.API.Init("http://work.metatype.cn:8105/api/");var e=this;base.API.call("get_player_list",{game_secret:e.game_secret,gameName:e.gameName,inviter:e.inviter}).then(function(t){var i=this;e.playerList=t.player_list,e.playerList.forEach(function(t,r,a){var n=new egret.TextField;n.text=t,n.textAlign=egret.HorizontalAlign.CENTER,n.size=30,n.lineSpacing=10,n.touchEnabled=!0,n.border=!0,18*t.length<100?n.width=100:n.width=18*t.length,n.borderColor=65280,n.x=70,n.y=300+50*r;var o=new egret.TextField;o.text="",o.size=30,o.border=!0,o.width=50,o.borderColor=65280,o.textAlign=egret.HorizontalAlign.CENTER,n.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(t){e._touchStatus=!0;var r=t.stageX,a=n.x,s=n.y,h=t.stageY;n.addEventListener(egret.TouchEvent.TOUCH_MOVE,function(t){if(e._touchStatus){n.x=t.stageX-r+a,n.y=t.stageY-h+s,o.parent&&o.parent.removeChild(o);var i=100;if(n.width>100&&(i=n.width),n.x>e.stageWidth-250-i&&(n.x=e.stageWidth-250-i,n.y>240&&n.y<e.stageHeight-150-n.height)){o.x=n.x+i,o.y=n.y;var c=(e.stageHeight-150-240-n.height)/81;o.text=Math.ceil((o.y-240)/c).toString(),e.sprite.addChild(o);var l=Math.ceil((o.y-240)/c).toString(),g=n.text;g==e.player&&(e.player_score=l),e.map[g]=l,console.log(e.map)}n.y>e.stageHeight-150-n.height&&(n.y=e.stageHeight-150-n.height)}},i)},i),n.addEventListener(egret.TouchEvent.TOUCH_END,function(t){e._touchStatus=!1,n.removeEventListener(egret.TouchEvent.TOUCH_MOVE,i.mouseMove,i)},i),e.sprite.addChild(n)})})},i.prototype.onTouchEnd=function(){egret.log("onTouchEnd")},i.prototype.onTouchMove=function(){egret.log("onTouchMove")},i.prototype.onTouchTap=function(){egret.log("onTouchTap")},i}(egret.DisplayObjectContainer);e.Character=t,__reflect(t.prototype,"game.Character")}(game||(game={}));var game;!function(e){var t=function(t){function i(i,r,a,n,o,s,h){var c=t.call(this)||this;c.unselectedCharacterList=[],c.selectedChaeacterList=[],c.game_secret="",c.gameName="",c.inviter="",c.player="",c.stageWidth=0,c.stageHeight=0,c.count=0,c._touchStatus=!1,c.select_list=[],c.playerCount=0,c.playerList=[],c.flag1=0,c.flag2=0,c.characterList=[],c.allcharacterlist=[],c.chooseText=[],c.playerCharacterList=[],c.stageWidth=o,c.stageHeight=s,c.player=a,console.log("player"),console.log(a),c.gameName=n,c.game_secret=i,c.inviter=r,c.playerCount=h,c.sprite=new egret.Sprite,c.addChild(c.sprite),c.sprite.touchEnabled=!0,c.titleBackground=new egret.Shape,c.sprite.addChild(c.titleBackground),c.drawTitleBackground(),c.createTitle(),c.drawSplitLine(),c.getCharacterList(),c.confirmButton=new egret.Shape,c.confirmButton.graphics.beginFill(52224),c.confirmButton.graphics.drawRect(0,0,200,50),c.confirmButton.graphics.endFill(),c.confirmButton.y=230,c.confirmButton.x=100,c.confirmButton.touchEnabled=!0,c.confirmButton.addEventListener(egret.TouchEvent.TOUCH_TAP,c.addTensionScale,c),c.confirmText=new egret.TextField,c.confirmText.text="Confirm",c.confirmText.size=30,c.confirmText.x=c.confirmButton.x+50,c.confirmText.y=c.confirmButton.y+10,c.sprite.addChild(c.confirmButton),c.sprite.addChild(c.confirmText),c.confirmText.visible=!1,c.confirmButton.visible=!1,c.rightIcon=new egret.Bitmap(RES.getRes("right_png")),c.rightIcon.width=100,c.rightIcon.height=100,c.rightIcon.anchorOffsetX=c.rightIcon.width/2,c.rightIcon.anchorOffsetY=c.rightIcon.height/2,c.rightIcon.x=o-50,c.rightIcon.y=s-100,c.rightIcon.touchEnabled=!0,c.rightIcon.addEventListener(egret.TouchEvent.TOUCH_TAP,c.rightNext,c),c.chooseone=new egret.TextField,c.chooseone.textAlign=egret.HorizontalAlign.CENTER,c.chooseone.textAlign=egret.VerticalAlign.MIDDLE,c.chooseone.size=30,c.chooseone.text="point & click",c.chooseone.lineSpacing=10,c.chooseone.border=!0,c.chooseone.width=190,c.chooseone.borderColor=3825613,c.chooseone.height=40,c.chooseone.y=170,c.chooseone.touchEnabled=!0,c.chooseone.addEventListener(egret.TouchEvent.TOUCH_TAP,c.touchone,c),c.sprite.addChild(c.chooseone),c.choosetwo=new egret.TextField,c.choosetwo.textAlign=egret.HorizontalAlign.CENTER,c.chooseone.textAlign=egret.VerticalAlign.BOTTOM,c.choosetwo.size=30,c.choosetwo.lineSpacing=10,c.choosetwo.text="point & click",c.choosetwo.border=!0,c.choosetwo.width=190,c.choosetwo.borderColor=3825613,c.choosetwo.height=40,c.choosetwo.y=170,c.choosetwo.x=210,c.choosetwo.touchEnabled=!0,c.choosetwo.addEventListener(egret.TouchEvent.TOUCH_TAP,c.touchtwo,c),c.sprite.addChild(c.choosetwo),c.timer=new egret.Timer(1e3,0),c.timer.addEventListener(egret.TimerEvent.TIMER,c.getPlayerCharacterList,c),c.timer.start();var l=new e.ProcessBar(o,s,20,"Mission 1 > Tension Scales");return c.sprite.addChild(l),c}return __extends(i,t),i.prototype.touchone=function(){if(this.chooseText[0]){this.chooseone.text="";var e=new egret.TextField;e.text=this.chooseText[0],e.textAlign=egret.HorizontalAlign.CENTER,e.size=30,e.lineSpacing=10,e.border=!0,e.width=this.chooseone.width,e.height=this.chooseone.height,e.background=!0,e.borderColor=6513507,e.backgroundColor=7434694,e.x=this.chooseone.x,e.y=this.chooseone.y,this.sprite.addChild(e)}},i.prototype.touchtwo=function(){if(this.chooseText[1]){this.choosetwo.text="";var e=new egret.TextField;e.text=this.chooseText[1],e.textAlign=egret.HorizontalAlign.CENTER,e.size=30,e.lineSpacing=10,e.border=!0,e.width=this.choosetwo.width,e.height=this.choosetwo.height,e.background=!0,e.borderColor=6513507,e.backgroundColor=7434694,e.x=this.choosetwo.x,e.y=this.choosetwo.y,this.sprite.addChild(e),this.confirmButton.visible=!0,this.confirmText.visible=!0}},i.prototype.rightNext=function(){var t=this;base.API.Init("http://work.metatype.cn:8105/api/"),base.API.call("save_players_process",{inviter_name:t.inviter,game_secret:t.game_secret,player:t.player,game_name:t.gameName,process:"3.0"}).then(function(i){if(t.stage){var r=t.game_secret,a=t.inviter,n=t.player,o=t.gameName,s=t.stageWidth,h=t.stageHeight,c=0;t.characterList.push(t.playerList),t.characterList.push(t.allcharacterlist),console.log("22222222"),console.log(t.characterList),console.log("111111111"),t.timer.stop();var l=[],g=[],d=[],p=[];t.playerList.forEach(function(e,i,r){e==n?(l.push(e),l.push(t.allcharacterlist[i])):(d.push(e),p.push(t.allcharacterlist[i]))}),g.push(d),g.push(p),l.push(g),console.log(l);var u=new e.Character(r,a,n,o,s,h,c,t.characterList,l);t.stage.addChild(u),t.sprite.visible=!1,t.rightIcon.visible=!1}})},i.prototype.getPlayerCharacterList=function(){var t=this;base.API.Init("http://work.metatype.cn:8105/api/"),base.API.call("get_player_characterlist",{game_secret:t.game_secret,inviter:t.inviter,player:t.player,gameName:t.gameName}).then(function(i){var r=i.data;console.log(r),r.forEach(function(i,r,a){var n=i[0];if(console.log("player2"),console.log(n),n==t.player&&(t.select_list=i[1],console.log(t.select_list),t.sprite.addChild(t.rightIcon),t.playerCharacterList=i[1]),-1==t.playerList.indexOf(n)){t.count++;var o=new e.TensionScale(t.stageWidth,t.stageHeight,i[1],0,0,0,0);t.allcharacterlist.push(i[1]),t.sprite.addChild(o),o.x=t.stageWidth-200,o.y=150*t.count,t.playerList.push(n)}})})},i.prototype.drawTitleBackground=function(){var e=this.titleBackground;e.graphics.beginFill(3514259,.5),e.graphics.drawRect(0,0,this.stageWidth,130),e.graphics.endFill()},i.prototype.createTitle=function(){var e=new egret.TextField;e.text="Task: screen through the list and name the twosomes of formative tensions that unite, seperate and define the organizing dynamics in your team.",e.size=25,e.width=this.stageWidth,e.x=320-e.textWidth/2,e.y=50,this.sprite.addChild(e)},i.prototype.drawSplitLine=function(){var e=new egret.Shape;e.graphics.lineStyle(2,16777215),e.graphics.moveTo(400,this.stageHeight),e.graphics.lineTo(400,130),e.graphics.endFill(),this.sprite.addChild(e)},i.prototype.getCharacterList=function(){base.API.Init("http://work.metatype.cn:8105/api/");var e=this;base.API.call("get_character_list",{}).then(function(t){var i=this;e.unselectedCharacterList=t.characters,e.unselectedCharacterList.forEach(function(t,r,a){var n=new egret.TextField;n.text=t,n.textAlign=egret.HorizontalAlign.CENTER,n.size=30,n.lineSpacing=10,n.touchEnabled=!0,n.width=100,n.border=!0,n.borderColor=65280,n.x=50,n.y=300+50*r,n.background=!0,n.backgroundColor=6513507,e.sprite.addChild(n),18*t.length<100?n.width=100:n.width=18*t.length;n.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){2==e.chooseText.length?(e.chooseText.pop(),e.chooseText.push(n.text),e.select_list.push(n.text)):(e.chooseText.push(n.text),e.select_list.push(n.text),n.backgroundColor=65280,n.alpha=.4,n.touchEnabled=!1)},i),n.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(t){e._touchStatus=!0;var r=t.stageX,a=n.x,o=n.y,s=t.stageY;1!=e.flag1||1!=e.flag2?n.addEventListener(egret.TouchEvent.TOUCH_MOVE,function(t){e._touchStatus&&(n.x=t.stageX-r+a,n.y=t.stageY-s+o),n.y<185&&n.y>170&&n.x>0&&n.x<80?(1==e.flag1?console.log("already have"):e.flag1=1,n.touchEnabled=!1,e.select_list.push(n.text),e.chooseone.text="",1==e.flag1&&1==e.flag2&&(e.confirmText.visible=!0,e.confirmButton.visible=!0)):n.y<185&&n.y>170&&n.x>210&&n.x<280&&(1==e.flag2?console.log("already have"):e.flag2=1,n.touchEnabled=!1,e.select_list.push(n.text),e.choosetwo.text="",1==e.flag1&&1==e.flag2&&(e.confirmText.visible=!0,e.confirmButton.visible=!0))},i):1==e.flag1&&1==e.flag2&&(e.confirmText.visible=!0,e.confirmButton.visible=!0)},i),n.addEventListener(egret.TouchEvent.TOUCH_END,function(t){e._touchStatus=!1,n.removeEventListener(egret.TouchEvent.TOUCH_MOVE,i.mouseMove,i)},i)})})},i.prototype.addTensionScale=function(){var t=this;if((this.select_list.length=2)&&(base.API.Init("http://work.metatype.cn:8105/api/"),base.API.call("save_character_choose",{inviterName:t.inviter,gameSecret:t.game_secret,playerName:t.player,gameName:t.gameName,charaChooser:t.select_list}).then(function(e){t.confirmButton.touchEnabled=!1})),this.stage){var i=new e.TensionScale(this.stageWidth,this.stageHeight,this.select_list,0,0,0,0);console.log(i),this.sprite.addChild(i),i.x=this.stageWidth-200,i.y=150*(this.count+1)}},i}(egret.DisplayObjectContainer);e.CharacterChoosePage=t,__reflect(t.prototype,"game.CharacterChoosePage")}(game||(game={}));var game;!function(e){var t=function(t){function i(e,i,r,a,n,o,s){var h=t.call(this)||this;return h.count=0,h.playerList=[],h.sprite=new egret.Sprite,h.sprite.width=e,h.sprite.height=i,h.addChild(h.sprite),h.nickname=r,alert(r),h.openid=a,h.status=s,h.game_secret=n,h.inviter=o,h.stageWidth=e,h.stageHeight=i,h.label2=new egret.TextField,h.label2.text="be ready friends: ",h.label2.height=30,h.label2.anchorOffsetX=h.label2.width/2,h.label2.anchorOffsetY=h.label2.height/2,h.label2.x=h.stageWidth/2,h.label2.y=h.stageHeight/6,h.label2.background=!0,h.label2.backgroundColor=16777215,h.label2.border=!0,h.label2.borderColor=65280,h.label2.fontFamily="Arial",h.label2.textColor=16711680,h.sprite.addChild(h.label2),"inviter"==s&&(h.label=new egret.TextField,h.label.text="Click on the top right corner to invite friends ",h.label.height=30,h.label.anchorOffsetX=h.label.width/2,h.label.anchorOffsetY=h.label.height/2,h.label.x=h.stageWidth/2,h.label.y=h.stageHeight/10,h.label.background=!0,h.label.backgroundColor=16777215,h.label.border=!0,h.label.borderColor=65280,h.label.fontFamily="Arial",h.label.textColor=16711680,h.sprite.addChild(h.label),h.label3=new egret.TextField,h.label3.text="play game",h.label3.height=30,h.label3.width=180,h.label3.anchorOffsetX=h.label3.width/2,h.label3.anchorOffsetY=h.label3.height/2,h.label3.x=h.stageWidth/2,h.label3.y=h.stageHeight/1.5,h.label3.background=!0,h.label3.backgroundColor=16777215,h.label3.border=!0,h.label3.borderColor=65280,h.label3.touchEnabled=!0,h.label3.fontFamily="Arial",h.label3.textColor=16711680,h.label3.addEventListener(egret.TouchEvent.TOUCH_BEGIN,h.onTouchBegin,h),h.sprite.addChild(h.label3),h.invateFriends()),h.timer=new egret.Timer(1e3,0),h.timer.addEventListener(egret.TimerEvent.TIMER,h.getPlayeList,h),h.timer.start(),h}return __extends(i,t),i.prototype.getPlayeList=function(){var t=this;base.API.Init("http://work.metatype.cn:8105/api/"),base.API.call("getPlayerList",{inviter_name:t.inviter,game_secret:t.game_secret,gameName:t.game_secret}).then(function(e){var i=e.result;i.forEach(function(e,i,r){var a=new egret.TextField;a.text=e,a.textAlign=egret.HorizontalAlign.CENTER,a.size=30,a.lineSpacing=10,a.touchEnabled=!0,a.border=!0,20*e.length<100?a.width=100:a.width=18*e.length,a.borderColor=65280,a.x=70,a.y=300+50*i,t.sprite.addChild(a)})}),base.API.call("getGameStatus",{inviter_name:t.inviter,game_secret:t.game_secret,gameName:t.game_secret,openid:t.openid,nickname:t.nickname}).then(function(i){var r=i.result;if(0==r){t.inviter,t.game_secret,t.game_secret;t.timer.stop();var a=new e.GamePageOne(t.game_secret,t.inviter,t.nickname,t.game_secret,t.stage.stageWidth,t.stage.stageHeight);t.stage.addChild(a),t.sprite.visible=!1}})},i.prototype.invateFriends=function(){var e=window.location.href,t="http://ark.metatype.cn/index.html?game_id="+this.openid+"&inviter="+this.nickname;base.API.Init("http://work.metatype.cn:8105/api/");var i=this;base.API.call("wechatapi",{url:e}).then(function(e){var r=new BodyConfig;r.debug=!0,r.appId=e.params.appId,r.timestamp=e.params.timestamp,r.nonceStr=e.params.nonceStr,r.jsApiList=e.params.jsApiList,r.signature=e.params.signature,wx&&(wx.config(r),wx.ready(function(){var e="your friend "+i.nickname+" invite you to join the game";wx.onMenuShareAppMessage({title:"ARK",desc:e,link:t,imgUrl:"",type:"",dataUrl:"",trigger:function(){},success:function(e){alert("分享完成")},cancel:function(){alert("淘气了哦，你取消分享"),console.log("cancel")},fail:function(e){console.log(e),console.log("fail")}})}),wx.error(function(e){console.log("error"),console.log(e)}))})["catch"](function(e){console.log(e)})},i.prototype.onTouchBegin=function(){var t=this.inviter,i=this.game_secret,r=this.game_secret;base.API.Init("http://work.metatype.cn:8105/api/"),base.API.call("create_game",{inviter:t,gameName:i,game_id:r}).then(function(e){});var a=new e.GamePageOne(this.game_secret,this.inviter,this.inviter,this.game_secret,this.stage.stageWidth,this.stage.stageHeight);this.stage.addChild(a),this.sprite.visible=!1,this.timer.stop()},i.prototype.onTouchEnd=function(){egret.log("onTouchEnd")},i.prototype.onTouchMove=function(){egret.log("onTouchMove")},i.prototype.onTouchTap=function(){egret.log("onTouchTap")},i}(egret.DisplayObjectContainer);e.CreateGame=t,__reflect(t.prototype,"game.CreateGame")}(game||(game={}));var game;!function(e){var t=function(t){function i(e,i,r,a,n){var o=t.call(this)||this;o.count=0,o.playerList=[],o.game_secret="",o.gameName="",o.isPlayer=0,o.inviter="",o.player="",o.allcharacterlist=[],o.playerCount=0,o.characterList=[],o.stageWidth=0,o.stageHeight=0,o.game_secret=e,o.gameName=i,o.inviter=r,o.sprite=new egret.Sprite,o.stageHeight=n,o.stageWidth=a,o.sprite.width=a,o.sprite.height=n,o.addChild(o.sprite);var s=new egret.Shape;s.graphics.beginFill(16774638),s.graphics.drawRect(0,0,300,50),s.graphics.endFill(),s.x=o.sprite.width/2+80,s.y=o.sprite.height/3,s.anchorOffsetX=s.width/2,s.anchorOffsetY=s.height/2,o.sprite.addChild(s);var h=new egret.Shape;h.graphics.beginFill(16774638),h.graphics.drawRect(0,0,300,50),h.graphics.endFill(),h.x=o.sprite.width/2+80,h.y=o.sprite.height/3-100,h.anchorOffsetX=h.width/2,h.anchorOffsetY=h.height/2,o.sprite.addChild(h),o.txInput2=new egret.TextField,o.txInput2.type=egret.TextFieldType.INPUT,o.txInput2.inputType=egret.TextFieldInputType.TEXT,o.txInput2.width=290,o.txInput2.height=50,o.txInput2.x=o.sprite.width/2+80,o.txInput2.y=o.sprite.height/3-100,o.txInput2.anchorOffsetX=o.txInput2.width/2,o.txInput2.anchorOffsetY=o.txInput2.height/2,o.txInput2.textColor=855309,o.txInput2.size=40;var c=new egret.TextField;c.text="input password:",c.x=o.sprite.width/2-320,c.y=o.sprite.height/3-118,c.size=30,o.sprite.addChild(c),o.sprite.addChild(o.txInput2),o.txInput=new egret.TextField,o.txInput.type=egret.TextFieldType.INPUT,o.txInput.inputType=egret.TextFieldInputType.TEXT,o.txInput.width=290,o.txInput.height=50,o.txInput.x=o.sprite.width/2+80,o.txInput.y=o.sprite.height/3,o.txInput.anchorOffsetX=o.txInput.width/2,o.txInput.anchorOffsetY=o.txInput.height/2,o.txInput.textColor=855309,o.txInput.size=40;var l=new egret.TextField;l.text="input your name:",l.x=o.sprite.width/2-320,l.y=o.sprite.height/3-18,l.size=30,o.sprite.addChild(l),o.sprite.addChild(o.txInput);var g=new egret.Shape;g.graphics.beginFill(52224),g.graphics.drawRect(0,0,200,50),g.graphics.endFill(),g.x=o.sprite.width/2,g.y=o.sprite.height/2,g.anchorOffsetX=g.width/2,g.anchorOffsetY=g.height/2,g.touchEnabled=!0,g.addEventListener(egret.TouchEvent.TOUCH_BEGIN,o.onTouchBegin,o),o.sprite.addChild(g);var d=new egret.TextField;return d.text="play",d.anchorOffsetX=d.width/2,d.anchorOffsetY=d.height/2,d.x=o.sprite.width/2,d.y=o.sprite.height/2,o.sprite.addChild(d),o.text2=new egret.TextField,o.text2.text="please input your name and the game's secret",o.text2.width=a,o.sprite.addChild(o.text2),o}return __extends(i,t),i.prototype.onTouchBegin=function(){var t=this.txInput.text;this.player=t;var i=this.txInput2.text;console.log("player:"+t);var r=this;t&&i?(base.API.Init("http://work.metatype.cn:8105/api/"),base.API.call("find_players",{game_secret:r.game_secret,gameName:r.gameName}).then(function(a){var n=a.player_list,o=n.indexOf(r.txInput.text);i!=r.game_secret?r.text2.text="please input the correct password to enter the game":-1==o?r.text2.text="you aren't invited !":r.stage&&base.API.call("get_players_process",{game_secret:r.game_secret,inviter_name:r.inviter,player:t,gameName:r.gameName}).then(function(a){console.log(a);var n=a.process,o=a.playercount,s=a.processson;if(r.playerCount=o,"2.0"==n){var h=new e.CharacterChoosePage(i,r.inviter,t,r.gameName,r.stage.stageWidth,r.stage.stageHeight,o);r.stage.addChild(h),r.sprite.visible=!1}else if("3"==n){var c=r,l=0;base.API.call("get_player_characterlist",{game_secret:c.game_secret,inviter:c.inviter,player:c.player,gameName:c.gameName}).then(function(t){var i=t.data;console.log(i);var a=[];i.forEach(function(e,t,i){var a=e[0];-1==r.playerList.indexOf(a)&&(l++,c.allcharacterlist.push(e[1]),c.playerList.push(a))}),console.log("character_list"),a.push(c.playerList),a.push(c.allcharacterlist);var n=[],o=[],h=[],g=[];r.playerList.forEach(function(e,t,i){e==c.player?(n.push(e),n.push(c.allcharacterlist[t])):(h.push(e),g.push(c.allcharacterlist[t]))}),o.push(h),o.push(g),n.push(o),console.log(n);var d=c.game_secret,p=c.inviter,u=c.player,m=c.gameName,f=c.stage.stageWidth,v=c.stage.stageHeight,y=s,x=new e.Character(d,p,u,m,f,v,y,a,n);c.stage.addChild(x),c.sprite.visible=!1})}else if("4"==n){var c=r,l=0;base.API.call("get_player_characterlist",{game_secret:c.game_secret,inviter:c.inviter,player:c.player,gameName:c.gameName}).then(function(a){var n=a.data,s=[];n.forEach(function(e,t,i){var a=e[0];-1==r.playerList.indexOf(a)&&(l++,c.allcharacterlist.push(e[1]),c.playerList.push(a))}),l==o&&(console.log("character_list"),s.push(c.playerList),s.push(c.allcharacterlist));var h=new e.TensionScaleResult(c.stage.stageWidth,c.stage.stageHeight,c.inviter,i,t,c.gameName,s,o);c.stage.addChild(h),c.sprite.visible=!1})}else{var g=new e.GamePageOne(i,r.inviter,t,r.gameName,r.stage.stageWidth,r.stage.stageHeight);r.stage.addChild(g),r.sprite.visible=!1}}),r.isPlayer=o})["catch"](function(e){console.log(e)})):this.text2.text="you must input your name and the game's secret"},i.prototype.onTouchEnd=function(){egret.log("onTouchEnd")},i.prototype.onTouchMove=function(){egret.log("onTouchMove")},i.prototype.onTouchTap=function(){egret.log("onTouchTap")},i}(egret.DisplayObjectContainer);e.EnterGame=t,__reflect(t.prototype,"game.EnterGame")}(game||(game={}));var game;!function(e){var t=function(t){function i(e,i,r,a,n,o,s,h,c,l,g){var d=t.call(this)||this;return d.stageWidth=0,d.stageHeight=0,d._x=20,d._width=230,d.character1="",d.character2="",d.playerName="",d.selfPerception=0,d.individualTensionScale=[],d.individualTensionScaleMedian=0,d.deviationBetweenITSM_SP=0,d.teamTensionScaleMedian=0,d.zoraMin=0,d.lowest=0,d.highest=0,d.count=0,d.median=0,d.votedScalesNumber=1,d.scalesNumber=7,d.stageWidth=e,d.stageHeight=i,d.character1=r,d.character2=a,d.playerName=n,d.selfPerception=o,d.game_secret=s,d.inviter=h,d.gameName=c,d.chooser=l,d.scorecount=g,d.sprite=new egret.Sprite,d.sprite.addEventListener(egret.Event.ADDED_TO_STAGE,d.tensionScale,d),d.addChild(d.sprite),d.character1Sprite=new egret.TextField,d.character2Sprite=new egret.TextField,d.itsm_Deviation=new egret.TextField,d.individualTensionScaleMedianPlayerName=new egret.TextField,d.sprite.addChild(d.character1Sprite),d.sprite.addChild(d.character2Sprite),d.sprite.addChild(d.itsm_Deviation),d.sprite.addChild(d.individualTensionScaleMedianPlayerName),d.zora=new egret.TextField,d.sprite.addChild(d.zora),d.zoraMedianLine=new egret.Shape,d.sprite.addChild(d.zoraMedianLine),d.initSprite(),d.timer=new egret.Timer(1e3,0),d.timer.addEventListener(egret.TimerEvent.TIMER,d.getttsm,d),d.timer.start(),d.rightIcon(),d.tiptext=new egret.TextField,d.noticetext=new egret.TextField,d.sprite.addChild(d.noticetext),d.sprite.addChild(d.tiptext),d.tip(),d.notice2(),d
}return __extends(i,t),i.prototype.initSprite=function(){var e=this.character1Sprite;e.text=this.character1,e.x=this._x,e.width=this._width,e.textAlign=egret.HorizontalAlign.CENTER,e.border=!0,e.borderColor=0,e.background=!0,e.backgroundColor=5480339;var t=this.character2Sprite;t.text=this.character2,t.x=this._x,t.y=840,t.width=this._width,t.textAlign=egret.HorizontalAlign.CENTER,t.border=!0,t.borderColor=0,t.background=!0,t.backgroundColor=5480339;var i=new egret.Shape;i.graphics.lineStyle(2,11149824),i.graphics.moveTo(this._x+e.width/2,e.height),i.graphics.lineTo(this._x+t.width/2,t.y),i.graphics.endFill(),this.sprite.addChild(i);var r=this.zora;r.x=this._x,r.width=230,r.border=!0,r.background=!0,r.backgroundColor=13356134;var a=this.zoraMedianLine;a.graphics.lineStyle(5,3355443),a.graphics.moveTo(this._x,0),a.graphics.lineTo(250,0),a.graphics.endFill();var n=this.itsm_Deviation;n.text=this.individualTensionScaleMedian.toString()+"/"+this.deviationBetweenITSM_SP.toString(),n.textColor=0,n.x=this._x+this.character1Sprite.width/2,n.y=this.individualTensionScaleMedian/81*810-n.height/2,n.width=100,n.textAlign=egret.HorizontalAlign.CENTER,n.border=!0,n.borderColor=0,n.background=!0,n.backgroundColor=16777215;var o=this.individualTensionScaleMedianPlayerName;o.text=this.playerName,o.textColor=0,o.x=n.x-o.width,o.y=this.individualTensionScaleMedian/81*810-o.height/2,o.width=100,o.textAlign=egret.HorizontalAlign.CENTER,o.border=!0,o.borderColor=0},i.prototype.getttsm=function(){var e=this;base.API.Init("http://work.metatype.cn:8105/api/"),base.API.call("getttsmindividual",{inviter_name:e.inviter,game_secret:e.game_secret,player:e.playerName,gameName:e.gameName,c1:e.character1,c2:e.character2,chooser:e.chooser}).then(function(t){console.log("ttsm"),console.log(t),e.teamTensionScaleMedian=t.ttsm,e.individualTensionScale=t.individualTensionScale,e.playerCount=t.playerCount,e.votedScalesNumber=e.individualTensionScale.length+1,e.noticetext.text=Math.ceil(e.votedScalesNumber/e.playerCount*100).toString()+"% of your Teammates ("+e.votedScalesNumber.toString()+" out of "+e.playerCount+") have so far voted the "+e.character1+" & "+e.character2+"Tension Scale. Here are Early Insights:",e.tensionScale()})},i.prototype.notice=function(){var e=new egret.TextField;e.text="54% of your Teammates (7 out of 13) have so far voted the Carefulness & Power Tension Scale. Here are Early Insights:",e.width=600,e.x=-350,e.y=-130,e.background=!0,e.backgroundColor=3514259,this.sprite.addChild(e)},i.prototype.notice2=function(){var e=this.noticetext;e.width=600,e.x=-350,e.y=-130,e.background=!0,e.backgroundColor=3514259},i.prototype.tip2=function(){var e=this.tiptext;e.text="",e.width=350,e.x=-350,e.y=80,e.background=!0,e.backgroundColor=3514259,this.sprite.addChild(e)},i.prototype.tip=function(){var e=new egret.TextField;e.text="• Your Self-Perception at 6 points is inside the preliminary Zone of Responsible Action.\n\n• Your teammates rank you at 46 a total of 40 points higher than your self-perception at 6 points.\n\n• While 21 points is the lowest and 70 points the highest value that others attributed to you.\n\n• Thus 71% of your relationships on this scale are tense.",e.width=350,e.x=-350,e.y=-10,e.background=!0,e.backgroundColor=3514259,this.sprite.addChild(e)},i.prototype.rightIcon=function(){var e=new egret.Bitmap(RES.getRes("right_png"));e.width=100,e.height=100,e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height/2,e.x=140,e.y=this.stageHeight-230,e.touchEnabled=!0,e.addEventListener(egret.TouchEvent.TOUCH_TAP,this.nextTouch,this),this.sprite.addChild(e)},i.prototype.nextTouch=function(){var t="1",i="1";this.timer.stop();var r=new e.KeepUpVoting(this.stageWidth,this.stageHeight,t,i,this.inviter,this.game_secret,this.playerName,this.gameName,this.scorecount);this.stage.addChild(r),this.sprite.visible=!1},i.prototype.tensionScale=function(){var e=this,t=this.teamTensionScaleMedian;console.log(t);var i=10*t-2.5,r=t-13;this.zoraMin=r;var a=t+13,n=10*r,o=10*a,s=this.zora;s.height=o-n,s.y=n,this.sprite.setChildIndex(s,0),this.zoraMedianLine.y=i;var h=new egret.TextField;h.text=this.selfPerception.toString(),h.textColor=0,h.x=this._x+this.character1Sprite.width/2,h.y=this.selfPerception/81*810-h.height/2,h.width=70,h.textAlign=egret.HorizontalAlign.CENTER,h.border=!0,h.borderColor=0,h.background=!0,h.backgroundColor=16777215,(r>this.selfPerception||this.selfPerception>a)&&(h.backgroundColor=13408562),this.sprite.addChild(h);var c=new egret.TextField;c.text=this.playerName,c.textColor=0,c.x=h.x-c.width,c.y=this.selfPerception/81*810-c.height/2,c.width=100,c.textAlign=egret.HorizontalAlign.CENTER,c.border=!0,c.borderColor=0,18*this.playerName.length<100?(c.width=100,c.x=h.x-c.width):(c.width=18*this.playerName.length,c.x=h.x-c.width),this.sprite.addChild(c),this.individualTensionScale.length>0&&(console.log(this.individualTensionScale),this.individualTensionScaleMedian=Math.round(this.individualTensionScale.reduce(function(e,t){return t+=e})/this.individualTensionScale.length),this.deviationBetweenITSM_SP=this.selfPerception-this.individualTensionScaleMedian);var l=this.itsm_Deviation;l.text=this.individualTensionScaleMedian.toString()+"/"+this.deviationBetweenITSM_SP.toString(),l.y=this.individualTensionScaleMedian/81*810-l.height/2,(r>this.individualTensionScaleMedian||this.individualTensionScaleMedian>a)&&(l.backgroundColor=16711475),this.sprite.addChild(l);var g=this.individualTensionScaleMedianPlayerName;g.text=this.playerName,g.x=l.x-g.width,g.y=this.individualTensionScaleMedian/81*810-g.height/2,18*this.playerName.length<100?(g.width=100,g.x=l.x-g.width):(g.width=18*this.playerName.length,g.x=l.x-g.width),this.individualTensionScale.forEach(function(t,i,n){var o=new egret.TextField;o.text=e.individualTensionScale[i].toString(),o.x=e._x+e.character1Sprite.width/2,o.y=e.individualTensionScale[i]/81*810-o.height/2,o.width=70,o.textAlign=egret.HorizontalAlign.CENTER,o.textColor=0,o.border=!0,o.borderColor=0,o.background=!0,o.backgroundColor=16777215,i%2==0&&(o.x=e._x+e.character1Sprite.width/2-o.width),(r>e.individualTensionScale[i]||e.individualTensionScale[i]>a)&&(o.backgroundColor=13408562),e.sprite.addChild(o)});var d=this.individualTensionScale;d.sort();var p=(d.pop(),d.shift(),0);this.individualTensionScale.forEach(function(e,t,i){p+=e},0);Math.ceil(p/this.playerCount)},i}(egret.DisplayObjectContainer);e.ExpandedTensionScale=t,__reflect(t.prototype,"game.ExpandedTensionScale")}(game||(game={}));var game;!function(e){var t=function(t){function i(i,r,a,n,o,s){var h=t.call(this)||this;h.playerList=[],h.game_secret="",h.player="",h.gameName="",h.inviter="",h.stageWidth=0,h.stageHeight=0,h.characterTwo="Fully",h.characterOne="Insufficiently",h._touchStatus=!1,h._distance=new egret.Point,h.characterList=[],h.map={},h.playerSCore="",h.game_secret=i,h.player=a,h.gameName=n,h.inviter=r,h.stageWidth=o,h.stageHeight=s,h.sprite=new egret.Sprite,h.sprite.width=o,h.sprite.height=s,h.sprite.x=0,h.sprite.y=0,h.addChild(h.sprite),h.sprite.addEventListener(egret.Event.ADDED_TO_STAGE,h.getPlayList,h),h.clickTip(),h.rectShapeOne=new egret.Shape,h.rectShapeTwo=new egret.Shape,h.sprite.addChild(h.rectShapeOne),h.sprite.addChild(h.rectShapeTwo),h.drawRect();var c=new egret.TextField;c.text="Insufficiently",c.textAlign=egret.HorizontalAlign.CENTER,c.size=40,c.border=!0,c.width=280,c.borderColor=3825613,c.x=o-390,c.y=200,h.sprite.addChild(c),h._shape=new egret.Shape,h.addChild(h._shape),h.initGraphics(),h.charater2=new egret.TextField,h.sprite.addChild(h.charater2),h.initCharacter(o-390,h.stageHeight-150),h.rightIcon=new egret.Bitmap(RES.getRes("right_png")),h.rightIcon.width=100,h.rightIcon.height=100,h.rightIcon.anchorOffsetX=h.rightIcon.width/2,h.rightIcon.anchorOffsetY=h.rightIcon.height/2,h.rightIcon.x=o-50,h.rightIcon.y=s/2,h.rightIcon.touchEnabled=!0,h.rightIcon.visible=!1,h.addChild(h.rightIcon),h.rightIcon.addEventListener(egret.TouchEvent.TOUCH_BEGIN,h.nextTouch,h),h.closeIcon=new egret.Bitmap(RES.getRes("close-circle_png")),h.closeIcon.width=40,h.closeIcon.height=40,h.closeIcon.anchorOffsetX=h.closeIcon.width/2,h.closeIcon.anchorOffsetY=h.closeIcon.height/2,h.closeIcon.x=o-30,h.closeIcon.y=150,h.closeIcon.touchEnabled=!0,h.closeIcon.addEventListener(egret.TouchEvent.TOUCH_BEGIN,h.closeTip,h),h.addChild(h.closeIcon),h.tiptext=new egret.TextField,h.addChild(h.tiptext);var l=" The ARK is serving the cause of tapping into your teams‘ full potential. Your first task: ANONY- MOUSLY rank your team on this Potentiality Sca- le from 1 to 81.";h.tip(1,50,l,30);var g=new e.ProcessBar(o,s,5,"Inititate > Potential Scale");return h.sprite.addChild(g),h}return __extends(i,t),i.prototype.closeTip=function(){this.tiptext.parent&&this.removeChild(this.tiptext)},i.prototype.nextTouch=function(){if(this.stage){var t=this;console.log(t.player),console.log(t.playerSCore),console.log(t.game_secret),base.API.Init("http://work.metatype.cn:8105/api/"),base.API.call("firstvote",{score:t.playerSCore,game_secret:t.game_secret,inviter_name:t.inviter,player:t.player,gameName:t.gameName}).then(function(e){console.log(e)});var i=t.game_secret,r=t.inviter,a=t.player,n=t.gameName,o=t.stageWidth,s=t.stageHeight,h=t.playerSCore,c=t.playerList.length,l=new e.InitiatePartialInsights(i,r,a,n,o,s,c,h);this.sprite.visible=!1,this.removeChild(t.rightIcon),this.removeChild(t.closeIcon),this.closeTip(),this._shape.visible=!1,this.stage.addChild(l)}},i.prototype.tip=function(e,t,i,r){var a=this.tiptext;a.x=e,a.y=t,a.text=i,a.size=r,a.width=this.stageWidth},i.prototype.clickTip=function(){var e=new egret.TextField;e.text="Drag & Drop your Icon on the scale as you see fit. The question: In retrospective, to what extent does your team tap into its full POTENTIAL...",e.width=250,e.x=30,e.y=450,e.background=!0,e.backgroundColor=3514259,this.sprite.addChild(e)},i.prototype.drawRect=function(){var e=this.rectShapeOne;e.graphics.beginFill(3514259,.5),e.graphics.drawRect(0,0,this.stageWidth+60,180),e.graphics.endFill();var t=this.rectShapeTwo;t.graphics.beginFill(3514259,.5),t.graphics.drawRect(0,this.stageHeight-100,this.stageWidth+60,200),t.graphics.endFill()},i.prototype.initGraphics=function(){var e=this._shape;e.graphics.lineStyle(2,16711935),e.graphics.moveTo(this.stageWidth-250,this.stageHeight-150),e.graphics.lineTo(this.stageWidth-250,240)},i.prototype.initCharacter=function(e,t){var i=this.charater2;i.text="Fully",i.textAlign=egret.HorizontalAlign.CENTER,i.size=40,i.border=!0,i.width=280,i.borderColor=3825613,i.x=e,i.y=t},i.prototype.getPlayList=function(){base.API.Init("http://work.metatype.cn:8105/api/");var e=this;base.API.call("get_player_list",{game_secret:e.game_secret,gameName:e.gameName,inviter:e.inviter}).then(function(t){var i=this;e.playerList=t.player_list,console.log(e.playerList),e.playerList.forEach(function(t,r,a){if(t==e.player){var n=new egret.TextField;n.text=t,n.textAlign=egret.HorizontalAlign.CENTER,n.size=30,n.lineSpacing=10,n.touchEnabled=!0,n.border=!0,18*t.length<100?n.width=100:n.width=18*t.length,n.borderColor=65280,n.x=70,n.y=300+50*r;var o=new egret.TextField;o.text="",o.size=30,o.border=!0,o.width=50,o.borderColor=65280,o.textAlign=egret.HorizontalAlign.CENTER,n.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(t){e._touchStatus=!0;var r=t.stageX,a=n.x,s=n.y,h=t.stageY;n.addEventListener(egret.TouchEvent.TOUCH_MOVE,function(t){if(e._touchStatus){n.x=t.stageX-r+a,n.y=t.stageY-h+s,o.parent&&o.parent.removeChild(o);var i=100;if(n.width>100&&(i=n.width),n.x>e.stageWidth-250-i&&(n.x=e.stageWidth-250-i,n.y>240&&n.y<e.stageHeight-150-n.height)){o.x=n.x+i,o.y=n.y;var c=(e.stageHeight-150-240-n.height)/81;o.text=Math.ceil((o.y-240)/c).toString(),e.sprite.addChild(o);var l=Math.ceil((o.y-240)/c).toString();e.playerSCore=l;var g=n.text;e.map[g]=l,e.rightIcon.visible=!0}n.y>e.stageHeight-150-n.height&&(n.y=e.stageHeight-150-n.height)}},i)},i),n.addEventListener(egret.TouchEvent.TOUCH_END,function(t){e._touchStatus=!1,n.removeEventListener(egret.TouchEvent.TOUCH_MOVE,i.mouseMove,i)},i),e.sprite.addChild(n)}})})},i}(egret.DisplayObjectContainer);e.GamePageOne=t,__reflect(t.prototype,"game.GamePageOne")}(game||(game={}));var game;!function(e){var t=function(t){function i(e,i,r,a){var n=t.call(this)||this;return n.game_list=[],n.stageWidth=0,n.stageHeight=0,n.stageWidth=e,n.stageHeight=i,n.sprite=new egret.Sprite,n.addChild(n.sprite),n.sprite.touchEnabled=!0,n.nickname=r,n.openid=a,n.label=new egret.TextField,n.label.text="start",n.label.height=30,n.label.width=80,n.label.anchorOffsetX=n.label.width/2,n.label.anchorOffsetY=n.label.height/2,n.label.x=n.stageWidth/2,n.label.y=n.stageHeight/2,n.label.touchEnabled=!0,n.label.background=!0,n.label.backgroundColor=16777215,n.label.border=!0,n.label.borderColor=65280,n.label.fontFamily="Arial",n.label.textColor=16711680,n.label.addEventListener(egret.TouchEvent.TOUCH_BEGIN,n.onTouchBegin,n),n.sprite.addChild(n.label),n}return __extends(i,t),i.prototype.onTouchBegin=function(){if(base.API.Init("http://work.metatype.cn:8105/api/"),base.API.call("create_game",{inviter:this.nickname,gameName:this.openid,game_id:this.openid}).then(function(e){})["catch"](function(e){}),this.stage){var t=new e.CreateGame(this.stage.stageWidth,this.stage.stageHeight,this.nickname,this.openid,this.openid,this.nickname,"inviter");this.stage.addChild(t),this.sprite.visible=!1}},i.prototype.onTouchEnd=function(){egret.log("onTouchEnd")},i.prototype.onTouchMove=function(){egret.log("onTouchMove")},i.prototype.onTouchTap=function(){egret.log("onTouchTap")},i}(egret.DisplayObjectContainer);e.Index=t,__reflect(t.prototype,"game.Index")}(game||(game={}));var Main=function(e){function t(){var t=e.call(this)||this;return t.addEventListener(egret.Event.ADDED_TO_STAGE,t.onAddToStage,t),t}return __extends(t,e),t.prototype.onAddToStage=function(e){egret.lifecycle.addLifecycleListener(function(e){e.onUpdate=function(){}}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()},this.runGame()["catch"](function(e){console.log(e)})},t.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){var e,t;return __generator(this,function(i){switch(i.label){case 0:return[4,this.loadResource()];case 1:return i.sent(),this.createGameScene(),[4,RES.getResAsync("description_json")];case 2:return e=i.sent(),[4,platform.login()];case 3:return i.sent(),[4,platform.getUserInfo()];case 4:return t=i.sent(),console.log(t),[2]}})})},t.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var e,t;return __generator(this,function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),e=new LoadingUI,this.stage.addChild(e),[4,RES.loadConfig("resource/default.res.json","resource/")];case 1:return i.sent(),[4,RES.loadGroup("preload",0,e)];case 2:return i.sent(),this.stage.removeChild(e),[3,4];case 3:return t=i.sent(),console.error(t),[3,4];case 4:return[2]}})})},t.prototype.createGameScene=function(){base.API.Init("http://work.metatype.cn:8105/api/"),console.log("首页");var e=window.location.href;if(console.log(e),-1!=e.indexOf("game_id")){var t=e.split("?")[1].split("&")[0].split("=")[1],i=e.split("?")[1].split("&")[1].split("=")[1];if(-1!=e.indexOf("code")){var r=e.split("?")[1].split("&")[2].split("=")[1],a=this;base.API.call("wechatlogin",{code:r,inviter:i,game_name:t,game_secret:t}).then(function(e){var r=e.result,n=r.openid,o=r.nickname,s=a.stage.stageWidth,h=a.stage.stageHeight;base.API.call("getGameStatus",{inviter_name:i,game_secret:t,gameName:t,openid:n,nickname:o}).then(function(e){var r=e.result;if(0==r){var c=new game.CreateGame(s,h,o,n,t,i,"player");a.stage.addChild(c)}else alert("The game is in progress.")})})}else{var n=encodeURIComponent("http://ark.metatype.cn/index.html?game_id="+t+"&nickname="+i);console.log(n);window.location.href="https://open.weixin.qq.com/connect/oauth2/authorize?appid=wxc7594d7d49e0235f&redirect_uri="+n+"&response_type=code&scope=snsapi_userinfo&state=1"}}else if(-1!=e.indexOf("code")){var r=e.split("?")[1].split("&")[0].split("=")[1];base.API.Init("http://work.metatype.cn:8105/api/");var o=this;base.API.call("wechatlogin",{code:r}).then(function(e){var t=e.result,i=t.openid,r=t.nickname,a=o.stage.stageWidth,n=o.stage.stageHeight,s=new game.Index(a,n,r,i);o.stage.addChild(s)})}else{var n=encodeURIComponent("http://ark.metatype.cn/index.html");window.location.href="https://open.weixin.qq.com/connect/oauth2/authorize?appid=wxc7594d7d49e0235f&redirect_uri="+n+"&response_type=code&scope=snsapi_userinfo&state=1"}},t.prototype.createBitmapByName=function(e){var t=new egret.Bitmap,i=RES.getRes(e);return t.texture=i,t},t.prototype.startAnimation=function(e){var t=this,i=new egret.HtmlTextParser,r=e.map(function(e){return i.parse(e)}),a=this.textfield,n=-1,o=function(){n++,n>=r.length&&(n=0);var e=r[n];a.textFlow=e;var i=egret.Tween.get(a);i.to({alpha:1},200),i.wait(2e3),i.to({alpha:0},200),i.call(o,t)};o()},t}(egret.DisplayObjectContainer);__reflect(Main.prototype,"Main");var game;!function(e){var t=function(t){function i(e,i,r,a,n){var o=t.call(this)||this;o.count=0,o.playerList=[],o.game_secret="",o.inviter="",o.gameName="",o.game_secret=e,o.inviter=i,o.gameName=r,o.sprite=new egret.Sprite,o.sprite.width=a,o.sprite.height=n,o.addChild(o.sprite);var s=new egret.Shape;s.graphics.beginFill(16774638),s.graphics.drawRect(0,0,300,50),s.graphics.endFill(),s.x=o.sprite.width/2+60,s.y=o.sprite.height/3,s.anchorOffsetX=s.width/2,s.anchorOffsetY=s.height/2,o.sprite.addChild(s),o.txInput=new egret.TextField,o.txInput.type=egret.TextFieldType.INPUT,o.txInput.inputType=egret.TextFieldInputType.TEXT,o.txInput.width=290,o.txInput.height=50,o.txInput.x=o.sprite.width/2+60,o.txInput.y=o.sprite.height/3,o.txInput.anchorOffsetX=o.txInput.width/2,o.txInput.anchorOffsetY=o.txInput.height/2,o.txInput.textColor=855309,o.txInput.size=40;var h=new egret.TextField;h.text="input player:",h.x=o.sprite.width/2-280,h.y=o.sprite.height/3-18,h.size=30,o.sprite.addChild(h),o.sprite.addChild(o.txInput);var c=new egret.Shape;c.graphics.beginFill(52224),c.graphics.drawRect(0,0,200,50),c.graphics.endFill(),c.x=o.sprite.width/2,c.y=o.sprite.height/2,c.anchorOffsetX=c.width/2,c.anchorOffsetY=c.height/2,c.touchEnabled=!0,c.addEventListener(egret.TouchEvent.TOUCH_BEGIN,o.onTouchBegin,o),o.sprite.addChild(c);var l=new egret.TextField;l.text="invite",l.anchorOffsetX=l.width/2,l.anchorOffsetY=l.height/2,l.x=o.sprite.width/2,l.y=o.sprite.height/2,o.sprite.addChild(l);var g=new egret.Shape;g.graphics.beginFill(52224),g.graphics.drawRect(0,0,200,50),g.graphics.endFill(),g.x=o.sprite.width/2,g.y=o.sprite.height/2+100,g.anchorOffsetX=c.width/2,g.anchorOffsetY=c.height/2,g.touchEnabled=!0,g.addEventListener(egret.TouchEvent.TOUCH_BEGIN,o.onTouchBegin2,o),o.sprite.addChild(g);var d=new egret.TextField;return d.text="play",d.anchorOffsetX=d.width/2,d.anchorOffsetY=d.height/2,d.x=o.sprite.width/2,d.y=o.sprite.height/2+100,o.sprite.addChild(d),o.text2=new egret.TextField,o.text2.text="You have invited "+o.count+" players",o.text2.width=a,o.sprite.addChild(o.text2),o}return __extends(i,t),i.prototype.invateFriends=function(){var e=new BodyConfig;e.appId="wx4f735f8d65cf5f28",e.debug=!0,wx&&(wx.config(e),wx.ready(function(){console.log(12),wx.checkJsApi({jsApiList:["chooseImage"],success:function(e){console.log(333),console.log(e)}})}))},i.prototype.onTouchBegin=function(){var e=this,t=this.txInput.text;if(t){var i=0;if(this.playerList.forEach(function(r,a,n){console.log(r),r==t&&(e.text2.text="please dont invite the duplicate player !",i=1)}),0==i){this.playerList.push(t),this.count+=1,this.text2.text="You have invited "+this.count+" players";var r=this;base.API.Init("http://work.metatype.cn:8105/api/"),base.API.call("create_player",{player_name:t,game_secret:r.game_secret,gameName:r.gameName,inviter:r.inviter}).then(function(e){console.log(e)})["catch"](function(e){console.log(e)})}}},i.prototype.onTouchBegin2=function(){if(this.playerList.length<2)this.text2.text="You must invite 3 players to start the game at least!";else{var t=this;if(this.stage){var i=new e.GamePageOne(t.game_secret,t.inviter,t.inviter,t.gameName,this.stage.stageWidth,this.stage.stageHeight);this.stage.addChild(i),t.sprite.visible=!1}}},i.prototype.onTouchEnd=function(){egret.log("onTouchEnd")},i.prototype.onTouchMove=function(){egret.log("onTouchMove")},i.prototype.onTouchTap=function(){egret.log("onTouchTap")},i}(egret.DisplayObjectContainer);e.InviteFriends=t,__reflect(t.prototype,"game.InviteFriends")}(game||(game={}));var game;!function(e){var t=function(t){function i(e,i,r,a,n,o,s,h,c){var l=t.call(this)||this;return l.stageWidth=0,l.stageHeight=0,l.game_secret="",l.gameName="",l.inviter="",l.player="",l._width=600,l._x=20,l._margin=20,l.characterListParams=[],l.votedScalesNumber=1,l.scalesNumber=7,l.remainingScalesNumber=l.scalesNumber-l.votedScalesNumber,l.simulatedData1=[],l.simulatedData2=[],l.ttsms=[],l.scorecount=0,l.stageWidth=e,l.stageHeight=i,l.game_secret=o,l.player=s,l.gameName=h,l.inviter=n,l.scorecount=c,console.log("scorecount"),console.log(c),l.sprite=new egret.Sprite,l.addChild(l.sprite),l.noticeBox=new egret.TextField,l.background(),l.sprite.addChild(l.noticeBox),l.initNotice(),l.processBar(),l.timer=new egret.Timer(1e3,0),l.timer.addEventListener(egret.TimerEvent.TIMER,l.getGameResult,l),l.timer.start(),l.rightIcon(),l}return __extends(i,t),i.prototype.initNotice=function(){var e=this.noticeBox;e.textColor=0,e.width=this._width,e.x=this._x,e.y=60,e.background=!0,e.backgroundColor=16763955},i.prototype.processBar=function(){var t=new e.ProcessBar(this.stageWidth,this.stageHeight,55,"Mission 1 > Keep Up Voting");this.sprite.addChild(t)},i.prototype.notice=function(){var e=this.votedScalesNumber.toString(),t=this.scalesNumber.toString(),i=this.remainingScalesNumber.toString();this.noticeBox=new egret.TextField,this.noticeBox.text="Great! You cleared "+e.toString()+" out of "+t.toString()+" Tension Scales. Vote the remaining "+i.toString()+" to finish Mission 1 and discover your teams Zone of Responsible Action!",this.noticeBox.textColor=0,this.noticeBox.width=this._width,this.noticeBox.x=this._x,this.noticeBox.y=60,this.noticeBox.background=!0,this.noticeBox.backgroundColor=16763955,this.sprite.addChild(this.noticeBox)},i.prototype.background=function(){var e=new egret.Shape;e.x=this._x/2,e.y=100,e.graphics.beginFill(13421772,1),e.graphics.drawRect(e.x,e.y,380,this.stageHeight),e.graphics.endFill(),this.sprite.addChild(e);var t=new egret.Shape;t.x=this._x/2+e.width/2+this._margin/2,t.y=100,t.graphics.beginFill(16763955,1),t.graphics.drawRect(t.x,t.y,200,this.stageHeight),t.graphics.endFill(),this.sprite.addChild(t)},i.prototype.getGameResult=function(){var e=this;base.API.Init("http://work.metatype.cn:8105/api/"),base.API.call("getKeepUpVotingData",{inviter_name:e.inviter,game_secret:e.game_secret,player:e.player,gameName:e.gameName}).then(function(t){console.log(t),e.simulatedData1=t.simulatedData1,e.simulatedData2=t.simulatedData2;var i=e.simulatedData2.length,r=i+e.simulatedData1.length,a=e.simulatedData1.length;e.noticeBox.text="Great! You cleared "+i.toString()+" out of "+r.toString()+" Tension Scales. Vote the remaining "+a.toString()+" to finish Mission 1 and discover your teams Zone of Responsible Action!",e.tensionScale()})},i.prototype.tensionScale=function(){var t=this;this.simulatedData1.forEach(function(i,r,a){var n=(i[0],i[1],Number(i[2].toString())),o=Number(i[3].toString()),s=Math.abs(o-n),h=n,c=0,l=new e.TensionScale(100,60,[i[0],i[1]],s,o,c,h);r%2==1?(l.x=25,l.y=210+100*(r-1)):r%2==0&&(l.x=215,l.y=210+100*r),t.sprite.addChild(l)}),this.simulatedData2.forEach(function(i,r,a){var n=(i[0],i[1],Number(i[2].toString())),o=Number(i[3].toString()),s=Number(i[4].toString()),h=0,c=new e.TensionScale(100,60,[i[0],i[1]],o,s,h,n);c.x=430,c.y=210+150*r,t.sprite.addChild(c)})},i.prototype.rightIcon=function(){var e=new egret.Bitmap(RES.getRes("right_png"));e.width=100,e.height=100,e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height/2,e.x=this.stageWidth-50,e.y=this.stageHeight-50,e.touchEnabled=!0,e.addEventListener(egret.TouchEvent.TOUCH_TAP,this.nextTouch,this),this.sprite.addChild(e)},i.prototype.nextTouch=function(){var t=this,i=t.scorecount+1;base.API.Init("http://work.metatype.cn:8105/api/"),base.API.call("getCharacterList",{inviter_name:t.inviter,game_secret:t.game_secret,player:t.player,gameName:t.gameName}).then(function(r){var a=r.characterListParams;if(a[1].length>i){t.timer.stop();var n=new e.Character(t.game_secret,t.inviter,t.player,t.gameName,t.stageWidth,t.stageHeight,t.scorecount+1,a,[]);t.stage.addChild(n),t.sprite.visible=!1}else{var o=a[1].length;console.log("所有性格打分结束"),base.API.call("save_players_process",{inviter_name:t.inviter,game_secret:t.game_secret,player:t.player,game_name:t.gameName,process:"4.0"}).then(function(i){var r=new e.TensionScaleResult(t.stageWidth,t.stageHeight,t.inviter,t.game_secret,t.player,t.gameName,a,o);t.stage.addChild(r),t.sprite.visible=!1}),console.log("结束")}})},i}(egret.DisplayObjectContainer);e.KeepUpVoting=t,__reflect(t.prototype,"game.KeepUpVoting")}(game||(game={}));var game;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.sprite=new egret.Sprite,t.sprite.graphics.beginFill(16711680),t.sprite.graphics.drawRect(0,0,100,100),t.sprite.graphics.endFill(),t.addChild(t.sprite),t.sprite.touchEnabled=!0,t.sprite.addEventListener(egret.TouchEvent.TOUCH_BEGIN,t.onTouchBegin,t),t.sprite.addEventListener(egret.TouchEvent.TOUCH_END,t.onTouchEnd,t),t.sprite.addEventListener(egret.TouchEvent.TOUCH_MOVE,t.onTouchMove,t),t.sprite.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onTouchTap,t),t}return __extends(t,e),t.prototype.onTouchBegin=function(){this.sprite.visible=!1},t.prototype.onTouchEnd=function(){egret.log("onTouchEnd")},t.prototype.onTouchMove=function(){egret.log("onTouchMove")},t.prototype.onTouchTap=function(){egret.log("onTouchTap")},t}(egret.DisplayObjectContainer);e.LoadingScene=t,__reflect(t.prototype,"game.LoadingScene")}(game||(game={}));var game;!function(e){var t=function(e){function t(t,i){var r=e.call(this)||this;return r.stageWidth=0,r.stageHeight=0,r.stageWidth=t,r.stageHeight=i,r.sprite=new egret.Sprite,r.sprite.width=t,r.sprite.height=i,r.addChild(r.sprite),r.tipText(),r}return __extends(t,e),t.prototype.tipText=function(){var e=new egret.TextField,t=new egret.TextField;e.text="Higher numbers indicate bigger tensions between your self-perception & the teams attribution of your position on the scale:",e.size=30,e.x=0,e.y=0,e.width=this.stageWidth,e.background=!0,e.backgroundColor=4951491,t.text="• White values: mark areas of authentic action.            • Values over 13: indicate your dissociative effect on the team‘s organizing dynamics.                  • Red values: mark your self- perception as being outside ZORA.                                                    • Yellow Values: mark your attributed position as being outside ZORA.",t.size=30,t.x=0,t.y=90,t.width=this.stageWidth,t.background=!0,t.backgroundColor=4951491,this.sprite.addChild(e),this.sprite.addChild(t)},t}(egret.DisplayObjectContainer);e.MajorTensionsTip=t,__reflect(t.prototype,"game.MajorTensionsTip")}(game||(game={}));var game;!function(e){var t=function(e){function t(t,i,r,a,n,o,s,h,c,l){return e.call(this)||this}return __extends(t,e),t}(egret.DisplayObjectContainer);e.MissionOneResult=t,__reflect(t.prototype,"game.MissionOneResult")}(game||(game={}));var game;!function(e){var t=function(t){function i(e,i,r,a,n,o,s,h,c,l,g){var d=t.call(this)||this;return d.stageWidth=0,d.stageHeight=0,d._width=600,d._x=20,d.character1="Carefulness",d.character2="Power",d.playerName="Joe",d.selfPerception=6,d.game_secret="",d.gameName="",d.inviter="",d.chooser="",d.scorecount=0,d.stageWidth=e,d.stageHeight=i,d.sprite=new egret.Sprite,d.addChild(d.sprite),d.game_secret=h,d.playerName=n,d.gameName=c,d.inviter=s,d.character1=r,d.character2=a,d.chooser=g,d.selfPerception=o,d.scorecount=l,d.processBar(),d.drawPotentialScale(),d}return __extends(i,t),i.prototype.processBar=function(){var t=new e.ProcessBar(this.stageWidth,this.stageHeight,50,"Mission 1 > Partial Insights");this.sprite.addChild(t)},i.prototype.drawPotentialScale=function(){var t=new e.ExpandedTensionScale(this.stageWidth,this.stageHeight,this.character1,this.character2,this.playerName,this.selfPerception,this.game_secret,this.inviter,this.gameName,this.chooser,this.scorecount);t.x=this._x+350,t.y=180,this.sprite.addChild(t)},i}(egret.DisplayObjectContainer);e.MissionPartialInsights=t,__reflect(t.prototype,"game.MissionPartialInsights")}(game||(game={}));var game;!function(e){var t=function(t){function i(i,r,a,n,o,s,h){var c=t.call(this)||this;c.game_secret="",c.gameName="",c.inviter="",c.player="",c.stageWidth=0,c.stageHeight=0,c.characterListParams=[],c.simulatedData=[],c.ttsms=[],c.stageWidth=i,c.stageHeight=r,c.player=o,c.gameName=s,c.game_secret=n,c.inviter=a,c.characterListParams=h,c.sprite=new egret.Sprite,c.addChild(c.sprite),c.drawTitle(),c.drawResult(),c._shape=new egret.Shape,c.addChild(c._shape),c._shape.alpha=.5;var l=new e.ProcessBar(i,r,100,"Mission 1 > ZORA Map");return c.sprite.addChild(l),console.log("ttsmsstart3:"),console.log(c.ttsms),console.log("ttsmsend3:"),c}return __extends(i,t),i.prototype.getTTSMS=function(){var e=this;base.API.Init("http://work.metatype.cn:8105/api/"),base.API.call("get_ttsm",{characterListParams:e.characterListParams,inviter:e.inviter,gameSecret:e.game_secret,player:e.player,gameName:e.gameName}).then(function(t){var i=t.result;e.ttsms=i,console.log("ttsmsstart1:"),console.log(e.ttsms),console.log("ttsmsend1:")})},i.prototype.initGraphics=function(){var e=this._shape;e.graphics.lineStyle(2,16448210),e.graphics.moveTo(this.stageWidth/2,this.stageHeight),e.graphics.lineTo(this.stageWidth/2,130);var t=this._shape;t.graphics.beginFill(16774799,.5),t.graphics.lineStyle(0),t.graphics.drawRect(this.stageWidth/2-Math.ceil(200/81*13),130,2*Math.ceil(200/81*13),this.stageHeight),t.graphics.endFill()},i.prototype.drawResult=function(){var e=this;base.API.Init("http://work.metatype.cn:8105/api/"),base.API.call("get_game_score",{characterListParams:e.characterListParams,inviter:e.inviter,gameSecret:e.game_secret,player:e.player,gameName:e.gameName}).then(function(t){var i=t.result;e.simulatedData=i;var r=e;base.API.call("get_ttsm",{characterListParams:r.characterListParams,inviter:r.inviter,gameSecret:r.game_secret,player:r.player,gameName:r.gameName}).then(function(t){var i=t.result;r.ttsms=i,console.log("ttsmsstart1:"),console.log(r.ttsms),console.log("ttsmsend1:"),e.drawTensionScale(r.ttsms)}),e.initGraphics()}),console.log(11111111111),console.log(e.simulatedData),console.log(111111111),console.log("ttsmsstart2:"),console.log(e.ttsms),console.log("ttsmsend2:")},i.prototype.drawTensionScale=function(t){var i=this;console.log(this.simulatedData),this.ttsms=t,console.log(this.ttsms),console.log(222222),this.simulatedData.forEach(function(t,r,a){try{var n=i.ttsms[r],o=(t[2].toString(),new e.ZORAMap(t[0],t[1],i.player,t[3],t[2],i.stageWidth,i.stageHeight,n));console.log(o),o.y=200+150*(r-1),i.sprite.addChild(o)}catch(s){}})},i.prototype.drawLine=function(){var e=new egret.Shape;e.graphics.lineStyle(Math.ceil(200/81*13),16711935),e.graphics.moveTo(this.stageWidth/2,this.stageHeight),e.graphics.lineTo(this.stageWidth/2,150),this.sprite.addChild(e)},i.prototype.drawTitle=function(){var e=new egret.Shape;e.graphics.beginFill(3514259,.5),e.graphics.drawRect(0,0,this.stageWidth,130),e.graphics.endFill(),this.sprite.addChild(e);var t=new egret.TextField;t.text="Mission 1 Complete: Here is an image of you in your Team‘s Zone of Responsible Action.",t.size=30,t.width=this.stageWidth,t.x=1,t.y=50,this.sprite.addChild(t)},i}(egret.DisplayObjectContainer);e.MissionResult=t,__reflect(t.prototype,"game.MissionResult")}(game||(game={}));var game;!function(e){var t=function(t){function i(e,i,r,a,n,o){var s=t.call(this)||this;
s.playerList=[],s.game_secret="",s.player="",s.gameName="",s.inviter="",s.stageWidth=0,s.stageHeight=0,s._touchStatus=!1,s._distance=new egret.Point,s.characterList=[],s.characterTwo="Fully",s.characterOne="Insufficiently",s.player_score_list=[],s.player_list=[],s.playerscore=0,s.middle=0,s.game_secret=e,s.player=r,s.gameName=a,s.inviter=i,s.stageWidth=n,s.stageHeight=o,s.sprite=new egret.Sprite,s.sprite.width=n,s.sprite.height=o,s.sprite.x=0,s.sprite.y=0,s.addChild(s.sprite),s.sprite.addEventListener(egret.Event.ADDED_TO_STAGE,s.getPlayScoreList,s),s.rectShapeOne=new egret.Shape,s.rectShapeTwo=new egret.Shape,s.sprite.addChild(s.rectShapeOne),s.sprite.addChild(s.rectShapeTwo),s.drawRect();var h=new egret.TextField;return h.text=s.characterOne,h.textAlign=egret.HorizontalAlign.CENTER,h.size=40,h.border=!0,h.width=280,h.borderColor=3825613,h.x=n-390,h.y=200,s.sprite.addChild(h),s._shape=new egret.Shape,s.addChild(s._shape),s.initGraphics(),s.charater2=new egret.TextField,s.sprite.addChild(s.charater2),s.initCharacter(n-390,s.stageHeight-150),s.rightIcon=new egret.Bitmap(RES.getRes("right_png")),s.rightIcon.width=100,s.rightIcon.height=100,s.rightIcon.anchorOffsetX=s.rightIcon.width/2,s.rightIcon.anchorOffsetY=s.rightIcon.height/2,s.rightIcon.x=n-50,s.rightIcon.y=o/2,s.addChild(s.rightIcon),s.rightIcon.touchEnabled=!0,s.rightIcon.addEventListener(egret.TouchEvent.TOUCH_BEGIN,s.nextTouch,s),s.closeIcon=new egret.Bitmap(RES.getRes("close-circle_png")),s.closeIcon.width=40,s.closeIcon.height=40,s.closeIcon.anchorOffsetX=s.closeIcon.width/2,s.closeIcon.anchorOffsetY=s.closeIcon.height/2,s.closeIcon.x=n-30,s.closeIcon.y=150,s.closeIcon.touchEnabled=!0,s.closeIcon.addEventListener(egret.TouchEvent.TOUCH_BEGIN,s.closeTip,s),s.addChild(s.closeIcon),s.tiptext=new egret.TextField,s.timer=new egret.Timer(1e3,0),s.timer.addEventListener(egret.TimerEvent.TIMER,s.getPlayScoreList,s),s.timer.start(),s.middleScore=new egret.TextField,s.middleScore.textAlign=egret.HorizontalAlign.CENTER,s.middleScore.size=30,s.middleScore.lineSpacing=10,s.middleScore.border=!0,s.middleScore.background=!0,s.middleScore.backgroundColor=8009611,s.middleScore.borderColor=65280,s.middleScore.visible=!1,s.sprite.addChild(s.middleScore),s.middlePlayer=new egret.TextField,s.middlePlayer.textAlign=egret.HorizontalAlign.CENTER,s.middlePlayer.size=30,s.middlePlayer.lineSpacing=10,s.middlePlayer.border=!0,s.middlePlayer.background=!0,s.middlePlayer.borderColor=65280,s.middlePlayer.visible=!1,s.middlePlayer.backgroundColor=7120589,s.sprite.addChild(s.middlePlayer),s}return __extends(i,t),i.prototype.getPlayScoreList=function(){var e=this;base.API.Init("http://work.metatype.cn:8105/api/"),base.API.call("get_player_score",{inviter:this.inviter,gameName:this.gameName,gameSecret:this.game_secret,player:this.player,character_one:this.characterOne,character_two:this.characterTwo,chooser:this.inviter}).then(function(t){e.player_list.forEach(function(t,i,r){var a=new egret.TextField;a.text=t,a.textAlign=egret.HorizontalAlign.CENTER,a.size=30,a.lineSpacing=10,a.touchEnabled=!0,a.border=!0,a.background=!0,a.borderColor=65280,a.alpha=.5;var n=new egret.TextField;n.size=30,n.border=!0,n.background=!0,n.borderColor=57123,n.textAlign=egret.HorizontalAlign.CENTER,n.alpha=.5,t==e.player&&i!=e.player_score_list.length?(e.playerscore=e.player_score_list[i],a.backgroundColor=7120589):a.backgroundColor=6513507,18*t.length<100?a.width=100:a.width=18*t.length;var o=100;a.width>100&&(o=a.width),i%2!=0?(a.x=e.stageWidth-250-o,n.x=a.x-50):(a.x=e.stageWidth-250,n.x=a.x+o);var s=e.player_score_list[i];a.y=s*((e.stageHeight-150-240)/81)+240,e.sprite.addChild(a),n.text=e.player_score_list[i],n.width=50,n.y=a.y,n.backgroundColor=16744228,e.sprite.addChild(n)})})},i.prototype.closeTip=function(){this.tiptext.parent&&this.removeChild(this.tiptext)},i.prototype.nextTouch=function(){if(this.stage){var t=this.game_secret,i=this.inviter,r=this.player,a=this.gameName,n=this.stageWidth,o=this.stageHeight,s=0,h=[];this.characterList=[["zjy","1","2"],[["Loyality","Joy"],["Power","Courage"],["Harmony","Disruption"]]];var c=new e.Character(t,i,r,a,n,o,s,this.characterList,h);this.stage.addChild(c),this.sprite.visible=!1,this.tiptext.text="",this.removeChild(this.rightIcon),this.removeChild(this.closeIcon)}},i.prototype.tip=function(e,t,i,r){var a=this.tiptext;a.x=e,a.y=t,a.text=i,a.size=r,a.width=this.stageWidth},i.prototype.drawRect=function(){var e=this.rectShapeOne;e.graphics.beginFill(16711680,.5),e.graphics.drawRect(0,0,this.stageWidth+60,180),e.graphics.endFill();var t=this.rectShapeTwo;t.graphics.beginFill(16711680,.5),t.graphics.drawRect(0,this.stageHeight-100,this.stageWidth+60,200),t.graphics.endFill()},i.prototype.initGraphics=function(){var e=this._shape;e.graphics.lineStyle(2,16711935),e.graphics.moveTo(this.stageWidth-250,this.stageHeight-150),e.graphics.lineTo(this.stageWidth-250,240)},i.prototype.initCharacter=function(e,t){var i=this.charater2;i.text=this.characterTwo,i.textAlign=egret.HorizontalAlign.CENTER,i.size=40,i.border=!0,i.width=280,i.borderColor=3825613,i.x=e,i.y=t},i.prototype.onTouchEnd=function(){egret.log("onTouchEnd")},i.prototype.onTouchMove=function(){egret.log("onTouchMove")},i.prototype.onTouchTap=function(){egret.log("onTouchTap")},i}(egret.DisplayObjectContainer);e.PageOneResult=t,__reflect(t.prototype,"game.PageOneResult")}(game||(game={}));var game;!function(e){var t=function(e){function t(t,i,r,a,n,o,s,h,c,l,g){var d=e.call(this)||this;return d.stageWidth=0,d.stageHeight=0,d._x=20,d._width=230,d.character1="",d.character2="",d.playerName="",d.selfPerception=0,d.othersSelfPerception=[],d.zoraMin=0,d.lowest=0,d.highest=0,d.count=0,d.median=0,d.stageWidth=t,d.stageHeight=i,d.character1=r,d.character2=a,d.playerName=n,d.selfPerception=o,d.game_secret=s,d.inviter=h,d.player=c,d.gameName=l,d.playerCount=g,d.sprite=new egret.Sprite,d.sprite.addEventListener(egret.Event.ADDED_TO_STAGE,d.potentialScale,d),d.addChild(d.sprite),d.character1Sprite=new egret.TextField,d.character2Sprite=new egret.TextField,d.sprite.addChild(d.character1Sprite),d.sprite.addChild(d.character2Sprite),d._shape=new egret.Shape,d.sprite.addChild(d._shape),d.zora=new egret.TextField,d.sprite.addChild(d.zora),d.zoraMedianLine=new egret.Shape,d.sprite.addChild(d.zoraMedianLine),d.tiptext=new egret.TextField,d.tip(),d.initSprite(),d.timer=new egret.Timer(1e3,0),d.timer.addEventListener(egret.TimerEvent.TIMER,d.getOthersSelfPerception,d),d.timer.start(),d}return __extends(t,e),t.prototype.initSprite=function(){var e=this.character1Sprite;e.text=this.character1,e.x=this._x,e.width=this._width,e.textAlign=egret.HorizontalAlign.CENTER,e.border=!0,e.borderColor=0,e.background=!0,e.backgroundColor=5480339;var t=this.character2Sprite;t.text=this.character2,t.x=this._x,t.y=840,t.width=this._width,t.textAlign=egret.HorizontalAlign.CENTER,t.border=!0,t.borderColor=0,t.background=!0,t.backgroundColor=5480339;var i=new egret.Shape;i.graphics.lineStyle(2,11149824),i.graphics.moveTo(this._x+e.width/2,e.height),i.graphics.lineTo(this._x+t.width/2,t.y),i.graphics.endFill(),this.sprite.addChild(i);var r=this.zora;r.x=this._x,r.width=230,r.border=!0,r.background=!0,r.backgroundColor=13356134;var a=this.zoraMedianLine;a.graphics.lineStyle(5,3355443),a.graphics.moveTo(this._x,0),a.graphics.lineTo(250,0),a.graphics.endFill()},t.prototype.tip=function(){var e=this.tiptext;e.text="",e.width=350,e.x=-350,e.y=80,e.background=!0,e.backgroundColor=3514259,this.sprite.addChild(e)},t.prototype.getOthersSelfPerception=function(){var e=this.othersSelfPerception.length+1;e==this.playerCount&&this.timer.stop();var t=this;base.API.Init("http://work.metatype.cn:8105/api/"),base.API.call("getOthersSelfPerception",{inviter_name:t.inviter,game_secret:t.game_secret,player:t.player,gameName:t.gameName}).then(function(e){t.othersSelfPerception=e.OthersSelfPerceptionList,t.potentialScale(),t.tiptext.text=Math.ceil((t.othersSelfPerception.length+1)/t.playerCount*100).toString()+"% of your Team ("+(t.othersSelfPerception.length+1).toString()+"out of "+t.playerCount.toString()+")) has so far voted the Potential Scale. Invite everyone to follow suit.Here are Early Insights:\n\n• "+t.lowest.toString()+" is the lowest and "+t.highest.toString()+"    the highest value on the Scale.\n• The teams preliminary median is "+t.median.toString()+".\n• The perception of "+t.count.toString()+" people varies remarkably from the team average.",console.log(t.othersSelfPerception)})},t.prototype.potentialScale=function(){var e=this,t=[],i=0;t.push(Number(this.selfPerception)),this.othersSelfPerception.forEach(function(i,r,a){t.push(e.othersSelfPerception[r])});var r=Math.round(t.reduce(function(e,t){return t+=e})/t.length),a=10*r-2.5,n=r-13;this.zoraMin=n;var o=r+13,s=10*n,h=10*o;this.othersSelfPerception.forEach(function(t,r,a){var s=new egret.TextField;s.text=e.othersSelfPerception[r].toString(),s.x=e._x+e.character1Sprite.width/2,s.y=e.othersSelfPerception[r]/81*810-s.height/2,s.width=70,s.textAlign=egret.HorizontalAlign.CENTER,s.textColor=0,s.border=!0,s.borderColor=0,s.background=!0,s.backgroundColor=16776908,r%2==0&&(s.x=e._x+e.character1Sprite.width/2-s.width),(n>e.othersSelfPerception[r]||e.othersSelfPerception[r]>o)&&(s.backgroundColor=16711475,i++),e.sprite.addChild(s)});var c=t.sort();this.lowest=c[0],this.highest=c.pop(),this.median=r,console.log(s),console.log(h);var l=this.zora;l.height=h-s,l.y=s,this.sprite.setChildIndex(l,0),this.zoraMedianLine.y=a;var g=new egret.TextField;g.text=this.selfPerception.toString(),g.textColor=0,g.x=this._x+this.character1Sprite.width/2,g.y=this.selfPerception/81*810-g.height/2,g.width=70,g.textAlign=egret.HorizontalAlign.CENTER,g.border=!0,g.borderColor=0,g.background=!0,g.backgroundColor=16777215,(n>this.selfPerception||this.selfPerception>o)&&(g.backgroundColor=13408562,i++),this.sprite.addChild(g),this.count=i;var d=new egret.TextField;d.text=this.playerName,d.textColor=0,d.x=g.x-d.width,d.y=this.selfPerception/81*810-d.height/2,d.width=100,d.textAlign=egret.HorizontalAlign.CENTER,d.border=!0,d.borderColor=0,18*this.playerName.length<100?(d.width=100,d.x=g.x-d.width):(d.width=18*this.playerName.length,d.x=g.x-d.width),this.sprite.addChild(d)},t}(egret.DisplayObjectContainer);e.PotentialScale=t,__reflect(t.prototype,"game.PotentialScale")}(game||(game={}));var game;!function(e){var t=function(e){function t(t,i,r,a){var n=e.call(this)||this;return n.stageWidth=0,n.stageHeight=0,n.processX=20,n.process=100,n.missionName="",n.stageWidth=t,n.stageHeight=i,n.sprite=new egret.Sprite,n.process=r,n.missionName=a,n.addChild(n.sprite),n.processBar(),n}return __extends(t,e),t.prototype.processBar=function(){var e=new egret.Shape,t=new egret.Shape,i=new egret.TextField,r=new egret.TextField;e.graphics.beginFill(5357252),e.graphics.drawRect(0,0,this.stageWidth,50),e.graphics.endFill(),t.graphics.beginFill(3617171),t.graphics.drawRect(this.processX,10,2*this.process,30),t.graphics.endFill(),i.text=this.process.toString()+"%",i.size=20,i.x=this.processX+2*this.process+15,i.y=15,i.textColor=16777215,this.process>50&&(i.x=(this.processX+2*this.process)/2-15*(this.process/100)),r.text=this.missionName,r.textAlign=egret.VerticalAlign.MIDDLE,r.size=27,r.x=250,r.y=5,r.textColor=16777215,this.sprite.addChild(e),this.sprite.addChild(t),this.sprite.addChild(i),this.sprite.addChild(r)},t}(egret.DisplayObjectContainer);e.ProcessBar=t,__reflect(t.prototype,"game.ProcessBar")}(game||(game={}));var game;!function(e){var t=function(e){function t(t,i,r,a,n,o,s){var h=e.call(this)||this;return h.stageWidth=0,h.stageHeight=0,h.select_list=[],h.selfPerciption=1,h.individualTensionScaleMedian=60,h.absoluteValueOfDeviation=0,h.teamTensionScaleMedian=30,h.ZORAMin=0,h.ZORAMax=0,h.select_list=r,h.selfPerciption=n,h.teamTensionScaleMedian=o,h.absoluteValueOfDeviation=a,h.ZORAMin=h.teamTensionScaleMedian-13,h.ZORAMax=h.teamTensionScaleMedian+13,h.individualTensionScaleMedian=s,h.stageWidth=t,h.stageHeight=i,h.sprite=new egret.Sprite,h.addChild(h.sprite),h.sprite.touchEnabled=!0,h.drawCharacter(),h.drawScore(),h}return __extends(t,e),t.prototype.drawCharacter=function(){var e=(255+167772.15*Math.floor(100*Math.random()),new egret.Shape),t=new egret.Shape;e.graphics.beginFill(7434694),e.graphics.drawRect(0,0,180,60),e.graphics.endFill();var i=new egret.TextField;i.x=e.x,i.y=10,i.text=this.select_list[0],t.graphics.beginFill(7434694),t.graphics.drawRect(0,80,180,60),t.graphics.endFill();var r=new egret.TextField;r.x=t.x,r.y=90,r.text=this.select_list[1],this.sprite.addChild(e),this.sprite.addChild(t),this.sprite.addChild(i),this.sprite.addChild(r)},t.prototype.drawScore=function(){var e=new egret.Shape,t=new egret.Shape,i=new egret.Shape,r=new egret.TextField;e.graphics.beginFill(12665667),e.graphics.lineStyle(2,16777215),e.graphics.drawCircle(90,70,30),e.graphics.endFill(),t.graphics.beginFill(13224552),t.graphics.lineStyle(2,16777215),t.graphics.drawCircle(90,70,30),t.graphics.endFill(),i.graphics.beginFill(16513522),i.graphics.lineStyle(2,16777215),i.graphics.drawCircle(90,70,30),i.graphics.endFill(),this.ZORAMin>this.selfPerciption||this.selfPerciption>this.ZORAMax?(this.sprite.addChild(e),(this.ZORAMin>this.individualTensionScaleMedian||this.individualTensionScaleMedian>this.ZORAMax)&&(t.graphics.beginFill(12665667),t.graphics.lineStyle(0,16777215),t.graphics.drawCircle(90,70,20),t.graphics.endFill(),this.sprite.addChild(t))):this.ZORAMin<=this.selfPerciption&&this.selfPerciption<=this.ZORAMax&&(this.ZORAMin<=this.individualTensionScaleMedian&&this.individualTensionScaleMedian<=this.ZORAMax?this.sprite.addChild(i):(this.ZORAMin>this.individualTensionScaleMedian||this.individualTensionScaleMedian>this.ZORAMax)&&this.sprite.addChild(t)),r.text=this.absoluteValueOfDeviation.toString(),r.size=20,r.textColor=0,r.x=80,r.y=60,this.sprite.addChild(r),0==this.individualTensionScaleMedian&&this.sprite.removeChild(r)},t}(egret.DisplayObjectContainer);e.TensionScale=t,__reflect(t.prototype,"game.TensionScale")}(game||(game={}));var game;!function(e){var t=function(t){function i(i,r,a,n,o,s,h,c){var l=t.call(this)||this;l.unselectedCharacterList=[],l.selectedChaeacterList=[],l.game_secret="",l.player="",l.gameName="",l.inviter="",l.characterListParams=[],l.stageWidth=0,l.stageHeight=0,l.playerCount=0,l.simulatedData=[],l._touchStatus=!1,l.ttsms=[],l.game_secret=n,l.player=o,l.gameName=s,l.inviter=a,l.characterListParams=h,l.playerCount=c,console.log(h),l.stageWidth=i,l.stageHeight=r,l.sprite=new egret.Sprite,l.addChild(l.sprite),l.sprite.touchEnabled=!0,l.drawTensionScale(),l.drawTitle(),l.timer=new egret.Timer(1e3,0),l.timer.addEventListener(egret.TimerEvent.TIMER,l.getGameResult,l),l.timer.start(),l.rightIcon=new egret.Bitmap(RES.getRes("right_png")),l.rightIcon.width=100,l.rightIcon.height=100,l.rightIcon.anchorOffsetX=l.rightIcon.width/2,l.rightIcon.anchorOffsetY=l.rightIcon.height/2,l.rightIcon.x=i-50,l.rightIcon.y=r-100,l.rightIcon.touchEnabled=!0,l.rightIcon.addEventListener(egret.TouchEvent.TOUCH_TAP,l.rightNext,l);var g=new e.ProcessBar(i,r,90,"Mission 1 > Major Tensions");l.sprite.addChild(g);var d=new e.MajorTensionsTip(i,r);return d.y=r-300,d.x=3,d.width=i-3,l.sprite.addChild(d),l}return __extends(i,t),i.prototype.getGameResult=function(){var e=this;base.API.Init("http://work.metatype.cn:8105/api/"),base.API.call("get_game_score",{characterListParams:e.characterListParams,inviter:e.inviter,gameSecret:e.game_secret,player:e.player,gameName:e.gameName}).then(function(t){var i=t.result;e.ttsms=t.ttsms,e.simulatedData=i,e.drawTensionScale()})},i.prototype.drawTitle=function(){var e=new egret.Shape;e.graphics.beginFill(3514259,.5),e.graphics.drawRect(0,0,this.stageWidth,130),e.graphics.endFill(),this.sprite.addChild(e);var t=new egret.TextField;t.text="Identify the major sources of tension with you teammates",t.size=30,t.width=this.stageWidth,t.x=1,t.y=50,this.sprite.addChild(t)},i.prototype.drawTensionScale=function(){var t=this;console.log(this.simulatedData),console.log("tssmsssssddsfasdfasdf"),console.log(this.ttsms),console.log("tssmsssssddsfasdfasdf"),this.simulatedData.forEach(function(i,r,a){try{var n=Number(i[3].toString()),o=Number(i[2].toString()),s=(i[0],i[2],Math.abs(n-o)),h=o,c=new e.TensionScale(100,60,[i[0],i[1]],s,n,Number(t.ttsms[r]),h);r%2==1?(c.x=150,c.y=150+100*(r-1)):r%2==0&&(c.x=350,c.y=150+100*r),t.sprite.addChild(c)}catch(l){}}),console.log(this.simulatedData),this.simulatedData[2]&&this.playerCount==this.simulatedData[2].length-1&&(this.addChild(this.rightIcon),this.timer.stop())},i.prototype.rightNext=function(){var t=this;if(t.stage){var i=new e.MissionResult(t.stageWidth,t.stageHeight,t.inviter,t.game_secret,t.player,t.gameName,t.characterListParams);t.stage.addChild(i),t.sprite.visible=!1,t.rightIcon.visible=!1}},i.prototype.getRandomScore=function(e,t){var i=t-e,r=Math.random();return e+Math.round(r*i)},i.prototype.onTouchEnd=function(){egret.log("onTouchEnd")},i.prototype.onTouchMove=function(){egret.log("onTouchMove")},i.prototype.onTouchTap=function(){egret.log("onTouchTap")},i}(egret.DisplayObjectContainer);e.TensionScaleResult=t,__reflect(t.prototype,"game.TensionScaleResult")}(game||(game={}));var game;!function(e){var t=function(e){function t(t,i,r,a,n,o,s,h){var c=e.call(this)||this;return c.playerList=[],c.game_secret="",c.player="",c.gameName="",c.inviter="",c.stageWidth=0,c.stageHeight=0,c.characterTwo="Fully",c.characterOne="Insufficiently",c._touchStatus=!1,c._distance=new egret.Point,c.playerScore="",c.tensionMedian="",c.player_name="",c.median=0,c.characterList=[],c.map={},c.ttsm=0,c.selfPerciption=1,c.individualTensionScaleMedian=60,c.absoluteValueOfDeviation=0,c.teamTensionScaleMedian=30,c.ZORAMin=0,c.ZORAMax=0,c.stageWidth=o,c.stageHeight=s,c.ttsm=Number(h),console.log(o),c.playerScore=a,c.tensionMedian=n,c.characterTwo=i,c.characterOne=t,c.player_name=r,c.median=Math.abs(Number(a)-Number(n)),c.absoluteValueOfDeviation=c.median,c.selfPerciption=Number(c.playerScore),c.individualTensionScaleMedian=Number(c.tensionMedian),c.teamTensionScaleMedian=c.ttsm,c.ZORAMin=c.teamTensionScaleMedian-13,c.ZORAMax=c.teamTensionScaleMedian+13,c.sprite=new egret.Sprite,c.sprite.width=o,c.sprite.height=s,c.sprite.x=0,c.sprite.y=0,c.addChild(c.sprite),c._shape=new egret.Shape,c.addChild(c._shape),c.drawVoteArea(),c}return __extends(t,e),t.prototype.drawVoteArea=function(){var e=new egret.TextField,t=new egret.TextField,i=this._shape,r=new egret.TextField,a=new egret.TextField,n=Math.ceil((Number(this.playerScore)-this.ttsm)*(200/81)+this.stageWidth/2),o=new egret.TextField,s=new egret.TextField,h=Math.ceil((Number(this.tensionMedian)-this.ttsm)*(200/81)+this.stageWidth/2);e.text=this.characterOne,e.textAlign=egret.HorizontalAlign.CENTER,e.size=30,e.border=!0,e.width=60,e.height=120,e.borderColor=3825613,e.background=!0,e.backgroundColor=16513522,e.textColor=0,e.x=Math.ceil(this.stageWidth/2-(200/81*this.ttsm+60)),e.y=150,t.text=this.characterTwo,t.textAlign=egret.HorizontalAlign.CENTER,t.size=30,t.border=!0,t.width=60,t.height=120,t.borderColor=3825613,t.x=this.stageWidth/2+Math.ceil(200/81*(81-this.ttsm)+60),t.y=150,t.background=!0,t.backgroundColor=16513522,t.textColor=0,i.graphics.lineStyle(2,14492194),i.graphics.moveTo(e.x+60,210),i.graphics.lineTo(t.x,210),r.text=this.player_name,r.textAlign=egret.HorizontalAlign.CENTER,r.size=20,r.border=!0,r.width=50,r.height=20,r.anchorOffsetX=r.width/2,r.anchorOffsetY=r.height/2,r.borderColor=0,r.x=n,r.y=260,r.rotation=270,r.textColor=0,a.text=this.playerScore,a.textAlign=egret.HorizontalAlign.CENTER,a.size=20,a.border=!0,a.width=50,a.height=20,a.borderColor=0,a.x=n,a.y=210,a.rotation=270,a.textColor=0,a.anchorOffsetX=a.width/2,a.anchorOffsetY=a.height/2,o.text=this.tensionMedian+"/"+this.median,o.textAlign=egret.HorizontalAlign.CENTER,o.size=20,o.border=!0,o.width=60,o.height=20,o.borderColor=0,o.x=h,o.y=210,o.rotation=270,o.textColor=0,o.anchorOffsetX=o.width/2,o.anchorOffsetY=o.height/2,s.text=this.player_name,s.textAlign=egret.HorizontalAlign.CENTER,s.size=20,s.border=!0,s.width=60,s.height=20,s.borderColor=0,s.x=h,s.y=270,s.rotation=270,s.textColor=0,s.anchorOffsetX=s.width/2,s.anchorOffsetY=s.height/2,this.ZORAMin>this.selfPerciption||this.selfPerciption>this.ZORAMax?(a.background=!0,a.backgroundColor=12665667,this.ZORAMin>this.individualTensionScaleMedian||this.individualTensionScaleMedian>this.ZORAMax?(o.background=!0,o.backgroundColor=13224552):(o.background=!0,o.backgroundColor=16513522),e.backgroundColor=6184542,t.backgroundColor=6184542):this.ZORAMin<=this.selfPerciption&&this.selfPerciption<=this.ZORAMax&&(a.background=!0,a.backgroundColor=16513522,this.ZORAMin<=this.individualTensionScaleMedian&&this.individualTensionScaleMedian<=this.ZORAMax?(a.background=!0,a.backgroundColor=16513522,o.background=!0,o.backgroundColor=16513522):(this.ZORAMin>this.individualTensionScaleMedian||this.individualTensionScaleMedian>this.ZORAMax)&&(o.background=!0,o.backgroundColor=13224552,e.backgroundColor=6184542,t.backgroundColor=6184542)),this.sprite.addChild(e),this.sprite.addChild(t),this.sprite.addChild(i),this.sprite.addChild(r),this.sprite.addChild(a),this.sprite.addChild(o),this.sprite.addChild(s)},t}(egret.DisplayObjectContainer);e.ZORAMap=t,__reflect(t.prototype,"game.ZORAMap")}(game||(game={}));